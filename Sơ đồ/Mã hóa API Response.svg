<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="953px" preserveAspectRatio="none" style="width:713px;height:953px;background:#FFFFFF;" version="1.1" viewBox="0 0 713 953" width="713px" zoomAndPan="magnify"><defs/><g><g><title>Client</title><rect fill="#000000" fill-opacity="0.00000" height="789.9219" width="8" x="29.2651" y="82.2969"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="33" x2="33" y1="82.2969" y2="872.2188"/></g><g><title>Server</title><rect fill="#000000" fill-opacity="0.00000" height="789.9219" width="8" x="381.9087" y="82.2969"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="384.9536" x2="384.9536" y1="82.2969" y2="872.2188"/></g><g class="participant participant-head" data-participant="Client"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.5303" x="10" y="78.9951">Client</text><ellipse cx="33.2651" cy="14" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:1;"/><path d="M33.2651,22 L33.2651,49 M20.2651,30 L46.2651,30 M33.2651,49 L20.2651,64 M33.2651,49 L46.2651,64" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="Client"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.5303" x="10" y="884.2139">Client</text><ellipse cx="33.2651" cy="896.5156" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:1;"/><path d="M33.2651,904.5156 L33.2651,931.5156 M20.2651,912.5156 L46.2651,912.5156 M33.2651,931.5156 L20.2651,946.5156 M33.2651,931.5156 L46.2651,946.5156" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-participant="Server"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="45.9102" x="359.9536" y="78.9951">Server</text><ellipse cx="385.9087" cy="14" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:1;"/><path d="M385.9087,22 L385.9087,49 M372.9087,30 L398.9087,30 M385.9087,49 L372.9087,64 M385.9087,49 L398.9087,64" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="Server"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="45.9102" x="359.9536" y="884.2139">Server</text><ellipse cx="385.9087" cy="896.5156" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:1;"/><path d="M385.9087,904.5156 L385.9087,931.5156 M372.9087,912.5156 L398.9087,912.5156 M385.9087,931.5156 L372.9087,946.5156 M385.9087,931.5156 L398.9087,946.5156" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g class="message" data-participant-1="Client" data-participant-2="Server"><polygon fill="#000000" points="373.9087,109.4297,383.9087,113.4297,373.9087,117.4297,377.9087,113.4297" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="33.2651" x2="379.9087" y1="113.4297" y2="113.4297"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="272.6636" x="40.2651" y="108.3638">GET /api/Public/Security/server-public-key</text></g><g class="message" data-participant-1="Server" data-participant-2="Client"><polygon fill="#000000" points="44.2651,138.5625,34.2651,142.5625,44.2651,146.5625,40.2651,142.5625" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="38.2651" x2="384.9087" y1="142.5625" y2="142.5625"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="104.0698" x="50.2651" y="137.4966">serverPublicKey</text></g><g class="message" data-participant-1="Client" data-participant-2="Server"><polygon fill="#000000" points="373.9087,182.8281,383.9087,186.8281,373.9087,190.8281,377.9087,186.8281" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="33.2651" x2="379.9087" y1="186.8281" y2="186.8281"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="286.5586" x="40.2651" y="166.6294">POST /api/Public/Security/register-client-key</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="108.7671" x="40.2651" y="181.7622">(clientPublicKey)</text></g><g class="message" data-participant-1="Server" data-participant-2="Client"><polygon fill="#000000" points="44.2651,211.9609,34.2651,215.9609,44.2651,219.9609,40.2651,215.9609" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="38.2651" x2="384.9087" y1="215.9609" y2="215.9609"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="18.7573" x="50.2651" y="210.895">OK</text></g><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="701.0181" x="5" y="244.5273"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="706.0181" y1="244.5273" y2="244.5273"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="706.0181" y1="247.5273" y2="247.5273"/><rect fill="#FFFFFF" height="23.1328" style="stroke:#000000;stroke-width:1;" width="223.2759" x="243.8711" y="233.9609"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="204.75" x="249.8711" y="250.0278">Client g&#7917;i d&#7919; li&#7879;u l&#234;n Server</text><g class="message" data-participant-1="Client" data-participant-2="Client"><line style="stroke:#000000;stroke-width:1;" x1="33.2651" x2="75.2651" y1="288.2266" y2="288.2266"/><line style="stroke:#000000;stroke-width:1;" x1="75.2651" x2="75.2651" y1="288.2266" y2="301.2266"/><line style="stroke:#000000;stroke-width:1;" x1="34.2651" x2="75.2651" y1="301.2266" y2="301.2266"/><polygon fill="#000000" points="44.2651,297.2266,34.2651,301.2266,44.2651,305.2266,40.2651,301.2266" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="217.147" x="40.2651" y="283.1606">Sinh AES key 256 bit + IV 128 bit</text></g><g class="message" data-participant-1="Client" data-participant-2="Client"><line style="stroke:#000000;stroke-width:1;" x1="33.2651" x2="75.2651" y1="330.3594" y2="330.3594"/><line style="stroke:#000000;stroke-width:1;" x1="75.2651" x2="75.2651" y1="330.3594" y2="343.3594"/><line style="stroke:#000000;stroke-width:1;" x1="34.2651" x2="75.2651" y1="343.3594" y2="343.3594"/><polygon fill="#000000" points="44.2651,339.3594,34.2651,343.3594,44.2651,347.3594,40.2651,343.3594" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="162.0239" x="40.2651" y="325.2935">M&#227; h&#243;a d&#7919; li&#7879;u b&#7857;ng AES</text></g><g class="message" data-participant-1="Client" data-participant-2="Client"><line style="stroke:#000000;stroke-width:1;" x1="33.2651" x2="75.2651" y1="387.625" y2="387.625"/><line style="stroke:#000000;stroke-width:1;" x1="75.2651" x2="75.2651" y1="387.625" y2="400.625"/><line style="stroke:#000000;stroke-width:1;" x1="34.2651" x2="75.2651" y1="400.625" y2="400.625"/><polygon fill="#000000" points="44.2651,396.625,34.2651,400.625,44.2651,404.625,40.2651,400.625" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="311.5557" x="40.2651" y="367.4263">M&#227; h&#243;a AES key + IV b&#7857;ng RSA serverPublicKey</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="188.8364" x="40.2651" y="382.5591">&#8594; EncryptedKeyBlockBase64</text></g><g class="message" data-participant-1="Client" data-participant-2="Server"><polygon fill="#000000" points="373.9087,425.7578,383.9087,429.7578,373.9087,433.7578,377.9087,429.7578" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="33.2651" x2="379.9087" y1="429.7578" y2="429.7578"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="328.6436" x="40.2651" y="424.6919">{ EncryptedKeyBlockBase64, CipherDataBase64 }</text></g><g class="message" data-participant-1="Server" data-participant-2="Server"><line style="stroke:#000000;stroke-width:1;" x1="385.9087" x2="427.9087" y1="458.8906" y2="458.8906"/><line style="stroke:#000000;stroke-width:1;" x1="427.9087" x2="427.9087" y1="458.8906" y2="471.8906"/><line style="stroke:#000000;stroke-width:1;" x1="386.9087" x2="427.9087" y1="471.8906" y2="471.8906"/><polygon fill="#000000" points="396.9087,467.8906,386.9087,471.8906,396.9087,475.8906,392.9087,471.8906" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="290.6465" x="392.9087" y="453.8247">Gi&#7843;i m&#227; AES key + IV b&#7857;ng serverPrivateKey</text></g><g class="message" data-participant-1="Server" data-participant-2="Server"><line style="stroke:#000000;stroke-width:1;" x1="385.9087" x2="427.9087" y1="501.0234" y2="501.0234"/><line style="stroke:#000000;stroke-width:1;" x1="427.9087" x2="427.9087" y1="501.0234" y2="514.0234"/><line style="stroke:#000000;stroke-width:1;" x1="386.9087" x2="427.9087" y1="514.0234" y2="514.0234"/><polygon fill="#000000" points="396.9087,510.0234,386.9087,514.0234,396.9087,518.0234,392.9087,514.0234" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="223.812" x="392.9087" y="495.9575">Gi&#7843;i m&#227; d&#7919; li&#7879;u b&#7857;ng AES key + IV</text></g><g class="message" data-participant-1="Server" data-participant-2="Server"><line style="stroke:#000000;stroke-width:1;" x1="385.9087" x2="427.9087" y1="543.1563" y2="543.1563"/><line style="stroke:#000000;stroke-width:1;" x1="427.9087" x2="427.9087" y1="543.1563" y2="556.1563"/><line style="stroke:#000000;stroke-width:1;" x1="386.9087" x2="427.9087" y1="556.1563" y2="556.1563"/><polygon fill="#000000" points="396.9087,552.1563,386.9087,556.1563,396.9087,560.1563,392.9087,556.1563" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="101.3721" x="392.9087" y="538.0903">X&#7917; l&#253; nghi&#7879;p v&#7909;</text></g><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="701.0181" x="5" y="584.7227"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="706.0181" y1="584.7227" y2="584.7227"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="706.0181" y1="587.7227" y2="587.7227"/><rect fill="#FFFFFF" height="23.1328" style="stroke:#000000;stroke-width:1;" width="289.6152" x="210.7014" y="574.1563"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="271.0894" x="216.7014" y="590.2231">Server tr&#7843; d&#7919; li&#7879;u b&#7843;o m&#7853;t cho Client</text><g class="message" data-participant-1="Server" data-participant-2="Server"><line style="stroke:#000000;stroke-width:1;" x1="385.9087" x2="427.9087" y1="628.4219" y2="628.4219"/><line style="stroke:#000000;stroke-width:1;" x1="427.9087" x2="427.9087" y1="628.4219" y2="641.4219"/><line style="stroke:#000000;stroke-width:1;" x1="386.9087" x2="427.9087" y1="641.4219" y2="641.4219"/><polygon fill="#000000" points="396.9087,637.4219,386.9087,641.4219,396.9087,645.4219,392.9087,641.4219" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="217.147" x="392.9087" y="623.356">Sinh AES key 256 bit + IV 128 bit</text></g><g class="message" data-participant-1="Server" data-participant-2="Server"><line style="stroke:#000000;stroke-width:1;" x1="385.9087" x2="427.9087" y1="670.5547" y2="670.5547"/><line style="stroke:#000000;stroke-width:1;" x1="427.9087" x2="427.9087" y1="670.5547" y2="683.5547"/><line style="stroke:#000000;stroke-width:1;" x1="386.9087" x2="427.9087" y1="683.5547" y2="683.5547"/><polygon fill="#000000" points="396.9087,679.5547,386.9087,683.5547,396.9087,687.5547,392.9087,683.5547" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="162.0239" x="392.9087" y="665.4888">M&#227; h&#243;a d&#7919; li&#7879;u b&#7857;ng AES</text></g><g class="message" data-participant-1="Server" data-participant-2="Server"><line style="stroke:#000000;stroke-width:1;" x1="385.9087" x2="427.9087" y1="727.8203" y2="727.8203"/><line style="stroke:#000000;stroke-width:1;" x1="427.9087" x2="427.9087" y1="727.8203" y2="740.8203"/><line style="stroke:#000000;stroke-width:1;" x1="386.9087" x2="427.9087" y1="740.8203" y2="740.8203"/><polygon fill="#000000" points="396.9087,736.8203,386.9087,740.8203,396.9087,744.8203,392.9087,740.8203" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="306.1094" x="392.9087" y="707.6216">M&#227; h&#243;a AES key + IV b&#7857;ng RSA clientPublicKey</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="188.8364" x="392.9087" y="722.7544">&#8594; EncryptedKeyBlockBase64</text></g><g class="message" data-participant-1="Server" data-participant-2="Client"><polygon fill="#000000" points="44.2651,765.9531,34.2651,769.9531,44.2651,773.9531,40.2651,769.9531" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="38.2651" x2="384.9087" y1="769.9531" y2="769.9531"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="328.6436" x="50.2651" y="764.8872">{ EncryptedKeyBlockBase64, CipherDataBase64 }</text></g><g class="message" data-participant-1="Client" data-participant-2="Client"><line style="stroke:#000000;stroke-width:1;" x1="33.2651" x2="75.2651" y1="799.0859" y2="799.0859"/><line style="stroke:#000000;stroke-width:1;" x1="75.2651" x2="75.2651" y1="799.0859" y2="812.0859"/><line style="stroke:#000000;stroke-width:1;" x1="34.2651" x2="75.2651" y1="812.0859" y2="812.0859"/><polygon fill="#000000" points="44.2651,808.0859,34.2651,812.0859,44.2651,816.0859,40.2651,812.0859" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="285.2002" x="40.2651" y="794.02">Gi&#7843;i m&#227; AES key + IV b&#7857;ng clientPrivateKey</text></g><g class="message" data-participant-1="Client" data-participant-2="Client"><line style="stroke:#000000;stroke-width:1;" x1="33.2651" x2="75.2651" y1="841.2188" y2="841.2188"/><line style="stroke:#000000;stroke-width:1;" x1="75.2651" x2="75.2651" y1="841.2188" y2="854.2188"/><line style="stroke:#000000;stroke-width:1;" x1="34.2651" x2="75.2651" y1="854.2188" y2="854.2188"/><polygon fill="#000000" points="44.2651,850.2188,34.2651,854.2188,44.2651,858.2188,40.2651,854.2188" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="223.812" x="40.2651" y="836.1528">Gi&#7843;i m&#227; d&#7919; li&#7879;u b&#7857;ng AES key + IV</text></g><!--SRC=[bPB1IiD048Rl-nJZJT4GB5ga4A6jHQH8Yn7nqCisNPAbwIPijuKYNlNkAnGlGX7nrk2fJnAVn4sohRNT9dYSOVx_7-QRFU6H0O7GnvGXX1qHSAZxb32X2flmCU48PKqmpbMd0fUDMp1nICtsgEjJnxI9C-9KJCnXEc24QTleamdA9618TUPJWMmeapRbY2QWtR9t973Yqg6G6KugIZ8wR3yhLfO7kjXM4o7BKYMuSJIZq8kZT_1f73sFm5-yCRK0MDRQKai3cp8FgWqRP2QKJilGfG8EuUeEZajdIQ7HN2-cu2q-yP-aRZp_O6vYbQTO9gK9Id9ZLpVFrs7VJo_GO0wVX8BqPAVc1qw_XeUaVA8vxSEksIEeqz0Z_08Bd7NWSNN7DVOqdayf3EIQkWtLTfoEiI3DjGVGEkYliZBLYEybDudg2vZh9ReGnd7qcf9Lmu9B-qtdQG23U3uJu7Z1yWKav6t_OiZRcYB8EOfTa3SUEX-ovjd_Htdx2mieg_L-AUSw553-0G00]--></g></svg>