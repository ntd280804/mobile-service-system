--------------------------------------------------------
--  File created - Monday-November-24-2025   
--------------------------------------------------------
DROP TYPE "APP"."ODCIVARCHAR2LIST_ARRAY";
DROP SEQUENCE "APP"."APPOINTMENT_SEQ";
DROP SEQUENCE "APP"."INVOICE_SEQ";
DROP SEQUENCE "APP"."ORDERS_SEQ";
DROP SEQUENCE "APP"."PART_REQUEST_ITEM_SEQ";
DROP SEQUENCE "APP"."PART_REQUEST_SEQ";
DROP SEQUENCE "APP"."PART_SEQ";
DROP SEQUENCE "APP"."STOCKIN_ITEM_SEQ";
DROP SEQUENCE "APP"."STOCKIN_SEQ";
DROP SEQUENCE "APP"."STOCKOUT_SEQ";
DROP TABLE "APP"."A" cascade constraints;
DROP TABLE "APP"."AUDIT_ALERT_LOG" cascade constraints;
DROP TABLE "APP"."CREATE$JAVA$LOB$TABLE" cascade constraints;
DROP TABLE "APP"."CUSTOMER" cascade constraints;
DROP TABLE "APP"."CUSTOMER_APPOINTMENT" cascade constraints;
DROP TABLE "APP"."EMPLOYEE" cascade constraints;
DROP TABLE "APP"."EMPLOYEE_SHIFT" cascade constraints;
DROP TABLE "APP"."INVOICE" cascade constraints;
DROP TABLE "APP"."INVOICE_ITEM" cascade constraints;
DROP TABLE "APP"."INVOICE_SERVICE" cascade constraints;
DROP TABLE "APP"."ORDERS" cascade constraints;
DROP TABLE "APP"."ORDER_SERVICE" cascade constraints;
DROP TABLE "APP"."PART" cascade constraints;
DROP TABLE "APP"."PART_REQUEST" cascade constraints;
DROP TABLE "APP"."PART_REQUEST_ITEM" cascade constraints;
DROP TABLE "APP"."SERVICE" cascade constraints;
DROP TABLE "APP"."STOCK_IN" cascade constraints;
DROP TABLE "APP"."STOCK_IN_ITEM" cascade constraints;
DROP TABLE "APP"."STOCK_OUT" cascade constraints;
DROP TABLE "APP"."STOCK_OUT_ITEM" cascade constraints;
DROP TABLE "APP"."USER_OTP_LOG" cascade constraints;
DROP PROCEDURE "APP"."ACCEPT_PART_REQUEST";
DROP PROCEDURE "APP"."ASSIGN_PROFILE_TO_USER";
DROP PROCEDURE "APP"."ASSIGN_ROLE_PROC";
DROP PROCEDURE "APP"."AUDIT_STD_DISABLE_ALL";
DROP PROCEDURE "APP"."AUDIT_STD_ENABLE_ALL";
DROP PROCEDURE "APP"."CANCEL_ORDER";
DROP PROCEDURE "APP"."CHANGE_CUSTOMER_PASSWORD";
DROP PROCEDURE "APP"."CHANGE_EMPLOYEE_PASSWORD";
DROP PROCEDURE "APP"."COMPLETE_PART_REQUEST";
DROP PROCEDURE "APP"."CREATE_APPOINTMENT";
DROP PROCEDURE "APP"."CREATE_INVOICE";
DROP PROCEDURE "APP"."CREATE_ORDER";
DROP PROCEDURE "APP"."CREATE_ORDER_SERVICE";
DROP PROCEDURE "APP"."CREATE_PART";
DROP PROCEDURE "APP"."CREATE_PART_REQUEST";
DROP PROCEDURE "APP"."CREATE_PART_REQUEST_ITEM";
DROP PROCEDURE "APP"."CREATE_PROFILE";
DROP PROCEDURE "APP"."CREATE_ROLE_PROC";
DROP PROCEDURE "APP"."CREATE_STOCKIN";
DROP PROCEDURE "APP"."CREATE_STOCKIN_ITEM";
DROP PROCEDURE "APP"."CREATE_STOCKOUT_TRANSACTION";
DROP PROCEDURE "APP"."DELETE_PROFILE";
DROP PROCEDURE "APP"."DELETE_ROLE_PROC";
DROP PROCEDURE "APP"."DENY_PART_REQUEST";
DROP PROCEDURE "APP"."DISABLE_ALL_FGA";
DROP PROCEDURE "APP"."ENABLE_ALL_FGA";
DROP PROCEDURE "APP"."GENERATE_OTP_CUSTOMER";
DROP PROCEDURE "APP"."GET_ALL_APPOINTMENTS";
DROP PROCEDURE "APP"."GET_ALL_AUDIT_LOG";
DROP PROCEDURE "APP"."GET_ALL_AUDIT_PROJECT";
DROP PROCEDURE "APP"."GET_ALL_CUSTOMERS";
DROP PROCEDURE "APP"."GET_ALL_EMPLOYEES";
DROP PROCEDURE "APP"."GET_ALL_EXPORTS";
DROP PROCEDURE "APP"."GET_ALL_IMPORTS";
DROP PROCEDURE "APP"."GET_ALL_INVOICES";
DROP PROCEDURE "APP"."GET_ALL_ORDERS";
DROP PROCEDURE "APP"."GET_ALL_PART";
DROP PROCEDURE "APP"."GET_ALL_PART_IN_STOCK";
DROP PROCEDURE "APP"."GET_ALL_PART_REQUESTS";
DROP PROCEDURE "APP"."GET_ALL_PROFILES_WITH_LIMITS";
DROP PROCEDURE "APP"."GET_ALL_ROLES";
DROP PROCEDURE "APP"."GET_ALL_SERVICES";
DROP PROCEDURE "APP"."GET_ALL_USERS";
DROP PROCEDURE "APP"."GET_ALL_USERS_WITH_PROFILE";
DROP PROCEDURE "APP"."GET_BY_ORDER_TYPE";
DROP PROCEDURE "APP"."GET_EMPLOYEE_BY_ID";
DROP PROCEDURE "APP"."GET_EMPLOYEE_ID_BY_USERNAME";
DROP PROCEDURE "APP"."GET_EMPLOYEE_NAME_BY_ID";
DROP PROCEDURE "APP"."GET_EMPLOYEE_PUBLIC_KEY";
DROP PROCEDURE "APP"."GET_EMP_ID_FROM_INVOICE";
DROP PROCEDURE "APP"."GET_EMP_ID_FROM_STOCKIN";
DROP PROCEDURE "APP"."GET_EMP_ID_FROM_STOCKOUT";
DROP PROCEDURE "APP"."GET_ENABLED_TRIGGERS_COUNT";
DROP PROCEDURE "APP"."GET_EXPORT_BY_ID";
DROP PROCEDURE "APP"."GET_IMPORT_BY_ID";
DROP PROCEDURE "APP"."GET_INVOICE_BY_ID";
DROP PROCEDURE "APP"."GET_INVOICE_PDF";
DROP PROCEDURE "APP"."GET_INVOICE_SIGNATURE";
DROP PROCEDURE "APP"."GET_OBJ_AUDIT_COUNT";
DROP PROCEDURE "APP"."GET_ORDER_BY_ID";
DROP PROCEDURE "APP"."GET_PART_BY_ORDERID";
DROP PROCEDURE "APP"."GET_PART_BY_PARTREQUEST";
DROP PROCEDURE "APP"."GET_PART_BY_REQUEST_ID";
DROP PROCEDURE "APP"."GET_PART_BY_SERIAL";
DROP PROCEDURE "APP"."GET_PART_BY_STATUS";
DROP PROCEDURE "APP"."GET_PART_BY_STOCK";
DROP PROCEDURE "APP"."GET_PART_BY_STOCKINID";
DROP PROCEDURE "APP"."GET_PROFILE_BY_NAME";
DROP PROCEDURE "APP"."GET_PUBLICKEY_BY_USERNAME";
DROP PROCEDURE "APP"."GET_ROLES_OF_USER";
DROP PROCEDURE "APP"."GET_SERVICES_BY_ORDER_ID";
DROP PROCEDURE "APP"."GET_STOCKIN_PDF";
DROP PROCEDURE "APP"."GET_STOCKIN_SIGNATURE";
DROP PROCEDURE "APP"."GET_STOCKOUT_PDF";
DROP PROCEDURE "APP"."GET_STOCKOUT_SIGNATURE";
DROP PROCEDURE "APP"."GET_UNFINISHED_ORDERS";
DROP PROCEDURE "APP"."LOCK_DB_USER";
DROP PROCEDURE "APP"."LOGIN_CUSTOMER";
DROP PROCEDURE "APP"."LOGIN_EMPLOYEE";
DROP PROCEDURE "APP"."REGISTER_CUSTOMER";
DROP PROCEDURE "APP"."REGISTER_EMPLOYEE";
DROP PROCEDURE "APP"."RESET_PASSWORD_CUSTOMER";
DROP PROCEDURE "APP"."REVOKE_ROLE_PROC";
DROP PROCEDURE "APP"."SIGN_INVOICE";
DROP PROCEDURE "APP"."SIGN_PDF";
DROP PROCEDURE "APP"."SIGN_STOCKIN";
DROP PROCEDURE "APP"."SIGN_STOCKOUT";
DROP PROCEDURE "APP"."TRIGGER_DISABLE_ALL";
DROP PROCEDURE "APP"."TRIGGER_ENABLE_ALL";
DROP PROCEDURE "APP"."UNLOCK_DB_USER";
DROP PROCEDURE "APP"."UPDATE_INVOICE_PDF";
DROP PROCEDURE "APP"."UPDATE_INVOICE_SIGNATURE";
DROP PROCEDURE "APP"."UPDATE_ORDER_STATUS_WAIT_PART";
DROP PROCEDURE "APP"."UPDATE_PROFILE";
DROP PROCEDURE "APP"."UPDATE_STOCKIN_PDF";
DROP PROCEDURE "APP"."UPDATE_STOCKIN_SIGNATURE";
DROP PROCEDURE "APP"."UPDATE_STOCKOUT_PDF";
DROP PROCEDURE "APP"."UPDATE_STOCKOUT_SIGNATURE";
DROP PROCEDURE "APP"."VERIFY_INVOICE_SIGNATURE";
DROP PROCEDURE "APP"."VERIFY_STOCKIN_SIGNATURE";
DROP PROCEDURE "APP"."VERIFY_STOCKOUT_SIGNATURE";
DROP PACKAGE "APP"."APP_CTX_PKG";
DROP PACKAGE "APP"."AUDIT_DML_PKG";
DROP PACKAGE "APP"."CRYPTO";
DROP PACKAGE BODY "APP"."APP_CTX_PKG";
DROP PACKAGE BODY "APP"."AUDIT_DML_PKG";
DROP FUNCTION "APP"."APPOINTMENT_VPD_PREDICATE";
DROP FUNCTION "APP"."APPOINTMENT_VPD_PREDICATE_DEL";
DROP FUNCTION "APP"."CUSTOMER_VPD_PREDICATE";
DROP FUNCTION "APP"."EMPLOYEE_VPD_PREDICATE";
DROP FUNCTION "APP"."GET_EMPLOYEE_ROLES_BY_USERNAME";
DROP FUNCTION "APP"."HASH_PASSWORD";
DROP FUNCTION "APP"."HASH_PASSWORD_20CHARS";
DROP FUNCTION "APP"."INVOICE_VPD_PREDICATE";
DROP FUNCTION "APP"."ORDERS_VPD_PREDICATE";
DROP FUNCTION "APP"."ORDERS_VPD_PREDICATE_DEL";
DROP FUNCTION "APP"."PARTREQUEST_VPD_PREDICATE";
DROP FUNCTION "APP"."PART_VPD_PREDICATE";
DROP FUNCTION "APP"."STOCK_VPD_PREDICATE";
--------------------------------------------------------
--  DDL for Type ODCIVARCHAR2LIST_ARRAY
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TYPE "APP"."ODCIVARCHAR2LIST_ARRAY" AS TABLE OF VARCHAR2(4000);

/
--------------------------------------------------------
--  DDL for Sequence APPOINTMENT_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "APP"."APPOINTMENT_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 15 NOCACHE  NOORDER  NOCYCLE  NOKEEP  NOSCALE  GLOBAL ;
--------------------------------------------------------
--  DDL for Sequence INVOICE_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "APP"."INVOICE_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 9 NOCACHE  NOORDER  NOCYCLE  NOKEEP  NOSCALE  GLOBAL ;
--------------------------------------------------------
--  DDL for Sequence ORDERS_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "APP"."ORDERS_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 242 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE  GLOBAL ;
--------------------------------------------------------
--  DDL for Sequence PART_REQUEST_ITEM_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "APP"."PART_REQUEST_ITEM_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 13 NOCACHE  NOORDER  NOCYCLE  NOKEEP  NOSCALE  GLOBAL ;
--------------------------------------------------------
--  DDL for Sequence PART_REQUEST_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "APP"."PART_REQUEST_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 47 NOCACHE  NOORDER  NOCYCLE  NOKEEP  NOSCALE  GLOBAL ;
--------------------------------------------------------
--  DDL for Sequence PART_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "APP"."PART_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 743 NOCACHE  NOORDER  NOCYCLE  NOKEEP  NOSCALE  GLOBAL ;
--------------------------------------------------------
--  DDL for Sequence STOCKIN_ITEM_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "APP"."STOCKIN_ITEM_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 748 NOCACHE  NOORDER  NOCYCLE  NOKEEP  NOSCALE  GLOBAL ;
--------------------------------------------------------
--  DDL for Sequence STOCKIN_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "APP"."STOCKIN_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 72 NOCACHE  NOORDER  NOCYCLE  NOKEEP  NOSCALE  GLOBAL ;
--------------------------------------------------------
--  DDL for Sequence STOCKOUT_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "APP"."STOCKOUT_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 31 NOCACHE  NOORDER  NOCYCLE  NOKEEP  NOSCALE  GLOBAL ;
--------------------------------------------------------
--  DDL for Table A
--------------------------------------------------------

  CREATE TABLE "APP"."A" 
   (	"ID" NUMBER, 
	"NAME" VARCHAR2(100 BYTE), 
	"CREATED_AT" DATE DEFAULT SYSDATE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table AUDIT_ALERT_LOG
--------------------------------------------------------

  CREATE TABLE "APP"."AUDIT_ALERT_LOG" 
   (	"LOG_ID" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE , 
	"EVENT_TS" TIMESTAMP (6) DEFAULT SYSTIMESTAMP, 
	"DB_USER" VARCHAR2(128 BYTE), 
	"OS_USER" VARCHAR2(128 BYTE), 
	"MACHINE" VARCHAR2(128 BYTE), 
	"MODULE" VARCHAR2(64 BYTE), 
	"APP_ROLE" VARCHAR2(100 BYTE), 
	"EMP_ID" VARCHAR2(64 BYTE), 
	"CUSTOMER_PHONE" VARCHAR2(64 BYTE), 
	"OBJECT_SCHEMA" VARCHAR2(128 BYTE), 
	"OBJECT_NAME" VARCHAR2(128 BYTE), 
	"POLICY_NAME" VARCHAR2(128 BYTE), 
	"CLIENT_IDENTIFIER" VARCHAR2(64 BYTE), 
	"NOTE" VARCHAR2(4000 BYTE), 
	"DML_TYPE" VARCHAR2(10 BYTE), 
	"OLD_VALUES" CLOB, 
	"NEW_VALUES" CLOB, 
	"CHANGED_COLUMNS" VARCHAR2(4000 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" 
 LOB ("OLD_VALUES") STORE AS SECUREFILE (
  TABLESPACE "USERS" ENABLE STORAGE IN ROW 4000 CHUNK 8192
  NOCACHE LOGGING  NOCOMPRESS  KEEP_DUPLICATES 
  STORAGE(INITIAL 262144 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)) 
 LOB ("NEW_VALUES") STORE AS SECUREFILE (
  TABLESPACE "USERS" ENABLE STORAGE IN ROW 4000 CHUNK 8192
  NOCACHE LOGGING  NOCOMPRESS  KEEP_DUPLICATES 
  STORAGE(INITIAL 262144 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)) ;
--------------------------------------------------------
--  DDL for Table CREATE$JAVA$LOB$TABLE
--------------------------------------------------------

  CREATE TABLE "APP"."CREATE$JAVA$LOB$TABLE" 
   (	"NAME" VARCHAR2(700 BYTE), 
	"LOB" BLOB, 
	"LOADTIME" DATE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" 
 LOB ("LOB") STORE AS SECUREFILE (
  TABLESPACE "USERS" ENABLE STORAGE IN ROW 4000 CHUNK 8192
  NOCACHE LOGGING  NOCOMPRESS  KEEP_DUPLICATES 
  STORAGE(INITIAL 262144 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)) ;
--------------------------------------------------------
--  DDL for Table CUSTOMER
--------------------------------------------------------

  CREATE TABLE "APP"."CUSTOMER" 
   (	"PHONE" VARCHAR2(20 BYTE), 
	"FULL_NAME" VARCHAR2(100 BYTE), 
	"PASSWORD_HASH" VARCHAR2(256 BYTE), 
	"PUBLIC_KEY" CLOB, 
	"CREATED_AT" TIMESTAMP (6) DEFAULT SYSTIMESTAMP, 
	"EMAIL" VARCHAR2(100 BYTE), 
	"ADDRESS" VARCHAR2(200 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" 
 LOB ("PUBLIC_KEY") STORE AS SECUREFILE (
  TABLESPACE "USERS" ENABLE STORAGE IN ROW 4000 CHUNK 8192
  NOCACHE LOGGING  NOCOMPRESS  KEEP_DUPLICATES 
  STORAGE(INITIAL 262144 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)) ;
--------------------------------------------------------
--  DDL for Table CUSTOMER_APPOINTMENT
--------------------------------------------------------

  CREATE TABLE "APP"."CUSTOMER_APPOINTMENT" 
   (	"APPOINTMENT_ID" NUMBER, 
	"CUSTOMER_PHONE" VARCHAR2(20 BYTE), 
	"APPOINTMENT_DATE" DATE, 
	"STATUS" VARCHAR2(20 BYTE) DEFAULT 'SCHEDULED', 
	"DESCRIPTION" VARCHAR2(500 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table EMPLOYEE
--------------------------------------------------------

  CREATE TABLE "APP"."EMPLOYEE" 
   (	"EMP_ID" NUMBER GENERATED BY DEFAULT AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE , 
	"FULL_NAME" VARCHAR2(100 BYTE), 
	"USERNAME" VARCHAR2(50 BYTE), 
	"PASSWORD_HASH" VARCHAR2(256 BYTE), 
	"PUBLIC_KEY" CLOB, 
	"CREATED_AT" TIMESTAMP (6) DEFAULT SYSTIMESTAMP, 
	"EMAIL" VARCHAR2(100 BYTE), 
	"PHONE" VARCHAR2(20 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" 
 LOB ("PUBLIC_KEY") STORE AS SECUREFILE (
  TABLESPACE "USERS" ENABLE STORAGE IN ROW 4000 CHUNK 8192
  NOCACHE LOGGING  NOCOMPRESS  KEEP_DUPLICATES 
  STORAGE(INITIAL 262144 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)) ;
  GRANT UPDATE ON "APP"."EMPLOYEE" TO "LBACSYS";
  GRANT SELECT ON "APP"."EMPLOYEE" TO "LBACSYS";
--------------------------------------------------------
--  DDL for Table EMPLOYEE_SHIFT
--------------------------------------------------------

  CREATE TABLE "APP"."EMPLOYEE_SHIFT" 
   (	"SHIFT_ID" NUMBER, 
	"EMP_ID" NUMBER, 
	"SHIFT_DATE" DATE, 
	"START_TIME" TIMESTAMP (6), 
	"END_TIME" TIMESTAMP (6), 
	"STATUS" VARCHAR2(20 BYTE) DEFAULT 'SCHEDULED'
   ) SEGMENT CREATION DEFERRED 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table INVOICE
--------------------------------------------------------

  CREATE TABLE "APP"."INVOICE" 
   (	"INVOICE_ID" NUMBER, 
	"STOCKOUT_ID" NUMBER, 
	"CUSTOMER_PHONE" VARCHAR2(20 BYTE), 
	"EMP_ID" NUMBER, 
	"INVOICE_DATE" DATE DEFAULT SYSDATE, 
	"TOTAL_AMOUNT" NUMBER(20,2) DEFAULT 0, 
	"STATUS" VARCHAR2(20 BYTE) DEFAULT 'PENDING', 
	"PDF" BLOB, 
	"SIGNATURE" CLOB
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" 
 LOB ("PDF") STORE AS SECUREFILE (
  TABLESPACE "USERS" ENABLE STORAGE IN ROW 4000 CHUNK 8192
  NOCACHE LOGGING  NOCOMPRESS  KEEP_DUPLICATES 
  STORAGE(INITIAL 262144 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)) 
 LOB ("SIGNATURE") STORE AS SECUREFILE (
  TABLESPACE "USERS" ENABLE STORAGE IN ROW 4000 CHUNK 8192
  NOCACHE LOGGING  NOCOMPRESS  KEEP_DUPLICATES 
  STORAGE(INITIAL 262144 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)) ;
--------------------------------------------------------
--  DDL for Table INVOICE_ITEM
--------------------------------------------------------

  CREATE TABLE "APP"."INVOICE_ITEM" 
   (	"INVOICE_ID" NUMBER, 
	"STOCKOUT_ID" NUMBER, 
	"PART_ID" NUMBER, 
	"PRICE" NUMBER(20,2)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table INVOICE_SERVICE
--------------------------------------------------------

  CREATE TABLE "APP"."INVOICE_SERVICE" 
   (	"INVOICE_ID" NUMBER, 
	"SERVICE_ID" NUMBER, 
	"QUANTITY" NUMBER DEFAULT 1, 
	"PRICE" NUMBER(20,2)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table ORDERS
--------------------------------------------------------

  CREATE TABLE "APP"."ORDERS" 
   (	"ORDER_ID" NUMBER, 
	"CUSTOMER_PHONE" VARCHAR2(20 BYTE), 
	"RECEIVER_EMP" NUMBER, 
	"HANDLER_EMP" NUMBER, 
	"ORDER_TYPE" VARCHAR2(20 BYTE), 
	"RECEIVED_DATE" DATE, 
	"STATUS" VARCHAR2(50 BYTE), 
	"DESCRIPTION" VARCHAR2(500 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table ORDER_SERVICE
--------------------------------------------------------

  CREATE TABLE "APP"."ORDER_SERVICE" 
   (	"ORDER_ID" NUMBER, 
	"SERVICE_ID" NUMBER, 
	"QUANTITY" NUMBER DEFAULT 1, 
	"PRICE" NUMBER(20,2)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table PART
--------------------------------------------------------

  CREATE TABLE "APP"."PART" 
   (	"PART_ID" NUMBER, 
	"NAME" VARCHAR2(100 BYTE), 
	"MANUFACTURER" VARCHAR2(100 BYTE), 
	"SERIAL" VARCHAR2(50 BYTE), 
	"STATUS" VARCHAR2(50 BYTE), 
	"STOCK_IN_ID" NUMBER, 
	"ORDER_ID" NUMBER, 
	"PRICE" NUMBER(20,2)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table PART_REQUEST
--------------------------------------------------------

  CREATE TABLE "APP"."PART_REQUEST" 
   (	"REQUEST_ID" NUMBER, 
	"ORDER_ID" NUMBER, 
	"EMP_ID" NUMBER, 
	"REQUEST_DATE" DATE, 
	"STATUS" VARCHAR2(50 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table PART_REQUEST_ITEM
--------------------------------------------------------

  CREATE TABLE "APP"."PART_REQUEST_ITEM" 
   (	"REQUEST_ID" NUMBER, 
	"PART_ID" NUMBER
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table SERVICE
--------------------------------------------------------

  CREATE TABLE "APP"."SERVICE" 
   (	"SERVICE_ID" NUMBER GENERATED BY DEFAULT AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE , 
	"NAME" VARCHAR2(100 BYTE), 
	"DESCRIPTION" VARCHAR2(500 BYTE), 
	"PRICE" NUMBER(20,2)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table STOCK_IN
--------------------------------------------------------

  CREATE TABLE "APP"."STOCK_IN" 
   (	"STOCKIN_ID" NUMBER, 
	"EMP_ID" NUMBER, 
	"IN_DATE" DATE, 
	"NOTE" VARCHAR2(200 BYTE), 
	"PDF" BLOB, 
	"SIGNATURE" CLOB
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" 
 LOB ("PDF") STORE AS SECUREFILE (
  TABLESPACE "USERS" ENABLE STORAGE IN ROW 4000 CHUNK 8192
  NOCACHE LOGGING  NOCOMPRESS  KEEP_DUPLICATES 
  STORAGE(INITIAL 262144 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)) 
 LOB ("SIGNATURE") STORE AS SECUREFILE (
  TABLESPACE "USERS" ENABLE STORAGE IN ROW 4000 CHUNK 8192
  NOCACHE LOGGING  NOCOMPRESS  KEEP_DUPLICATES 
  STORAGE(INITIAL 262144 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)) ;
  GRANT SELECT ON "APP"."STOCK_IN" TO "THUKHO";
--------------------------------------------------------
--  DDL for Table STOCK_IN_ITEM
--------------------------------------------------------

  CREATE TABLE "APP"."STOCK_IN_ITEM" 
   (	"STOCKIN_ITEM_ID" NUMBER, 
	"STOCKIN_ID" NUMBER, 
	"PART_NAME" VARCHAR2(100 BYTE), 
	"MANUFACTURER" VARCHAR2(100 BYTE), 
	"SERIAL" VARCHAR2(50 BYTE), 
	"PRICE" NUMBER(20,2)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table STOCK_OUT
--------------------------------------------------------

  CREATE TABLE "APP"."STOCK_OUT" 
   (	"STOCKOUT_ID" NUMBER, 
	"ORDER_ID" NUMBER, 
	"EMP_ID" NUMBER, 
	"OUT_DATE" DATE, 
	"NOTE" VARCHAR2(200 BYTE), 
	"PDF" BLOB, 
	"SIGNATURE" CLOB
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" 
 LOB ("PDF") STORE AS SECUREFILE (
  TABLESPACE "USERS" ENABLE STORAGE IN ROW 4000 CHUNK 8192
  NOCACHE LOGGING  NOCOMPRESS  KEEP_DUPLICATES 
  STORAGE(INITIAL 262144 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)) 
 LOB ("SIGNATURE") STORE AS SECUREFILE (
  TABLESPACE "USERS" ENABLE STORAGE IN ROW 4000 CHUNK 8192
  NOCACHE LOGGING  NOCOMPRESS  KEEP_DUPLICATES 
  STORAGE(INITIAL 262144 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)) ;
--------------------------------------------------------
--  DDL for Table STOCK_OUT_ITEM
--------------------------------------------------------

  CREATE TABLE "APP"."STOCK_OUT_ITEM" 
   (	"STOCKOUT_ID" NUMBER, 
	"PART_ID" NUMBER
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table USER_OTP_LOG
--------------------------------------------------------

  CREATE TABLE "APP"."USER_OTP_LOG" 
   (	"ID" NUMBER GENERATED BY DEFAULT AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE , 
	"USER_ID" NUMBER, 
	"USERNAME" VARCHAR2(100 BYTE), 
	"OTP" VARCHAR2(10 BYTE), 
	"CREATED_AT" TIMESTAMP (6) DEFAULT SYSTIMESTAMP, 
	"EXPIRED_AT" TIMESTAMP (6), 
	"USED" CHAR(1 BYTE) DEFAULT 'N'
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
REM INSERTING into APP.A
SET DEFINE OFF;
Insert into APP.A (ID,NAME,CREATED_AT) values (1,'Tên gì đó',to_date('17-NOV-25','DD-MON-RR'));
REM INSERTING into APP.AUDIT_ALERT_LOG
SET DEFINE OFF;
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (63,to_timestamp('15-NOV-25 06.22.54.816601000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_IN_ITEM','AUD_STOCK_IN_ITEM_INSERT','2d2cab62-13cb-460c-bfb4-1db939c3bab3','Unauthorized DML detected via policy AUD_STOCK_IN_ITEM_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (61,to_timestamp('15-NOV-25 06.22.54.756184000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_IN','AUD_STOCK_IN_INSERT','2d2cab62-13cb-460c-bfb4-1db939c3bab3','Unauthorized DML detected via policy AUD_STOCK_IN_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (62,to_timestamp('15-NOV-25 06.22.54.790365000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN','AUD_STOCK_IN_INSERT','2d2cab62-13cb-460c-bfb4-1db939c3bab3','INSERT operation on STOCK_IN','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (64,to_timestamp('15-NOV-25 06.22.54.819075000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN_ITEM','AUD_STOCK_IN_ITEM_INSERT','2d2cab62-13cb-460c-bfb4-1db939c3bab3','INSERT operation on STOCK_IN_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (65,to_timestamp('15-NOV-25 06.22.54.860209000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','PART','AUD_PART_INSERT','2d2cab62-13cb-460c-bfb4-1db939c3bab3','Unauthorized DML detected via policy AUD_PART_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (66,to_timestamp('15-NOV-25 06.22.54.861552000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART','AUD_PART_INSERT','2d2cab62-13cb-460c-bfb4-1db939c3bab3','INSERT operation on PART','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (67,to_timestamp('15-NOV-25 06.22.55.054938000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_IN','AUD_STOCK_IN_UPDATE','2d2cab62-13cb-460c-bfb4-1db939c3bab3','Unauthorized DML detected via policy AUD_STOCK_IN_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (68,to_timestamp('15-NOV-25 06.22.55.057079000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN','AUD_STOCK_IN_UPDATE','2d2cab62-13cb-460c-bfb4-1db939c3bab3','UPDATE operation on STOCK_IN - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (69,to_timestamp('15-NOV-25 06.23.17.624466000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_IN','AUD_STOCK_IN_UPDATE','2d2cab62-13cb-460c-bfb4-1db939c3bab3','Unauthorized DML detected via policy AUD_STOCK_IN_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (70,to_timestamp('15-NOV-25 06.23.17.625664000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN','AUD_STOCK_IN_UPDATE','2d2cab62-13cb-460c-bfb4-1db939c3bab3','UPDATE operation on STOCK_IN - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (71,to_timestamp('15-NOV-25 06.35.19.819662000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_OUT','AUD_STOCK_OUT_INSERT','3a13ea9b-cbc4-4598-b805-b2736021f6cf','Unauthorized DML detected via policy AUD_STOCK_OUT_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (77,to_timestamp('15-NOV-25 06.36.24.457314000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_OUT','AUD_STOCK_OUT_INSERT','b53bc9a0-34f8-4ed7-8cf9-c550439c6934','Unauthorized DML detected via policy AUD_STOCK_OUT_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (73,to_timestamp('15-NOV-25 06.35.19.836468000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_OUT_ITEM','AUD_STOCK_OUT_ITEM_INSERT','3a13ea9b-cbc4-4598-b805-b2736021f6cf','Unauthorized DML detected via policy AUD_STOCK_OUT_ITEM_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (83,to_timestamp('15-NOV-25 06.44.30.691828000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_OUT','AUD_STOCK_OUT_INSERT','68a51ef4-7d90-4925-9f38-909b36675712','Unauthorized DML detected via policy AUD_STOCK_OUT_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (75,to_timestamp('15-NOV-25 06.35.19.841072000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','PART','AUD_PART_UPDATE','3a13ea9b-cbc4-4598-b805-b2736021f6cf','Unauthorized DML detected via policy AUD_PART_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (79,to_timestamp('15-NOV-25 06.36.24.460202000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_OUT_ITEM','AUD_STOCK_OUT_ITEM_INSERT','b53bc9a0-34f8-4ed7-8cf9-c550439c6934','Unauthorized DML detected via policy AUD_STOCK_OUT_ITEM_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (89,to_timestamp('15-NOV-25 06.45.35.013075000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_OUT','AUD_STOCK_OUT_INSERT','68a51ef4-7d90-4925-9f38-909b36675712','Unauthorized DML detected via policy AUD_STOCK_OUT_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (81,to_timestamp('15-NOV-25 06.36.24.462353000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','PART','AUD_PART_UPDATE','b53bc9a0-34f8-4ed7-8cf9-c550439c6934','Unauthorized DML detected via policy AUD_PART_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (85,to_timestamp('15-NOV-25 06.44.30.697563000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_OUT_ITEM','AUD_STOCK_OUT_ITEM_INSERT','68a51ef4-7d90-4925-9f38-909b36675712','Unauthorized DML detected via policy AUD_STOCK_OUT_ITEM_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (95,to_timestamp('15-NOV-25 06.46.08.743249000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_OUT','AUD_STOCK_OUT_INSERT','68a51ef4-7d90-4925-9f38-909b36675712','Unauthorized DML detected via policy AUD_STOCK_OUT_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (87,to_timestamp('15-NOV-25 06.44.30.706193000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','PART','AUD_PART_UPDATE','68a51ef4-7d90-4925-9f38-909b36675712','Unauthorized DML detected via policy AUD_PART_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (91,to_timestamp('15-NOV-25 06.45.35.015322000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_OUT_ITEM','AUD_STOCK_OUT_ITEM_INSERT','68a51ef4-7d90-4925-9f38-909b36675712','Unauthorized DML detected via policy AUD_STOCK_OUT_ITEM_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (93,to_timestamp('15-NOV-25 06.45.35.017259000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','PART','AUD_PART_UPDATE','68a51ef4-7d90-4925-9f38-909b36675712','Unauthorized DML detected via policy AUD_PART_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (97,to_timestamp('15-NOV-25 06.46.08.745905000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_OUT_ITEM','AUD_STOCK_OUT_ITEM_INSERT','68a51ef4-7d90-4925-9f38-909b36675712','Unauthorized DML detected via policy AUD_STOCK_OUT_ITEM_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (166,to_timestamp('17-NOV-25 12.21.36.116441000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART_REQUEST_ITEM','AUD_PART_REQUEST_ITEM_INSERT','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','INSERT operation on PART_REQUEST_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (162,to_timestamp('17-NOV-25 12.21.28.859234000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','ORDERS','AUD_ORDERS_INSERT','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','INSERT operation on ORDERS','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (164,to_timestamp('17-NOV-25 12.21.36.086837000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART_REQUEST','AUD_PART_REQUEST_INSERT','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','INSERT operation on PART_REQUEST','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (167,to_timestamp('17-NOV-25 12.21.36.124144000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','PART','AUD_PART_UPDATE','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','Unauthorized DML detected via policy AUD_PART_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (168,to_timestamp('17-NOV-25 12.21.36.130000000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART','AUD_PART_UPDATE','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','UPDATE operation on PART - Changed: STATUS','UPDATE','STATUS');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (169,to_timestamp('17-NOV-25 12.21.38.987221000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','PART_REQUEST','AUD_PART_REQUEST_UPDATE','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','Unauthorized DML detected via policy AUD_PART_REQUEST_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (170,to_timestamp('17-NOV-25 12.21.38.990102000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART_REQUEST','AUD_PART_REQUEST_UPDATE','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','UPDATE operation on PART_REQUEST - Changed: STATUS','UPDATE','STATUS');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (171,to_timestamp('17-NOV-25 12.21.39.002450000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','PART','AUD_PART_UPDATE','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','Unauthorized DML detected via policy AUD_PART_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (172,to_timestamp('17-NOV-25 12.21.39.004627000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART','AUD_PART_UPDATE','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','UPDATE operation on PART - Changed: STATUS,ORDER_ID','UPDATE','STATUS,ORDER_ID');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (173,to_timestamp('17-NOV-25 12.22.04.892522000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_OUT','AUD_STOCK_OUT_INSERT','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','Unauthorized DML detected via policy AUD_STOCK_OUT_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (174,to_timestamp('17-NOV-25 12.22.04.894501000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_OUT','AUD_STOCK_OUT_INSERT','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','INSERT operation on STOCK_OUT','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (175,to_timestamp('17-NOV-25 12.22.04.918939000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_OUT_ITEM','AUD_STOCK_OUT_ITEM_INSERT','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','Unauthorized DML detected via policy AUD_STOCK_OUT_ITEM_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (176,to_timestamp('17-NOV-25 12.22.04.920620000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_OUT_ITEM','AUD_STOCK_OUT_ITEM_INSERT','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','INSERT operation on STOCK_OUT_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (177,to_timestamp('17-NOV-25 12.22.04.923917000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','PART','AUD_PART_UPDATE','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','Unauthorized DML detected via policy AUD_PART_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (178,to_timestamp('17-NOV-25 12.22.04.925426000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART','AUD_PART_UPDATE','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','UPDATE operation on PART - Changed: STATUS','UPDATE','STATUS');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (179,to_timestamp('17-NOV-25 12.22.04.931883000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','ORDERS','AUD_ORDERS_UPDATE','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','Unauthorized DML detected via policy AUD_ORDERS_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (43,to_timestamp('14-NOV-25 07.44.46.007676000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','PART','AUD_PART_UPDATE','1b660d4f-8faf-4ca5-bbbf-9e219c0b786c','Unauthorized DML detected via policy AUD_PART_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (44,to_timestamp('14-NOV-25 07.46.20.210308000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','EMPLOYEE','AUD_EMPLOYEE_INSERT','1b660d4f-8faf-4ca5-bbbf-9e219c0b786c','Unauthorized DML detected via policy AUD_EMPLOYEE_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (45,to_timestamp('14-NOV-25 07.59.50.025348000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','PART_REQUEST','AUD_PART_REQUEST_UPDATE','1b660d4f-8faf-4ca5-bbbf-9e219c0b786c','Unauthorized DML detected via policy AUD_PART_REQUEST_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (46,to_timestamp('14-NOV-25 07.59.50.027430000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART_REQUEST','AUD_PART_REQUEST_UPDATE','1b660d4f-8faf-4ca5-bbbf-9e219c0b786c','UPDATE operation on PART_REQUEST - Changed: STATUS','UPDATE','STATUS');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (47,to_timestamp('14-NOV-25 07.59.50.034640000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','PART','AUD_PART_UPDATE','1b660d4f-8faf-4ca5-bbbf-9e219c0b786c','Unauthorized DML detected via policy AUD_PART_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (48,to_timestamp('14-NOV-25 07.59.50.035527000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART','AUD_PART_UPDATE','1b660d4f-8faf-4ca5-bbbf-9e219c0b786c','UPDATE operation on PART - Changed: STATUS,ORDER_ID','UPDATE','STATUS,ORDER_ID');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (49,to_timestamp('14-NOV-25 08.28.27.694103000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','EMPLOYEE','AUD_EMPLOYEE_INSERT','8f5b8e6d-2c10-49d6-83b5-0baa47003c25','Unauthorized DML detected via policy AUD_EMPLOYEE_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (50,to_timestamp('14-NOV-25 08.28.27.697905000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','EMPLOYEE','AUD_EMPLOYEE_INSERT','8f5b8e6d-2c10-49d6-83b5-0baa47003c25','INSERT operation on EMPLOYEE','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (51,to_timestamp('14-NOV-25 08.29.20.715764000 AM','DD-MON-RR HH.MI.SSXFF AM'),'1','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_KHACHHANG',null,'1','APP','CUSTOMER_APPOINTMENT','AUD_CUSTOMER_APPOINTMENT_INSERT','6949d39f-7a3a-4c16-9354-b45e7cd88de6','Unauthorized DML detected via policy AUD_CUSTOMER_APPOINTMENT_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (52,to_timestamp('14-NOV-25 08.29.20.718151000 AM','DD-MON-RR HH.MI.SSXFF AM'),'1','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_KHACHHANG',null,'1','1','CUSTOMER_APPOINTMENT','AUD_CUSTOMER_APPOINTMENT_INSERT','6949d39f-7a3a-4c16-9354-b45e7cd88de6','INSERT operation on CUSTOMER_APPOINTMENT','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (53,to_timestamp('14-NOV-25 08.54.18.048514000 AM','DD-MON-RR HH.MI.SSXFF AM'),'1','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-MOBILE','ROLE_KHACHHANG',null,'1','APP','CUSTOMER_APPOINTMENT','AUD_CUSTOMER_APPOINTMENT_INSERT','1ac25666-c75b-4e5b-8290-8b47f7d82932','Unauthorized DML detected via policy AUD_CUSTOMER_APPOINTMENT_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (54,to_timestamp('14-NOV-25 08.54.18.072343000 AM','DD-MON-RR HH.MI.SSXFF AM'),'1','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-MOBILE','ROLE_KHACHHANG',null,'1','1','CUSTOMER_APPOINTMENT','AUD_CUSTOMER_APPOINTMENT_INSERT','1ac25666-c75b-4e5b-8290-8b47f7d82932','INSERT operation on CUSTOMER_APPOINTMENT','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (55,to_timestamp('14-NOV-25 09.14.16.786599000 AM','DD-MON-RR HH.MI.SSXFF AM'),'APP','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI.exe','ROLE_UNKNOWN',null,null,'APP','CUSTOMER','AUD_CUSTOMER_INSERT',null,'Unauthorized DML detected via policy AUD_CUSTOMER_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (56,to_timestamp('14-NOV-25 09.14.16.789123000 AM','DD-MON-RR HH.MI.SSXFF AM'),'APP','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI.exe','ROLE_UNKNOWN',null,null,'APP','CUSTOMER','AUD_CUSTOMER_INSERT',null,'INSERT operation on CUSTOMER','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (57,to_timestamp('14-NOV-25 09.22.17.445982000 AM','DD-MON-RR HH.MI.SSXFF AM'),'2','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-MOBILE','ROLE_KHACHHANG',null,'2','APP','CUSTOMER','AUD_CUSTOMER_UPDATE','8a4bdcb0-e2a5-4e9d-be54-0affe29e3ab4','Unauthorized DML detected via policy AUD_CUSTOMER_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (58,to_timestamp('14-NOV-25 09.22.17.453457000 AM','DD-MON-RR HH.MI.SSXFF AM'),'2','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-MOBILE','ROLE_KHACHHANG',null,'2','2','CUSTOMER','AUD_CUSTOMER_UPDATE','8a4bdcb0-e2a5-4e9d-be54-0affe29e3ab4','UPDATE operation on CUSTOMER - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (41,to_timestamp('14-NOV-25 07.44.45.974114000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','PART_REQUEST','AUD_PART_REQUEST_INSERT','1b660d4f-8faf-4ca5-bbbf-9e219c0b786c','Unauthorized DML detected via policy AUD_PART_REQUEST_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (42,to_timestamp('14-NOV-25 07.44.45.998286000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','PART_REQUEST_ITEM','AUD_PART_REQUEST_ITEM_INSERT','1b660d4f-8faf-4ca5-bbbf-9e219c0b786c','Unauthorized DML detected via policy AUD_PART_REQUEST_ITEM_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (101,to_timestamp('15-NOV-25 06.46.27.285712000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_OUT','AUD_STOCK_OUT_INSERT','68a51ef4-7d90-4925-9f38-909b36675712','Unauthorized DML detected via policy AUD_STOCK_OUT_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (99,to_timestamp('15-NOV-25 06.46.08.748213000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','PART','AUD_PART_UPDATE','68a51ef4-7d90-4925-9f38-909b36675712','Unauthorized DML detected via policy AUD_PART_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (107,to_timestamp('15-NOV-25 06.47.00.047564000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_OUT','AUD_STOCK_OUT_INSERT','68a51ef4-7d90-4925-9f38-909b36675712','Unauthorized DML detected via policy AUD_STOCK_OUT_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (103,to_timestamp('15-NOV-25 06.46.27.287685000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_OUT_ITEM','AUD_STOCK_OUT_ITEM_INSERT','68a51ef4-7d90-4925-9f38-909b36675712','Unauthorized DML detected via policy AUD_STOCK_OUT_ITEM_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (113,to_timestamp('15-NOV-25 06.49.30.589920000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_OUT','AUD_STOCK_OUT_INSERT','68a51ef4-7d90-4925-9f38-909b36675712','Unauthorized DML detected via policy AUD_STOCK_OUT_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (105,to_timestamp('15-NOV-25 06.46.27.289069000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','PART','AUD_PART_UPDATE','68a51ef4-7d90-4925-9f38-909b36675712','Unauthorized DML detected via policy AUD_PART_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (109,to_timestamp('15-NOV-25 06.47.00.050845000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_OUT_ITEM','AUD_STOCK_OUT_ITEM_INSERT','68a51ef4-7d90-4925-9f38-909b36675712','Unauthorized DML detected via policy AUD_STOCK_OUT_ITEM_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (114,to_timestamp('15-NOV-25 06.49.30.590971000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_OUT','AUD_STOCK_OUT_INSERT','68a51ef4-7d90-4925-9f38-909b36675712','INSERT operation on STOCK_OUT','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (111,to_timestamp('15-NOV-25 06.47.00.054108000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','PART','AUD_PART_UPDATE','68a51ef4-7d90-4925-9f38-909b36675712','Unauthorized DML detected via policy AUD_PART_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (115,to_timestamp('15-NOV-25 06.49.30.594005000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_OUT_ITEM','AUD_STOCK_OUT_ITEM_INSERT','68a51ef4-7d90-4925-9f38-909b36675712','Unauthorized DML detected via policy AUD_STOCK_OUT_ITEM_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (116,to_timestamp('15-NOV-25 06.49.30.595239000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_OUT_ITEM','AUD_STOCK_OUT_ITEM_INSERT','68a51ef4-7d90-4925-9f38-909b36675712','INSERT operation on STOCK_OUT_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (117,to_timestamp('15-NOV-25 06.49.30.597876000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','PART','AUD_PART_UPDATE','68a51ef4-7d90-4925-9f38-909b36675712','Unauthorized DML detected via policy AUD_PART_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (118,to_timestamp('15-NOV-25 06.49.30.599039000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART','AUD_PART_UPDATE','68a51ef4-7d90-4925-9f38-909b36675712','UPDATE operation on PART - Changed: STATUS','UPDATE','STATUS');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (119,to_timestamp('15-NOV-25 06.49.30.612736000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','ORDERS','AUD_ORDERS_UPDATE','68a51ef4-7d90-4925-9f38-909b36675712','Unauthorized DML detected via policy AUD_ORDERS_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (120,to_timestamp('15-NOV-25 06.49.30.613233000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','ORDERS','AUD_ORDERS_UPDATE','68a51ef4-7d90-4925-9f38-909b36675712','UPDATE operation on ORDERS - Changed: STATUS','UPDATE','STATUS');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (121,to_timestamp('15-NOV-25 06.49.30.746584000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_OUT','AUD_STOCK_OUT_UPDATE','68a51ef4-7d90-4925-9f38-909b36675712','Unauthorized DML detected via policy AUD_STOCK_OUT_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (122,to_timestamp('15-NOV-25 06.49.30.750234000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_OUT','AUD_STOCK_OUT_UPDATE','68a51ef4-7d90-4925-9f38-909b36675712','UPDATE operation on STOCK_OUT - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (123,to_timestamp('15-NOV-25 06.49.30.860116000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','INVOICE','AUD_INVOICE_INSERT','68a51ef4-7d90-4925-9f38-909b36675712','Unauthorized DML detected via policy AUD_INVOICE_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (124,to_timestamp('15-NOV-25 06.49.30.861172000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','INVOICE','AUD_INVOICE_INSERT','68a51ef4-7d90-4925-9f38-909b36675712','INSERT operation on INVOICE','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (125,to_timestamp('15-NOV-25 06.49.30.898242000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','INVOICE_ITEM','AUD_INVOICE_ITEM_INSERT','68a51ef4-7d90-4925-9f38-909b36675712','Unauthorized DML detected via policy AUD_INVOICE_ITEM_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (126,to_timestamp('15-NOV-25 06.49.30.900078000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','INVOICE_ITEM','AUD_INVOICE_ITEM_INSERT','68a51ef4-7d90-4925-9f38-909b36675712','INSERT operation on INVOICE_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (127,to_timestamp('15-NOV-25 06.49.30.973195000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','INVOICE','AUD_INVOICE_UPDATE','68a51ef4-7d90-4925-9f38-909b36675712','Unauthorized DML detected via policy AUD_INVOICE_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (128,to_timestamp('15-NOV-25 06.49.30.973891000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','INVOICE','AUD_INVOICE_UPDATE','68a51ef4-7d90-4925-9f38-909b36675712','UPDATE operation on INVOICE - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (129,to_timestamp('15-NOV-25 06.49.55.768187000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_OUT','AUD_STOCK_OUT_UPDATE','68a51ef4-7d90-4925-9f38-909b36675712','Unauthorized DML detected via policy AUD_STOCK_OUT_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (130,to_timestamp('15-NOV-25 06.49.55.774531000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_OUT','AUD_STOCK_OUT_UPDATE','68a51ef4-7d90-4925-9f38-909b36675712','UPDATE operation on STOCK_OUT - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (131,to_timestamp('15-NOV-25 06.49.56.857533000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','INVOICE','AUD_INVOICE_UPDATE','68a51ef4-7d90-4925-9f38-909b36675712','Unauthorized DML detected via policy AUD_INVOICE_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (132,to_timestamp('15-NOV-25 06.49.56.858412000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','INVOICE','AUD_INVOICE_UPDATE','68a51ef4-7d90-4925-9f38-909b36675712','UPDATE operation on INVOICE - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (133,to_timestamp('15-NOV-25 06.51.47.183117000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_IN','AUD_STOCK_IN_INSERT','efb651f0-20ce-4318-a79e-01c8e824ce48','Unauthorized DML detected via policy AUD_STOCK_IN_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (134,to_timestamp('15-NOV-25 06.51.47.185297000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN','AUD_STOCK_IN_INSERT','efb651f0-20ce-4318-a79e-01c8e824ce48','INSERT operation on STOCK_IN','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (135,to_timestamp('15-NOV-25 06.51.47.191737000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_IN_ITEM','AUD_STOCK_IN_ITEM_INSERT','efb651f0-20ce-4318-a79e-01c8e824ce48','Unauthorized DML detected via policy AUD_STOCK_IN_ITEM_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (136,to_timestamp('15-NOV-25 06.51.47.192374000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN_ITEM','AUD_STOCK_IN_ITEM_INSERT','efb651f0-20ce-4318-a79e-01c8e824ce48','INSERT operation on STOCK_IN_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (137,to_timestamp('15-NOV-25 06.51.47.202705000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','PART','AUD_PART_INSERT','efb651f0-20ce-4318-a79e-01c8e824ce48','Unauthorized DML detected via policy AUD_PART_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (138,to_timestamp('15-NOV-25 06.51.47.203396000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART','AUD_PART_INSERT','efb651f0-20ce-4318-a79e-01c8e824ce48','INSERT operation on PART','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (139,to_timestamp('15-NOV-25 06.51.47.258855000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_IN','AUD_STOCK_IN_UPDATE','efb651f0-20ce-4318-a79e-01c8e824ce48','Unauthorized DML detected via policy AUD_STOCK_IN_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (140,to_timestamp('15-NOV-25 06.51.47.259568000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN','AUD_STOCK_IN_UPDATE','efb651f0-20ce-4318-a79e-01c8e824ce48','UPDATE operation on STOCK_IN - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (141,to_timestamp('15-NOV-25 06.52.05.064294000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_IN','AUD_STOCK_IN_UPDATE','efb651f0-20ce-4318-a79e-01c8e824ce48','Unauthorized DML detected via policy AUD_STOCK_IN_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (142,to_timestamp('15-NOV-25 06.52.05.066531000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN','AUD_STOCK_IN_UPDATE','efb651f0-20ce-4318-a79e-01c8e824ce48','UPDATE operation on STOCK_IN - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (161,to_timestamp('17-NOV-25 12.21.28.836544000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','ORDERS','AUD_ORDERS_INSERT','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','Unauthorized DML detected via policy AUD_ORDERS_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (163,to_timestamp('17-NOV-25 12.21.36.083679000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','PART_REQUEST','AUD_PART_REQUEST_INSERT','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','Unauthorized DML detected via policy AUD_PART_REQUEST_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (165,to_timestamp('17-NOV-25 12.21.36.114465000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','PART_REQUEST_ITEM','AUD_PART_REQUEST_ITEM_INSERT','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','Unauthorized DML detected via policy AUD_PART_REQUEST_ITEM_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (239,to_timestamp('18-NOV-25 02.24.49.925333000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','ORDERS','AUD_ORDERS_UPDATE','226fadf1-240c-45c2-b833-634e2e94d385','Unauthorized DML detected via policy AUD_ORDERS_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (240,to_timestamp('18-NOV-25 02.24.49.928119000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','ORDERS','AUD_ORDERS_UPDATE','226fadf1-240c-45c2-b833-634e2e94d385','UPDATE operation on ORDERS - Changed: STATUS','UPDATE','STATUS');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (241,to_timestamp('18-NOV-25 02.24.54.276795000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_OUT','AUD_STOCK_OUT_UPDATE','226fadf1-240c-45c2-b833-634e2e94d385','Unauthorized DML detected via policy AUD_STOCK_OUT_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (242,to_timestamp('18-NOV-25 02.24.54.277950000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_OUT','AUD_STOCK_OUT_UPDATE','226fadf1-240c-45c2-b833-634e2e94d385','UPDATE operation on STOCK_OUT - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (243,to_timestamp('18-NOV-25 02.24.54.335324000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','INVOICE','AUD_INVOICE_INSERT','226fadf1-240c-45c2-b833-634e2e94d385','Unauthorized DML detected via policy AUD_INVOICE_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (244,to_timestamp('18-NOV-25 02.24.54.336704000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','INVOICE','AUD_INVOICE_INSERT','226fadf1-240c-45c2-b833-634e2e94d385','INSERT operation on INVOICE','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (245,to_timestamp('18-NOV-25 02.24.54.370863000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','INVOICE_ITEM','AUD_INVOICE_ITEM_INSERT','226fadf1-240c-45c2-b833-634e2e94d385','Unauthorized DML detected via policy AUD_INVOICE_ITEM_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (246,to_timestamp('18-NOV-25 02.24.54.372285000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','INVOICE_ITEM','AUD_INVOICE_ITEM_INSERT','226fadf1-240c-45c2-b833-634e2e94d385','INSERT operation on INVOICE_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (247,to_timestamp('18-NOV-25 02.24.54.462422000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','INVOICE','AUD_INVOICE_UPDATE','226fadf1-240c-45c2-b833-634e2e94d385','Unauthorized DML detected via policy AUD_INVOICE_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (248,to_timestamp('18-NOV-25 02.24.54.463948000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','INVOICE','AUD_INVOICE_UPDATE','226fadf1-240c-45c2-b833-634e2e94d385','UPDATE operation on INVOICE - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (249,to_timestamp('18-NOV-25 02.25.16.149543000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_OUT','AUD_STOCK_OUT_UPDATE','226fadf1-240c-45c2-b833-634e2e94d385','Unauthorized DML detected via policy AUD_STOCK_OUT_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (250,to_timestamp('18-NOV-25 02.25.16.150222000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_OUT','AUD_STOCK_OUT_UPDATE','226fadf1-240c-45c2-b833-634e2e94d385','UPDATE operation on STOCK_OUT - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (251,to_timestamp('18-NOV-25 02.25.16.841718000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','INVOICE','AUD_INVOICE_UPDATE','226fadf1-240c-45c2-b833-634e2e94d385','Unauthorized DML detected via policy AUD_INVOICE_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (252,to_timestamp('18-NOV-25 02.25.16.842975000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','INVOICE','AUD_INVOICE_UPDATE','226fadf1-240c-45c2-b833-634e2e94d385','UPDATE operation on INVOICE - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (261,to_timestamp('20-NOV-25 01.35.35.764730000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','ORDERS','AUD_ORDERS_INSERT','178655f4-c72f-4022-928c-6bf52bb05685','INSERT operation on ORDERS','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (262,to_timestamp('20-NOV-25 01.35.42.926552000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART_REQUEST','AUD_PART_REQUEST_INSERT','178655f4-c72f-4022-928c-6bf52bb05685','INSERT operation on PART_REQUEST','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (263,to_timestamp('20-NOV-25 01.35.42.949921000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART_REQUEST_ITEM','AUD_PART_REQUEST_ITEM_INSERT','178655f4-c72f-4022-928c-6bf52bb05685','INSERT operation on PART_REQUEST_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (276,to_timestamp('20-NOV-25 04.51.00.046549000 PM','DD-MON-RR HH.MI.SSXFF AM'),'LBACSYS','ntdmi','DESKTOP-RE4E4P9','SQL Developer','ROLE_UNKNOWN',null,null,'LBACSYS','EMPLOYEE','AUD_EMPLOYEE_UPDATE',null,'UPDATE operation on EMPLOYEE - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (277,to_timestamp('20-NOV-25 04.54.27.707627000 PM','DD-MON-RR HH.MI.SSXFF AM'),'APP','ntdmi','DESKTOP-RE4E4P9','SQL Developer','ROLE_ADMIN',null,null,'APP','EMPLOYEE','AUD_EMPLOYEE_UPDATE',null,'UPDATE operation on EMPLOYEE - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (278,to_timestamp('20-NOV-25 04.54.27.723074000 PM','DD-MON-RR HH.MI.SSXFF AM'),'APP','ntdmi','DESKTOP-RE4E4P9','SQL Developer','ROLE_ADMIN',null,null,'APP','EMPLOYEE','AUD_EMPLOYEE_UPDATE',null,'UPDATE operation on EMPLOYEE - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (279,to_timestamp('20-NOV-25 04.54.27.736658000 PM','DD-MON-RR HH.MI.SSXFF AM'),'APP','ntdmi','DESKTOP-RE4E4P9','SQL Developer','ROLE_ADMIN',null,null,'APP','EMPLOYEE','AUD_EMPLOYEE_UPDATE',null,'UPDATE operation on EMPLOYEE - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (280,to_timestamp('20-NOV-25 04.54.27.752247000 PM','DD-MON-RR HH.MI.SSXFF AM'),'APP','ntdmi','DESKTOP-RE4E4P9','SQL Developer','ROLE_ADMIN',null,null,'APP','EMPLOYEE','AUD_EMPLOYEE_UPDATE',null,'UPDATE operation on EMPLOYEE - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (281,to_timestamp('20-NOV-25 05.08.01.228077000 PM','DD-MON-RR HH.MI.SSXFF AM'),'APP','ntdmi','DESKTOP-RE4E4P9','SQL Developer','ROLE_ADMIN',null,null,'APP','EMPLOYEE','AUD_EMPLOYEE_UPDATE',null,'UPDATE operation on EMPLOYEE - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (282,to_timestamp('20-NOV-25 05.08.01.243215000 PM','DD-MON-RR HH.MI.SSXFF AM'),'APP','ntdmi','DESKTOP-RE4E4P9','SQL Developer','ROLE_ADMIN',null,null,'APP','EMPLOYEE','AUD_EMPLOYEE_UPDATE',null,'UPDATE operation on EMPLOYEE - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (283,to_timestamp('20-NOV-25 05.08.01.255029000 PM','DD-MON-RR HH.MI.SSXFF AM'),'APP','ntdmi','DESKTOP-RE4E4P9','SQL Developer','ROLE_ADMIN',null,null,'APP','EMPLOYEE','AUD_EMPLOYEE_UPDATE',null,'UPDATE operation on EMPLOYEE - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (288,to_timestamp('20-NOV-25 07.09.23.471839000 PM','DD-MON-RR HH.MI.SSXFF AM'),'THUKHO','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_THUKHO','2',null,'THUKHO','STOCK_IN','AUD_STOCK_IN_INSERT','69b9616c-0254-46df-8833-e16be5adf8f5','INSERT operation on STOCK_IN','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (289,to_timestamp('20-NOV-25 07.09.23.492037000 PM','DD-MON-RR HH.MI.SSXFF AM'),'THUKHO','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_THUKHO','2',null,'THUKHO','STOCK_IN_ITEM','AUD_STOCK_IN_ITEM_INSERT','69b9616c-0254-46df-8833-e16be5adf8f5','INSERT operation on STOCK_IN_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (290,to_timestamp('20-NOV-25 07.09.23.506631000 PM','DD-MON-RR HH.MI.SSXFF AM'),'THUKHO','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_THUKHO','2',null,'THUKHO','PART','AUD_PART_INSERT','69b9616c-0254-46df-8833-e16be5adf8f5','INSERT operation on PART','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (291,to_timestamp('20-NOV-25 07.09.30.303066000 PM','DD-MON-RR HH.MI.SSXFF AM'),'THUKHO','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_THUKHO','2',null,'THUKHO','STOCK_IN','AUD_STOCK_IN_UPDATE','69b9616c-0254-46df-8833-e16be5adf8f5','UPDATE operation on STOCK_IN - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (292,to_timestamp('20-NOV-25 07.09.52.935152000 PM','DD-MON-RR HH.MI.SSXFF AM'),'THUKHO','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_THUKHO','2',null,'THUKHO','STOCK_IN','AUD_STOCK_IN_UPDATE','69b9616c-0254-46df-8833-e16be5adf8f5','UPDATE operation on STOCK_IN - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (296,to_timestamp('20-NOV-25 09.00.36.047827000 PM','DD-MON-RR HH.MI.SSXFF AM'),'KITHUATVIEN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_KITHUATVIEN','3',null,'KITHUATVIEN','PART_REQUEST','AUD_PART_REQUEST_INSERT','63cbe712-87bc-4b9a-bf64-d007d7b388a0','INSERT operation on PART_REQUEST','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (297,to_timestamp('20-NOV-25 09.00.36.083649000 PM','DD-MON-RR HH.MI.SSXFF AM'),'KITHUATVIEN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_KITHUATVIEN','3',null,'KITHUATVIEN','PART_REQUEST_ITEM','AUD_PART_REQUEST_ITEM_INSERT','63cbe712-87bc-4b9a-bf64-d007d7b388a0','INSERT operation on PART_REQUEST_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (298,to_timestamp('20-NOV-25 09.00.36.092682000 PM','DD-MON-RR HH.MI.SSXFF AM'),'KITHUATVIEN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_KITHUATVIEN','3',null,'KITHUATVIEN','PART','AUD_PART_UPDATE','63cbe712-87bc-4b9a-bf64-d007d7b388a0','UPDATE operation on PART - Changed: STATUS','UPDATE','STATUS');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (305,to_timestamp('20-NOV-25 09.18.57.281394000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART','AUD_PART_UPDATE','c80ffe9b-ff67-4ff2-a5a8-c50afb3c8e4d','UPDATE operation on PART - Changed: STATUS,ORDER_ID','UPDATE','STATUS,ORDER_ID');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (307,to_timestamp('23-NOV-25 09.09.52.359896000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN','AUD_STOCK_IN_INSERT','1272326d-2b75-422a-ad43-5d7a72f63778','INSERT operation on STOCK_IN','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (308,to_timestamp('23-NOV-25 09.09.52.394967000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN_ITEM','AUD_STOCK_IN_ITEM_INSERT','1272326d-2b75-422a-ad43-5d7a72f63778','INSERT operation on STOCK_IN_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (309,to_timestamp('23-NOV-25 09.09.52.423929000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART','AUD_PART_INSERT','1272326d-2b75-422a-ad43-5d7a72f63778','INSERT operation on PART','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (310,to_timestamp('23-NOV-25 09.10.14.357586000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN','AUD_STOCK_IN_UPDATE','1272326d-2b75-422a-ad43-5d7a72f63778','UPDATE operation on STOCK_IN - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (311,to_timestamp('23-NOV-25 09.20.36.894113000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_OUT','AUD_STOCK_OUT_INSERT','5ae699fc-31ab-4119-aa2b-8f7835d2a421','INSERT operation on STOCK_OUT','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (180,to_timestamp('17-NOV-25 12.22.04.933836000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','ORDERS','AUD_ORDERS_UPDATE','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','UPDATE operation on ORDERS - Changed: STATUS','UPDATE','STATUS');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (181,to_timestamp('17-NOV-25 12.22.13.652989000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_OUT','AUD_STOCK_OUT_UPDATE','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','Unauthorized DML detected via policy AUD_STOCK_OUT_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (182,to_timestamp('17-NOV-25 12.22.13.654660000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_OUT','AUD_STOCK_OUT_UPDATE','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','UPDATE operation on STOCK_OUT - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (183,to_timestamp('17-NOV-25 12.22.13.709213000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','INVOICE','AUD_INVOICE_INSERT','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','Unauthorized DML detected via policy AUD_INVOICE_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (184,to_timestamp('17-NOV-25 12.22.13.713782000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','INVOICE','AUD_INVOICE_INSERT','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','INSERT operation on INVOICE','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (185,to_timestamp('17-NOV-25 12.22.13.752392000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','INVOICE_ITEM','AUD_INVOICE_ITEM_INSERT','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','Unauthorized DML detected via policy AUD_INVOICE_ITEM_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (186,to_timestamp('17-NOV-25 12.22.13.754437000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','INVOICE_ITEM','AUD_INVOICE_ITEM_INSERT','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','INSERT operation on INVOICE_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (187,to_timestamp('17-NOV-25 12.22.13.831214000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','INVOICE','AUD_INVOICE_UPDATE','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','Unauthorized DML detected via policy AUD_INVOICE_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (188,to_timestamp('17-NOV-25 12.22.13.833726000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','INVOICE','AUD_INVOICE_UPDATE','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','UPDATE operation on INVOICE - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (189,to_timestamp('17-NOV-25 12.22.49.700555000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_OUT','AUD_STOCK_OUT_UPDATE','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','Unauthorized DML detected via policy AUD_STOCK_OUT_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (190,to_timestamp('17-NOV-25 12.22.49.701403000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_OUT','AUD_STOCK_OUT_UPDATE','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','UPDATE operation on STOCK_OUT - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (191,to_timestamp('17-NOV-25 12.22.50.531251000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','INVOICE','AUD_INVOICE_UPDATE','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','Unauthorized DML detected via policy AUD_INVOICE_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (192,to_timestamp('17-NOV-25 12.22.50.534058000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','INVOICE','AUD_INVOICE_UPDATE','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','UPDATE operation on INVOICE - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (193,to_timestamp('17-NOV-25 12.23.24.928548000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_IN','AUD_STOCK_IN_INSERT','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','Unauthorized DML detected via policy AUD_STOCK_IN_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (194,to_timestamp('17-NOV-25 12.23.24.930021000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN','AUD_STOCK_IN_INSERT','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','INSERT operation on STOCK_IN','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (195,to_timestamp('17-NOV-25 12.23.25.047084000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_IN_ITEM','AUD_STOCK_IN_ITEM_INSERT','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','Unauthorized DML detected via policy AUD_STOCK_IN_ITEM_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (196,to_timestamp('17-NOV-25 12.23.25.050129000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN_ITEM','AUD_STOCK_IN_ITEM_INSERT','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','INSERT operation on STOCK_IN_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (197,to_timestamp('17-NOV-25 12.23.25.094699000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','PART','AUD_PART_INSERT','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','Unauthorized DML detected via policy AUD_PART_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (198,to_timestamp('17-NOV-25 12.23.25.129128000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART','AUD_PART_INSERT','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','INSERT operation on PART','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (199,to_timestamp('17-NOV-25 12.23.25.625503000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_IN','AUD_STOCK_IN_UPDATE','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','Unauthorized DML detected via policy AUD_STOCK_IN_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (200,to_timestamp('17-NOV-25 12.23.25.628589000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN','AUD_STOCK_IN_UPDATE','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','UPDATE operation on STOCK_IN - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (201,to_timestamp('17-NOV-25 12.23.27.674634000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_IN','AUD_STOCK_IN_UPDATE','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','Unauthorized DML detected via policy AUD_STOCK_IN_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (202,to_timestamp('17-NOV-25 12.23.27.675755000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN','AUD_STOCK_IN_UPDATE','00ad60e4-1bb6-4ff5-9a1f-6121013ce3d8','UPDATE operation on STOCK_IN - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (264,to_timestamp('20-NOV-25 01.35.42.958400000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART','AUD_PART_UPDATE','178655f4-c72f-4022-928c-6bf52bb05685','UPDATE operation on PART - Changed: STATUS','UPDATE','STATUS');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (265,to_timestamp('20-NOV-25 01.35.44.992410000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART_REQUEST','AUD_PART_REQUEST_UPDATE','178655f4-c72f-4022-928c-6bf52bb05685','UPDATE operation on PART_REQUEST - Changed: STATUS','UPDATE','STATUS');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (266,to_timestamp('20-NOV-25 01.35.45.002274000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART','AUD_PART_UPDATE','178655f4-c72f-4022-928c-6bf52bb05685','UPDATE operation on PART - Changed: STATUS,ORDER_ID','UPDATE','STATUS,ORDER_ID');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (293,to_timestamp('20-NOV-25 08.05.10.843214000 PM','DD-MON-RR HH.MI.SSXFF AM'),'TIEPTAN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_TIEPTAN','4',null,'TIEPTAN','ORDERS','AUD_ORDERS_INSERT','9b2a496c-a3c5-4e83-9db3-2a391adf1dfb','INSERT operation on ORDERS','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (312,to_timestamp('23-NOV-25 09.20.36.906280000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_OUT_ITEM','AUD_STOCK_OUT_ITEM_INSERT','5ae699fc-31ab-4119-aa2b-8f7835d2a421','INSERT operation on STOCK_OUT_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (313,to_timestamp('23-NOV-25 09.20.36.913020000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART','AUD_PART_UPDATE','5ae699fc-31ab-4119-aa2b-8f7835d2a421','UPDATE operation on PART - Changed: STATUS','UPDATE','STATUS');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (315,to_timestamp('23-NOV-25 09.20.36.958023000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','INVOICE','AUD_INVOICE_INSERT','5ae699fc-31ab-4119-aa2b-8f7835d2a421','INSERT operation on INVOICE','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (284,to_timestamp('20-NOV-25 05.08.01.267286000 PM','DD-MON-RR HH.MI.SSXFF AM'),'APP','ntdmi','DESKTOP-RE4E4P9','SQL Developer','ROLE_ADMIN',null,null,'APP','EMPLOYEE','AUD_EMPLOYEE_UPDATE',null,'UPDATE operation on EMPLOYEE - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (285,to_timestamp('20-NOV-25 05.56.09.964697000 PM','DD-MON-RR HH.MI.SSXFF AM'),'APP','ntdmi','DESKTOP-RE4E4P9','SQL Developer','ROLE_ADMIN',null,null,'APP','EMPLOYEE','AUD_EMPLOYEE_UPDATE',null,'UPDATE operation on EMPLOYEE - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (286,to_timestamp('20-NOV-25 05.56.14.384320000 PM','DD-MON-RR HH.MI.SSXFF AM'),'APP','ntdmi','DESKTOP-RE4E4P9','SQL Developer','ROLE_ADMIN',null,null,'APP','EMPLOYEE','AUD_EMPLOYEE_UPDATE',null,'UPDATE operation on EMPLOYEE - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (287,to_timestamp('20-NOV-25 06.56.21.853300000 PM','DD-MON-RR HH.MI.SSXFF AM'),'APP','ntdmi','DESKTOP-RE4E4P9','SQL Developer','ROLE_ADMIN',null,null,'APP','EMPLOYEE','AUD_EMPLOYEE_UPDATE',null,'UPDATE operation on EMPLOYEE - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (299,to_timestamp('20-NOV-25 09.13.27.568302000 PM','DD-MON-RR HH.MI.SSXFF AM'),'THUKHO','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_THUKHO','2',null,'THUKHO','PART_REQUEST','AUD_PART_REQUEST_UPDATE','7fddd948-e78d-4a41-b796-8553189432c8','UPDATE operation on PART_REQUEST - Changed: STATUS','UPDATE','STATUS');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (300,to_timestamp('20-NOV-25 09.13.27.583799000 PM','DD-MON-RR HH.MI.SSXFF AM'),'THUKHO','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_THUKHO','2',null,'THUKHO','PART','AUD_PART_UPDATE','7fddd948-e78d-4a41-b796-8553189432c8','UPDATE operation on PART - Changed: STATUS,ORDER_ID','UPDATE','STATUS,ORDER_ID');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (301,to_timestamp('20-NOV-25 09.18.54.213630000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART_REQUEST','AUD_PART_REQUEST_INSERT','c80ffe9b-ff67-4ff2-a5a8-c50afb3c8e4d','INSERT operation on PART_REQUEST','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (302,to_timestamp('20-NOV-25 09.18.54.223839000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART_REQUEST_ITEM','AUD_PART_REQUEST_ITEM_INSERT','c80ffe9b-ff67-4ff2-a5a8-c50afb3c8e4d','INSERT operation on PART_REQUEST_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (303,to_timestamp('20-NOV-25 09.18.54.229332000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART','AUD_PART_UPDATE','c80ffe9b-ff67-4ff2-a5a8-c50afb3c8e4d','UPDATE operation on PART - Changed: STATUS','UPDATE','STATUS');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (304,to_timestamp('20-NOV-25 09.18.57.275774000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART_REQUEST','AUD_PART_REQUEST_UPDATE','c80ffe9b-ff67-4ff2-a5a8-c50afb3c8e4d','UPDATE operation on PART_REQUEST - Changed: STATUS','UPDATE','STATUS');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (267,to_timestamp('20-NOV-25 04.18.01.001522000 PM','DD-MON-RR HH.MI.SSXFF AM'),'APP','ntdmi','DESKTOP-RE4E4P9','SQL Developer','ROLE_ADMIN',null,null,'APP','EMPLOYEE','AUD_EMPLOYEE_UPDATE',null,'UPDATE operation on EMPLOYEE - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (268,to_timestamp('20-NOV-25 04.18.08.995866000 PM','DD-MON-RR HH.MI.SSXFF AM'),'APP','ntdmi','DESKTOP-RE4E4P9','SQL Developer','ROLE_ADMIN',null,null,'APP','EMPLOYEE','AUD_EMPLOYEE_UPDATE',null,'UPDATE operation on EMPLOYEE - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (269,to_timestamp('20-NOV-25 04.18.18.273887000 PM','DD-MON-RR HH.MI.SSXFF AM'),'APP','ntdmi','DESKTOP-RE4E4P9','SQL Developer','ROLE_ADMIN',null,null,'APP','EMPLOYEE','AUD_EMPLOYEE_UPDATE',null,'UPDATE operation on EMPLOYEE - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (270,to_timestamp('20-NOV-25 04.18.18.287178000 PM','DD-MON-RR HH.MI.SSXFF AM'),'APP','ntdmi','DESKTOP-RE4E4P9','SQL Developer','ROLE_ADMIN',null,null,'APP','EMPLOYEE','AUD_EMPLOYEE_UPDATE',null,'UPDATE operation on EMPLOYEE - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (271,to_timestamp('20-NOV-25 04.26.41.684180000 PM','DD-MON-RR HH.MI.SSXFF AM'),'APP','ntdmi','DESKTOP-RE4E4P9','SQL Developer','ROLE_ADMIN',null,null,'APP','EMPLOYEE','AUD_EMPLOYEE_UPDATE',null,'UPDATE operation on EMPLOYEE - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (272,to_timestamp('20-NOV-25 04.26.41.696374000 PM','DD-MON-RR HH.MI.SSXFF AM'),'APP','ntdmi','DESKTOP-RE4E4P9','SQL Developer','ROLE_ADMIN',null,null,'APP','EMPLOYEE','AUD_EMPLOYEE_UPDATE',null,'UPDATE operation on EMPLOYEE - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (273,to_timestamp('20-NOV-25 04.26.41.708353000 PM','DD-MON-RR HH.MI.SSXFF AM'),'APP','ntdmi','DESKTOP-RE4E4P9','SQL Developer','ROLE_ADMIN',null,null,'APP','EMPLOYEE','AUD_EMPLOYEE_UPDATE',null,'UPDATE operation on EMPLOYEE - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (274,to_timestamp('20-NOV-25 04.26.41.721770000 PM','DD-MON-RR HH.MI.SSXFF AM'),'APP','ntdmi','DESKTOP-RE4E4P9','SQL Developer','ROLE_ADMIN',null,null,'APP','EMPLOYEE','AUD_EMPLOYEE_UPDATE',null,'UPDATE operation on EMPLOYEE - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (275,to_timestamp('20-NOV-25 04.35.19.233766000 PM','DD-MON-RR HH.MI.SSXFF AM'),'APP','ntdmi','DESKTOP-RE4E4P9','SQL Developer','ROLE_ADMIN',null,null,'APP','EMPLOYEE','AUD_EMPLOYEE_UPDATE',null,'UPDATE operation on EMPLOYEE - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (221,to_timestamp('18-NOV-25 02.24.31.922567000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','ORDERS','AUD_ORDERS_INSERT','226fadf1-240c-45c2-b833-634e2e94d385','Unauthorized DML detected via policy AUD_ORDERS_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (222,to_timestamp('18-NOV-25 02.24.31.939964000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','ORDERS','AUD_ORDERS_INSERT','226fadf1-240c-45c2-b833-634e2e94d385','INSERT operation on ORDERS','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (223,to_timestamp('18-NOV-25 02.24.39.839591000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','PART_REQUEST','AUD_PART_REQUEST_INSERT','226fadf1-240c-45c2-b833-634e2e94d385','Unauthorized DML detected via policy AUD_PART_REQUEST_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (224,to_timestamp('18-NOV-25 02.24.39.842137000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART_REQUEST','AUD_PART_REQUEST_INSERT','226fadf1-240c-45c2-b833-634e2e94d385','INSERT operation on PART_REQUEST','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (225,to_timestamp('18-NOV-25 02.24.39.859563000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','PART_REQUEST_ITEM','AUD_PART_REQUEST_ITEM_INSERT','226fadf1-240c-45c2-b833-634e2e94d385','Unauthorized DML detected via policy AUD_PART_REQUEST_ITEM_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (226,to_timestamp('18-NOV-25 02.24.39.860145000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART_REQUEST_ITEM','AUD_PART_REQUEST_ITEM_INSERT','226fadf1-240c-45c2-b833-634e2e94d385','INSERT operation on PART_REQUEST_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (227,to_timestamp('18-NOV-25 02.24.39.869567000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','PART','AUD_PART_UPDATE','226fadf1-240c-45c2-b833-634e2e94d385','Unauthorized DML detected via policy AUD_PART_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (228,to_timestamp('18-NOV-25 02.24.39.870989000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART','AUD_PART_UPDATE','226fadf1-240c-45c2-b833-634e2e94d385','UPDATE operation on PART - Changed: STATUS','UPDATE','STATUS');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (229,to_timestamp('18-NOV-25 02.24.41.150065000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','PART_REQUEST','AUD_PART_REQUEST_UPDATE','226fadf1-240c-45c2-b833-634e2e94d385','Unauthorized DML detected via policy AUD_PART_REQUEST_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (230,to_timestamp('18-NOV-25 02.24.41.152061000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART_REQUEST','AUD_PART_REQUEST_UPDATE','226fadf1-240c-45c2-b833-634e2e94d385','UPDATE operation on PART_REQUEST - Changed: STATUS','UPDATE','STATUS');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (231,to_timestamp('18-NOV-25 02.24.41.159174000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','PART','AUD_PART_UPDATE','226fadf1-240c-45c2-b833-634e2e94d385','Unauthorized DML detected via policy AUD_PART_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (232,to_timestamp('18-NOV-25 02.24.41.159863000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART','AUD_PART_UPDATE','226fadf1-240c-45c2-b833-634e2e94d385','UPDATE operation on PART - Changed: STATUS,ORDER_ID','UPDATE','STATUS,ORDER_ID');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (233,to_timestamp('18-NOV-25 02.24.49.901079000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_OUT','AUD_STOCK_OUT_INSERT','226fadf1-240c-45c2-b833-634e2e94d385','Unauthorized DML detected via policy AUD_STOCK_OUT_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (234,to_timestamp('18-NOV-25 02.24.49.901800000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_OUT','AUD_STOCK_OUT_INSERT','226fadf1-240c-45c2-b833-634e2e94d385','INSERT operation on STOCK_OUT','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (235,to_timestamp('18-NOV-25 02.24.49.915637000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','STOCK_OUT_ITEM','AUD_STOCK_OUT_ITEM_INSERT','226fadf1-240c-45c2-b833-634e2e94d385','Unauthorized DML detected via policy AUD_STOCK_OUT_ITEM_INSERT',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (236,to_timestamp('18-NOV-25 02.24.49.916658000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_OUT_ITEM','AUD_STOCK_OUT_ITEM_INSERT','226fadf1-240c-45c2-b833-634e2e94d385','INSERT operation on STOCK_OUT_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (237,to_timestamp('18-NOV-25 02.24.49.920980000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'APP','PART','AUD_PART_UPDATE','226fadf1-240c-45c2-b833-634e2e94d385','Unauthorized DML detected via policy AUD_PART_UPDATE',null,null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (238,to_timestamp('18-NOV-25 02.24.49.921549000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART','AUD_PART_UPDATE','226fadf1-240c-45c2-b833-634e2e94d385','UPDATE operation on PART - Changed: STATUS','UPDATE','STATUS');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (314,to_timestamp('23-NOV-25 09.20.36.925036000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','ORDERS','AUD_ORDERS_UPDATE','5ae699fc-31ab-4119-aa2b-8f7835d2a421','UPDATE operation on ORDERS - Changed: STATUS','UPDATE','STATUS');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (316,to_timestamp('23-NOV-25 09.20.36.974418000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','INVOICE_ITEM','AUD_INVOICE_ITEM_INSERT','5ae699fc-31ab-4119-aa2b-8f7835d2a421','INSERT operation on INVOICE_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (317,to_timestamp('23-NOV-25 09.20.57.457476000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_OUT','AUD_STOCK_OUT_UPDATE','5ae699fc-31ab-4119-aa2b-8f7835d2a421','UPDATE operation on STOCK_OUT - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (318,to_timestamp('23-NOV-25 09.20.58.111138000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','INVOICE','AUD_INVOICE_UPDATE','5ae699fc-31ab-4119-aa2b-8f7835d2a421','UPDATE operation on INVOICE - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (348,to_timestamp('23-NOV-25 05.57.51.805797000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN','AUD_STOCK_IN_INSERT','cd994fee-d24e-4608-86c5-ff16012c9fde','INSERT operation on STOCK_IN','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (349,to_timestamp('23-NOV-25 05.57.51.811933000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN_ITEM','AUD_STOCK_IN_ITEM_INSERT','cd994fee-d24e-4608-86c5-ff16012c9fde','INSERT operation on STOCK_IN_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (350,to_timestamp('23-NOV-25 05.57.51.817848000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART','AUD_PART_INSERT','cd994fee-d24e-4608-86c5-ff16012c9fde','INSERT operation on PART','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (351,to_timestamp('23-NOV-25 05.58.17.871591000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN','AUD_STOCK_IN_UPDATE','cd994fee-d24e-4608-86c5-ff16012c9fde','UPDATE operation on STOCK_IN - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (364,to_timestamp('23-NOV-25 06.44.47.737674000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_OUT','AUD_STOCK_OUT_INSERT','d2d458e2-e915-4fd6-8ec1-58e53313f1e6','INSERT operation on STOCK_OUT','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (365,to_timestamp('23-NOV-25 06.44.47.793600000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_OUT_ITEM','AUD_STOCK_OUT_ITEM_INSERT','d2d458e2-e915-4fd6-8ec1-58e53313f1e6','INSERT operation on STOCK_OUT_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (366,to_timestamp('23-NOV-25 06.44.47.794821000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_OUT_ITEM','AUD_STOCK_OUT_ITEM_INSERT','d2d458e2-e915-4fd6-8ec1-58e53313f1e6','INSERT operation on STOCK_OUT_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (367,to_timestamp('23-NOV-25 06.44.47.806367000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART','AUD_PART_UPDATE','d2d458e2-e915-4fd6-8ec1-58e53313f1e6','UPDATE operation on PART - Changed: STATUS','UPDATE','STATUS');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (414,to_timestamp('24-NOV-25 10.30.51.925785000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','ORDERS','AUD_ORDERS_UPDATE','7ae26413-2d41-465b-9800-4b0694916e5e','UPDATE operation on ORDERS - Changed: STATUS','UPDATE','STATUS');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (319,to_timestamp('23-NOV-25 03.47.38.406158000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN','AUD_STOCK_IN_INSERT','d2007deb-7940-4c31-a3af-d45a2cbec2c1','INSERT operation on STOCK_IN','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (320,to_timestamp('23-NOV-25 03.47.38.435067000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN_ITEM','AUD_STOCK_IN_ITEM_INSERT','d2007deb-7940-4c31-a3af-d45a2cbec2c1','INSERT operation on STOCK_IN_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (321,to_timestamp('23-NOV-25 03.47.38.456907000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART','AUD_PART_INSERT','d2007deb-7940-4c31-a3af-d45a2cbec2c1','INSERT operation on PART','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (322,to_timestamp('23-NOV-25 03.48.04.463294000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN','AUD_STOCK_IN_UPDATE','d2007deb-7940-4c31-a3af-d45a2cbec2c1','UPDATE operation on STOCK_IN - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (327,to_timestamp('23-NOV-25 04.43.07.838940000 PM','DD-MON-RR HH.MI.SSXFF AM'),'1','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_KHACHHANG',null,'1','1','CUSTOMER','AUD_CUSTOMER_UPDATE','8eeb932a-fbe1-408a-aa8b-df848c9984f8','UPDATE operation on CUSTOMER - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (328,to_timestamp('23-NOV-25 04.54.14.270135000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN','AUD_STOCK_IN_INSERT','e60b7e21-949f-4a13-bace-0b1b9625dcf3','INSERT operation on STOCK_IN','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (329,to_timestamp('23-NOV-25 04.54.14.278040000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN_ITEM','AUD_STOCK_IN_ITEM_INSERT','e60b7e21-949f-4a13-bace-0b1b9625dcf3','INSERT operation on STOCK_IN_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (330,to_timestamp('23-NOV-25 04.54.14.284232000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART','AUD_PART_INSERT','e60b7e21-949f-4a13-bace-0b1b9625dcf3','INSERT operation on PART','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (331,to_timestamp('23-NOV-25 04.54.37.008416000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN','AUD_STOCK_IN_UPDATE','e60b7e21-949f-4a13-bace-0b1b9625dcf3','UPDATE operation on STOCK_IN - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (332,to_timestamp('23-NOV-25 05.03.54.392588000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN','AUD_STOCK_IN_INSERT','509db767-5b77-43a8-990e-e764f0c2c585','INSERT operation on STOCK_IN','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (333,to_timestamp('23-NOV-25 05.03.54.397925000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN_ITEM','AUD_STOCK_IN_ITEM_INSERT','509db767-5b77-43a8-990e-e764f0c2c585','INSERT operation on STOCK_IN_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (334,to_timestamp('23-NOV-25 05.03.54.402019000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART','AUD_PART_INSERT','509db767-5b77-43a8-990e-e764f0c2c585','INSERT operation on PART','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (335,to_timestamp('23-NOV-25 05.04.17.594059000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN','AUD_STOCK_IN_UPDATE','509db767-5b77-43a8-990e-e764f0c2c585','UPDATE operation on STOCK_IN - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (336,to_timestamp('23-NOV-25 05.25.11.399248000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN','AUD_STOCK_IN_INSERT','8c62a73d-15ae-4b22-9fe6-020181073cd0','INSERT operation on STOCK_IN','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (337,to_timestamp('23-NOV-25 05.25.11.404900000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN_ITEM','AUD_STOCK_IN_ITEM_INSERT','8c62a73d-15ae-4b22-9fe6-020181073cd0','INSERT operation on STOCK_IN_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (338,to_timestamp('23-NOV-25 05.25.11.410038000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART','AUD_PART_INSERT','8c62a73d-15ae-4b22-9fe6-020181073cd0','INSERT operation on PART','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (339,to_timestamp('23-NOV-25 05.25.31.452765000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN','AUD_STOCK_IN_UPDATE','8c62a73d-15ae-4b22-9fe6-020181073cd0','UPDATE operation on STOCK_IN - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (340,to_timestamp('23-NOV-25 05.45.21.921682000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN','AUD_STOCK_IN_INSERT','83ca9396-1085-427c-8419-700678422af7','INSERT operation on STOCK_IN','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (341,to_timestamp('23-NOV-25 05.45.21.926195000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN_ITEM','AUD_STOCK_IN_ITEM_INSERT','83ca9396-1085-427c-8419-700678422af7','INSERT operation on STOCK_IN_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (342,to_timestamp('23-NOV-25 05.45.21.930034000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART','AUD_PART_INSERT','83ca9396-1085-427c-8419-700678422af7','INSERT operation on PART','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (343,to_timestamp('23-NOV-25 05.45.43.406564000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN','AUD_STOCK_IN_UPDATE','83ca9396-1085-427c-8419-700678422af7','UPDATE operation on STOCK_IN - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (344,to_timestamp('23-NOV-25 05.48.38.070026000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN','AUD_STOCK_IN_INSERT','dadf3c2a-588a-414b-a573-668a59f72b9c','INSERT operation on STOCK_IN','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (345,to_timestamp('23-NOV-25 05.48.38.077446000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN_ITEM','AUD_STOCK_IN_ITEM_INSERT','dadf3c2a-588a-414b-a573-668a59f72b9c','INSERT operation on STOCK_IN_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (346,to_timestamp('23-NOV-25 05.48.38.083848000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART','AUD_PART_INSERT','dadf3c2a-588a-414b-a573-668a59f72b9c','INSERT operation on PART','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (347,to_timestamp('23-NOV-25 05.49.00.662835000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN','AUD_STOCK_IN_UPDATE','dadf3c2a-588a-414b-a573-668a59f72b9c','UPDATE operation on STOCK_IN - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (387,to_timestamp('24-NOV-25 12.07.25.367723000 AM','DD-MON-RR HH.MI.SSXFF AM'),'1','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_KHACHHANG',null,'1','1','CUSTOMER','AUD_CUSTOMER_UPDATE','73bc00d8-e4ee-48a5-801b-08fca0b82cea','UPDATE operation on CUSTOMER - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (388,to_timestamp('24-NOV-25 12.10.57.492810000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','EMPLOYEE','AUD_EMPLOYEE_UPDATE','2c680fac-609a-42a2-bf79-6f6416ef7983','UPDATE operation on EMPLOYEE - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (389,to_timestamp('24-NOV-25 12.22.04.517956000 AM','DD-MON-RR HH.MI.SSXFF AM'),'1','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-MOBILE','ROLE_KHACHHANG',null,'1','1','CUSTOMER_APPOINTMENT','AUD_CUSTOMER_APPOINTMENT_INSERT','132db443-6881-416c-958d-4433fff62db3','INSERT operation on CUSTOMER_APPOINTMENT','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (415,to_timestamp('24-NOV-25 10.45.41.669954000 AM','DD-MON-RR HH.MI.SSXFF AM'),'APP','ntdmi','DESKTOP-RE4E4P9','SQL Developer','ROLE_ADMIN',null,null,'APP','CUSTOMER','AUD_CUSTOMER_UPDATE',null,'UPDATE operation on CUSTOMER - Changed: EMAIL','UPDATE','EMAIL');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (427,to_timestamp('24-NOV-25 05.34.41.378616000 PM','DD-MON-RR HH.MI.SSXFF AM'),'APP','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI.exe','ROLE_VERIFY',null,null,'APP','CUSTOMER','AUD_CUSTOMER_UPDATE',null,'UPDATE operation on CUSTOMER - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (428,to_timestamp('24-NOV-25 06.04.47.527363000 PM','DD-MON-RR HH.MI.SSXFF AM'),'APP','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI.exe','ROLE_VERIFY',null,null,'APP','CUSTOMER','AUD_CUSTOMER_UPDATE',null,'UPDATE operation on CUSTOMER - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (429,to_timestamp('24-NOV-25 06.05.16.680256000 PM','DD-MON-RR HH.MI.SSXFF AM'),'APP','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI.exe','ROLE_VERIFY',null,null,'APP','CUSTOMER','AUD_CUSTOMER_UPDATE',null,'UPDATE operation on CUSTOMER - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (368,to_timestamp('23-NOV-25 06.44.47.808430000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART','AUD_PART_UPDATE','d2d458e2-e915-4fd6-8ec1-58e53313f1e6','UPDATE operation on PART - Changed: STATUS','UPDATE','STATUS');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (369,to_timestamp('23-NOV-25 06.44.47.837080000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','ORDERS','AUD_ORDERS_UPDATE','d2d458e2-e915-4fd6-8ec1-58e53313f1e6','UPDATE operation on ORDERS - Changed: STATUS','UPDATE','STATUS');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (370,to_timestamp('23-NOV-25 06.44.47.874140000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','INVOICE','AUD_INVOICE_INSERT','d2d458e2-e915-4fd6-8ec1-58e53313f1e6','INSERT operation on INVOICE','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (371,to_timestamp('23-NOV-25 06.44.47.924508000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','INVOICE_ITEM','AUD_INVOICE_ITEM_INSERT','d2d458e2-e915-4fd6-8ec1-58e53313f1e6','INSERT operation on INVOICE_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (372,to_timestamp('23-NOV-25 06.44.47.925529000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','INVOICE_ITEM','AUD_INVOICE_ITEM_INSERT','d2d458e2-e915-4fd6-8ec1-58e53313f1e6','INSERT operation on INVOICE_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (373,to_timestamp('23-NOV-25 06.45.07.608199000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_OUT','AUD_STOCK_OUT_UPDATE','d2d458e2-e915-4fd6-8ec1-58e53313f1e6','UPDATE operation on STOCK_OUT - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (374,to_timestamp('23-NOV-25 06.45.08.243409000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','INVOICE','AUD_INVOICE_UPDATE','d2d458e2-e915-4fd6-8ec1-58e53313f1e6','UPDATE operation on INVOICE - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (375,to_timestamp('23-NOV-25 06.53.48.840015000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','EMPLOYEE','AUD_EMPLOYEE_INSERT','b08c43fe-5ec7-42c5-b18e-f63c0b62844b','INSERT operation on EMPLOYEE','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (376,to_timestamp('23-NOV-25 06.59.40.048605000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','EMPLOYEE','AUD_EMPLOYEE_INSERT','36e7e4e9-0c05-4705-81cf-02ff339b7f9d','INSERT operation on EMPLOYEE','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (323,to_timestamp('23-NOV-25 03.51.16.547759000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN','AUD_STOCK_IN_INSERT','238d0291-f7a6-4e82-830e-b096a0b3ac1c','INSERT operation on STOCK_IN','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (324,to_timestamp('23-NOV-25 03.51.16.554948000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN_ITEM','AUD_STOCK_IN_ITEM_INSERT','238d0291-f7a6-4e82-830e-b096a0b3ac1c','INSERT operation on STOCK_IN_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (325,to_timestamp('23-NOV-25 03.51.16.561754000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART','AUD_PART_INSERT','238d0291-f7a6-4e82-830e-b096a0b3ac1c','INSERT operation on PART','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (326,to_timestamp('23-NOV-25 03.51.38.860919000 PM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','STOCK_IN','AUD_STOCK_IN_UPDATE','238d0291-f7a6-4e82-830e-b096a0b3ac1c','UPDATE operation on STOCK_IN - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (377,to_timestamp('23-NOV-25 07.24.56.619159000 PM','DD-MON-RR HH.MI.SSXFF AM'),'1','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_KHACHHANG',null,'1','1','CUSTOMER','AUD_CUSTOMER_UPDATE','ed0aaec8-210e-4a6b-8f27-bf1de34bcd96','UPDATE operation on CUSTOMER - Changed: ','UPDATE',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (407,to_timestamp('24-NOV-25 10.29.03.571389000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','ORDERS','AUD_ORDERS_INSERT','7ae26413-2d41-465b-9800-4b0694916e5e','INSERT operation on ORDERS','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (408,to_timestamp('24-NOV-25 10.29.13.698841000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART_REQUEST','AUD_PART_REQUEST_INSERT','7ae26413-2d41-465b-9800-4b0694916e5e','INSERT operation on PART_REQUEST','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (409,to_timestamp('24-NOV-25 10.29.13.716225000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART_REQUEST_ITEM','AUD_PART_REQUEST_ITEM_INSERT','7ae26413-2d41-465b-9800-4b0694916e5e','INSERT operation on PART_REQUEST_ITEM','INSERT',null);
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (410,to_timestamp('24-NOV-25 10.29.13.724510000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART','AUD_PART_UPDATE','7ae26413-2d41-465b-9800-4b0694916e5e','UPDATE operation on PART - Changed: STATUS','UPDATE','STATUS');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (411,to_timestamp('24-NOV-25 10.29.16.574517000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART_REQUEST','AUD_PART_REQUEST_UPDATE','7ae26413-2d41-465b-9800-4b0694916e5e','UPDATE operation on PART_REQUEST - Changed: STATUS','UPDATE','STATUS');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (412,to_timestamp('24-NOV-25 10.29.16.583134000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART','AUD_PART_UPDATE','7ae26413-2d41-465b-9800-4b0694916e5e','UPDATE operation on PART - Changed: STATUS,ORDER_ID','UPDATE','STATUS,ORDER_ID');
Insert into APP.AUDIT_ALERT_LOG (LOG_ID,EVENT_TS,DB_USER,OS_USER,MACHINE,MODULE,APP_ROLE,EMP_ID,CUSTOMER_PHONE,OBJECT_SCHEMA,OBJECT_NAME,POLICY_NAME,CLIENT_IDENTIFIER,NOTE,DML_TYPE,CHANGED_COLUMNS) values (413,to_timestamp('24-NOV-25 10.30.51.922418000 AM','DD-MON-RR HH.MI.SSXFF AM'),'ADMIN','ntdmi','DESKTOP-RE4E4P9\DESKTOP-RE4E4P9','WebAPI-WEB','ROLE_ADMIN','1',null,'ADMIN','PART','AUD_PART_UPDATE','7ae26413-2d41-465b-9800-4b0694916e5e','UPDATE operation on PART - Changed: STATUS,ORDER_ID','UPDATE','STATUS,ORDER_ID');
REM INSERTING into APP.CREATE$JAVA$LOB$TABLE
SET DEFINE OFF;
REM INSERTING into APP.CUSTOMER
SET DEFINE OFF;
Insert into APP.CUSTOMER (PHONE,FULL_NAME,PASSWORD_HASH,CREATED_AT,EMAIL,ADDRESS) values ('1','Dinh','81B6D7839B1B7F999CC846F8A37771B230D82F1C1C391CB0F490F4DE55704A1E',to_timestamp('10-NOV-25 02.40.30.356827000 AM','DD-MON-RR HH.MI.SSXFF AM'),'Dinh@gmail.com','123a');
Insert into APP.CUSTOMER (PHONE,FULL_NAME,PASSWORD_HASH,CREATED_AT,EMAIL,ADDRESS) values ('2','2','1C4897232569B83EE438C4C7B81D7401D778AD2C5566E94BEA47A01364A87734',to_timestamp('14-NOV-25 09.14.16.777414000 AM','DD-MON-RR HH.MI.SSXFF AM'),'2@gmail.com','2');
Insert into APP.CUSTOMER (PHONE,FULL_NAME,PASSWORD_HASH,CREATED_AT,EMAIL,ADDRESS) values ('0332880207','Khách hàng 1','81B6D7839B1B7F999CC846F8A37771B230D82F1C1C391CB0F490F4DE55704A1E',to_timestamp('05-NOV-25 02.54.40.167598000 AM','DD-MON-RR HH.MI.SSXFF AM'),'vinhdtq123123123@gmail.com','Khách hàng 1');
REM INSERTING into APP.CUSTOMER_APPOINTMENT
SET DEFINE OFF;
REM INSERTING into APP.EMPLOYEE
SET DEFINE OFF;
REM INSERTING into APP.EMPLOYEE_SHIFT
SET DEFINE OFF;
REM INSERTING into APP.INVOICE
SET DEFINE OFF;
Insert into APP.INVOICE (INVOICE_ID,STOCKOUT_ID,CUSTOMER_PHONE,EMP_ID,INVOICE_DATE,TOTAL_AMOUNT,STATUS) values (4,26,'0332880207',1,to_date('15-NOV-25','DD-MON-RR'),0,'PENDING');
Insert into APP.INVOICE (INVOICE_ID,STOCKOUT_ID,CUSTOMER_PHONE,EMP_ID,INVOICE_DATE,TOTAL_AMOUNT,STATUS) values (5,27,'0332880207',1,to_date('17-NOV-25','DD-MON-RR'),0,'PENDING');
Insert into APP.INVOICE (INVOICE_ID,STOCKOUT_ID,CUSTOMER_PHONE,EMP_ID,INVOICE_DATE,TOTAL_AMOUNT,STATUS) values (7,29,'1',1,to_date('23-NOV-25','DD-MON-RR'),0,'PENDING');
Insert into APP.INVOICE (INVOICE_ID,STOCKOUT_ID,CUSTOMER_PHONE,EMP_ID,INVOICE_DATE,TOTAL_AMOUNT,STATUS) values (8,30,'0332880207',1,to_date('23-NOV-25','DD-MON-RR'),0,'PENDING');
Insert into APP.INVOICE (INVOICE_ID,STOCKOUT_ID,CUSTOMER_PHONE,EMP_ID,INVOICE_DATE,TOTAL_AMOUNT,STATUS) values (6,28,'1',1,to_date('18-NOV-25','DD-MON-RR'),0,'PENDING');
Insert into APP.INVOICE (INVOICE_ID,STOCKOUT_ID,CUSTOMER_PHONE,EMP_ID,INVOICE_DATE,TOTAL_AMOUNT,STATUS) values (1,16,'1',1,to_date('14-NOV-25','DD-MON-RR'),0,'PENDING');
Insert into APP.INVOICE (INVOICE_ID,STOCKOUT_ID,CUSTOMER_PHONE,EMP_ID,INVOICE_DATE,TOTAL_AMOUNT,STATUS) values (3,18,'0332880207',1,to_date('14-NOV-25','DD-MON-RR'),0,'PENDING');
REM INSERTING into APP.INVOICE_ITEM
SET DEFINE OFF;
Insert into APP.INVOICE_ITEM (INVOICE_ID,STOCKOUT_ID,PART_ID,PRICE) values (4,26,538,1000);
Insert into APP.INVOICE_ITEM (INVOICE_ID,STOCKOUT_ID,PART_ID,PRICE) values (5,27,536,1000);
Insert into APP.INVOICE_ITEM (INVOICE_ID,STOCKOUT_ID,PART_ID,PRICE) values (7,29,542,1000);
Insert into APP.INVOICE_ITEM (INVOICE_ID,STOCKOUT_ID,PART_ID,PRICE) values (8,30,531,1000);
Insert into APP.INVOICE_ITEM (INVOICE_ID,STOCKOUT_ID,PART_ID,PRICE) values (8,30,532,1000);
Insert into APP.INVOICE_ITEM (INVOICE_ID,STOCKOUT_ID,PART_ID,PRICE) values (6,28,539,1000);
Insert into APP.INVOICE_ITEM (INVOICE_ID,STOCKOUT_ID,PART_ID,PRICE) values (1,16,530,0);
Insert into APP.INVOICE_ITEM (INVOICE_ID,STOCKOUT_ID,PART_ID,PRICE) values (3,18,537,1000);
REM INSERTING into APP.INVOICE_SERVICE
SET DEFINE OFF;
Insert into APP.INVOICE_SERVICE (INVOICE_ID,SERVICE_ID,QUANTITY,PRICE) values (4,3,1,0);
Insert into APP.INVOICE_SERVICE (INVOICE_ID,SERVICE_ID,QUANTITY,PRICE) values (5,3,1,0);
Insert into APP.INVOICE_SERVICE (INVOICE_ID,SERVICE_ID,QUANTITY,PRICE) values (7,3,1,0);
Insert into APP.INVOICE_SERVICE (INVOICE_ID,SERVICE_ID,QUANTITY,PRICE) values (8,3,1,0);
Insert into APP.INVOICE_SERVICE (INVOICE_ID,SERVICE_ID,QUANTITY,PRICE) values (6,3,1,0);
Insert into APP.INVOICE_SERVICE (INVOICE_ID,SERVICE_ID,QUANTITY,PRICE) values (1,3,1,0);
Insert into APP.INVOICE_SERVICE (INVOICE_ID,SERVICE_ID,QUANTITY,PRICE) values (3,3,1,0);
REM INSERTING into APP.ORDERS
SET DEFINE OFF;
REM INSERTING into APP.ORDER_SERVICE
SET DEFINE OFF;
Insert into APP.ORDER_SERVICE (ORDER_ID,SERVICE_ID,QUANTITY,PRICE) values (121,3,1,0);
Insert into APP.ORDER_SERVICE (ORDER_ID,SERVICE_ID,QUANTITY,PRICE) values (161,3,1,0);
Insert into APP.ORDER_SERVICE (ORDER_ID,SERVICE_ID,QUANTITY,PRICE) values (201,3,1,0);
Insert into APP.ORDER_SERVICE (ORDER_ID,SERVICE_ID,QUANTITY,PRICE) values (122,1,1,100000);
Insert into APP.ORDER_SERVICE (ORDER_ID,SERVICE_ID,QUANTITY,PRICE) values (123,3,1,0);
Insert into APP.ORDER_SERVICE (ORDER_ID,SERVICE_ID,QUANTITY,PRICE) values (124,3,1,0);
Insert into APP.ORDER_SERVICE (ORDER_ID,SERVICE_ID,QUANTITY,PRICE) values (125,3,1,0);
Insert into APP.ORDER_SERVICE (ORDER_ID,SERVICE_ID,QUANTITY,PRICE) values (181,3,1,0);
Insert into APP.ORDER_SERVICE (ORDER_ID,SERVICE_ID,QUANTITY,PRICE) values (202,3,1,0);
Insert into APP.ORDER_SERVICE (ORDER_ID,SERVICE_ID,QUANTITY,PRICE) values (222,1,1,100000);
Insert into APP.ORDER_SERVICE (ORDER_ID,SERVICE_ID,QUANTITY,PRICE) values (141,3,1,0);
Insert into APP.ORDER_SERVICE (ORDER_ID,SERVICE_ID,QUANTITY,PRICE) values (142,1,1,100000);
Insert into APP.ORDER_SERVICE (ORDER_ID,SERVICE_ID,QUANTITY,PRICE) values (143,3,1,0);
Insert into APP.ORDER_SERVICE (ORDER_ID,SERVICE_ID,QUANTITY,PRICE) values (144,3,1,0);
Insert into APP.ORDER_SERVICE (ORDER_ID,SERVICE_ID,QUANTITY,PRICE) values (85,3,1,0);
Insert into APP.ORDER_SERVICE (ORDER_ID,SERVICE_ID,QUANTITY,PRICE) values (101,3,1,0);
REM INSERTING into APP.PART
SET DEFINE OFF;
REM INSERTING into APP.PART_REQUEST
SET DEFINE OFF;
REM INSERTING into APP.PART_REQUEST_ITEM
SET DEFINE OFF;
REM INSERTING into APP.SERVICE
SET DEFINE OFF;
Insert into APP.SERVICE (SERVICE_ID,NAME,DESCRIPTION,PRICE) values (1,'Dịch vụ Vệ sinh thiết bị','Vệ sinh toàn diện bên trong và ngoài thiết bị, tối ưu hóa phần mềm cơ bản.',100000);
Insert into APP.SERVICE (SERVICE_ID,NAME,DESCRIPTION,PRICE) values (2,'Dịch vụ Sửa chữa tổng quát','Phí công thợ sửa chữa cho các lỗi phần cứng và phần mềm, chưa bao gồm linh kiện thay thế.',350000);
Insert into APP.SERVICE (SERVICE_ID,NAME,DESCRIPTION,PRICE) values (3,'Dịch vụ Bảo hành','Dịch vụ Bảo hành',0);
REM INSERTING into APP.STOCK_IN
SET DEFINE OFF;
REM INSERTING into APP.STOCK_IN_ITEM
SET DEFINE OFF;
REM INSERTING into APP.STOCK_OUT
SET DEFINE OFF;
REM INSERTING into APP.STOCK_OUT_ITEM
SET DEFINE OFF;
REM INSERTING into APP.USER_OTP_LOG
SET DEFINE OFF;
Insert into APP.USER_OTP_LOG (ID,USER_ID,USERNAME,OTP,CREATED_AT,EXPIRED_AT,USED) values (4,0,'0332880207','169028',to_timestamp('24-NOV-25 06.00.29.299481000 PM','DD-MON-RR HH.MI.SSXFF AM'),to_timestamp('24-NOV-25 06.10.29.299367000 PM','DD-MON-RR HH.MI.SSXFF AM'),'N');
Insert into APP.USER_OTP_LOG (ID,USER_ID,USERNAME,OTP,CREATED_AT,EXPIRED_AT,USED) values (7,0,'0332880207','225970',to_timestamp('24-NOV-25 06.05.00.275791000 PM','DD-MON-RR HH.MI.SSXFF AM'),to_timestamp('24-NOV-25 06.15.00.275594000 PM','DD-MON-RR HH.MI.SSXFF AM'),'Y');
Insert into APP.USER_OTP_LOG (ID,USER_ID,USERNAME,OTP,CREATED_AT,EXPIRED_AT,USED) values (1,0,'0332880207','999853',to_timestamp('24-NOV-25 05.28.33.260480000 PM','DD-MON-RR HH.MI.SSXFF AM'),to_timestamp('24-NOV-25 05.38.33.194082000 PM','DD-MON-RR HH.MI.SSXFF AM'),'N');
Insert into APP.USER_OTP_LOG (ID,USER_ID,USERNAME,OTP,CREATED_AT,EXPIRED_AT,USED) values (2,0,'0332880207','182640',to_timestamp('24-NOV-25 05.33.06.941205000 PM','DD-MON-RR HH.MI.SSXFF AM'),to_timestamp('24-NOV-25 05.43.06.941104000 PM','DD-MON-RR HH.MI.SSXFF AM'),'Y');
Insert into APP.USER_OTP_LOG (ID,USER_ID,USERNAME,OTP,CREATED_AT,EXPIRED_AT,USED) values (3,0,'0332880207','437665',to_timestamp('24-NOV-25 06.00.24.479626000 PM','DD-MON-RR HH.MI.SSXFF AM'),to_timestamp('24-NOV-25 06.10.24.479539000 PM','DD-MON-RR HH.MI.SSXFF AM'),'N');
Insert into APP.USER_OTP_LOG (ID,USER_ID,USERNAME,OTP,CREATED_AT,EXPIRED_AT,USED) values (5,0,'0332880207','559768',to_timestamp('24-NOV-25 06.00.35.066214000 PM','DD-MON-RR HH.MI.SSXFF AM'),to_timestamp('24-NOV-25 06.10.35.066062000 PM','DD-MON-RR HH.MI.SSXFF AM'),'Y');
Insert into APP.USER_OTP_LOG (ID,USER_ID,USERNAME,OTP,CREATED_AT,EXPIRED_AT,USED) values (6,0,'0332880207','702343',to_timestamp('24-NOV-25 06.00.47.629998000 PM','DD-MON-RR HH.MI.SSXFF AM'),to_timestamp('24-NOV-25 06.10.47.629820000 PM','DD-MON-RR HH.MI.SSXFF AM'),'N');
--------------------------------------------------------
--  DDL for Index PK_INVOICEITEM
--------------------------------------------------------

  CREATE UNIQUE INDEX "APP"."PK_INVOICEITEM" ON "APP"."INVOICE_ITEM" ("INVOICE_ID", "STOCKOUT_ID", "PART_ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Index UK_INVOICEITEM_STOCKOUT_PART
--------------------------------------------------------

  CREATE UNIQUE INDEX "APP"."UK_INVOICEITEM_STOCKOUT_PART" ON "APP"."INVOICE_ITEM" ("STOCKOUT_ID", "PART_ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Index PK_PARTREQUESTITEM
--------------------------------------------------------

  CREATE UNIQUE INDEX "APP"."PK_PARTREQUESTITEM" ON "APP"."PART_REQUEST_ITEM" ("REQUEST_ID", "PART_ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Index PK_INVOICESERVICE
--------------------------------------------------------

  CREATE UNIQUE INDEX "APP"."PK_INVOICESERVICE" ON "APP"."INVOICE_SERVICE" ("INVOICE_ID", "SERVICE_ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Index PK_STOCKOUTITEM
--------------------------------------------------------

  CREATE UNIQUE INDEX "APP"."PK_STOCKOUTITEM" ON "APP"."STOCK_OUT_ITEM" ("STOCKOUT_ID", "PART_ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Index PK_ORDERSERVICE
--------------------------------------------------------

  CREATE UNIQUE INDEX "APP"."PK_ORDERSERVICE" ON "APP"."ORDER_SERVICE" ("ORDER_ID", "SERVICE_ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Trigger TRG_AUDIT_CUSTOMER
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "APP"."TRG_AUDIT_CUSTOMER" 
  AFTER INSERT OR UPDATE OR DELETE ON CUSTOMER
  FOR EACH ROW
DECLARE
  v_old_values CLOB;
  v_new_values CLOB;
  v_changed_cols VARCHAR2(4000);
BEGIN
  -- Build old values (for UPDATE/DELETE)
  IF UPDATING OR DELETING THEN
    v_old_values := '{' ||
      '"PHONE":"' || REPLACE(NVL(:OLD.PHONE, ''), '"', '\"') || '",' ||
      '"FULL_NAME":"' || REPLACE(NVL(:OLD.FULL_NAME, ''), '"', '\"') || '",' ||
      '"EMAIL":"' || REPLACE(NVL(:OLD.EMAIL, ''), '"', '\"') || '",' ||
      '"ADDRESS":"' || REPLACE(NVL(:OLD.ADDRESS, ''), '"', '\"') || '",' ||
      '"CREATED_AT":"' || TO_CHAR(:OLD.CREATED_AT, 'YYYY-MM-DD HH24:MI:SS') || '"' ||
      '}';
  END IF;

  -- Build new values (for INSERT/UPDATE)
  IF INSERTING OR UPDATING THEN
    v_new_values := '{' ||
      '"PHONE":"' || REPLACE(NVL(:NEW.PHONE, ''), '"', '\"') || '",' ||
      '"FULL_NAME":"' || REPLACE(NVL(:NEW.FULL_NAME, ''), '"', '\"') || '",' ||
      '"EMAIL":"' || REPLACE(NVL(:NEW.EMAIL, ''), '"', '\"') || '",' ||
      '"ADDRESS":"' || REPLACE(NVL(:NEW.ADDRESS, ''), '"', '\"') || '",' ||
      '"CREATED_AT":"' || TO_CHAR(:NEW.CREATED_AT, 'YYYY-MM-DD HH24:MI:SS') || '"' ||
      '}';
  END IF;

  -- Track changed columns for UPDATE
  IF UPDATING THEN
    v_changed_cols := '';
    IF (:OLD.FULL_NAME IS NULL AND :NEW.FULL_NAME IS NOT NULL) OR 
       (:OLD.FULL_NAME IS NOT NULL AND :NEW.FULL_NAME IS NULL) OR
       (:OLD.FULL_NAME != :NEW.FULL_NAME) THEN
      v_changed_cols := v_changed_cols || 'FULL_NAME,';
    END IF;
    IF (:OLD.EMAIL IS NULL AND :NEW.EMAIL IS NOT NULL) OR 
       (:OLD.EMAIL IS NOT NULL AND :NEW.EMAIL IS NULL) OR
       (:OLD.EMAIL != :NEW.EMAIL) THEN
      v_changed_cols := v_changed_cols || 'EMAIL,';
    END IF;
    IF (:OLD.ADDRESS IS NULL AND :NEW.ADDRESS IS NOT NULL) OR 
       (:OLD.ADDRESS IS NOT NULL AND :NEW.ADDRESS IS NULL) OR
       (:OLD.ADDRESS != :NEW.ADDRESS) THEN
      v_changed_cols := v_changed_cols || 'ADDRESS,';
    END IF;
    IF LENGTH(v_changed_cols) > 0 THEN
      v_changed_cols := SUBSTR(v_changed_cols, 1, LENGTH(v_changed_cols) - 1);
    END IF;
  END IF;

  -- Log the operation
  IF INSERTING THEN
    audit_dml_pkg.log_insert('CUSTOMER', v_new_values);
  ELSIF UPDATING THEN
    audit_dml_pkg.log_update('CUSTOMER', v_old_values, v_new_values, v_changed_cols);
  ELSIF DELETING THEN
    audit_dml_pkg.log_delete('CUSTOMER', v_old_values);
  END IF;
END;

/
ALTER TRIGGER "APP"."TRG_AUDIT_CUSTOMER" ENABLE;
--------------------------------------------------------
--  DDL for Trigger TRG_AUDIT_CUSTOMER_APPOINTMENT
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "APP"."TRG_AUDIT_CUSTOMER_APPOINTMENT" 
  AFTER INSERT OR UPDATE OR DELETE ON CUSTOMER_APPOINTMENT
  FOR EACH ROW
DECLARE
  v_old_values CLOB;
  v_new_values CLOB;
  v_changed_cols VARCHAR2(4000);
BEGIN
  -- Build old values (for UPDATE/DELETE)
  IF UPDATING OR DELETING THEN
    v_old_values := '{' ||
      '"APPOINTMENT_ID":' || NVL(TO_CHAR(:OLD.APPOINTMENT_ID), 'null') || ',' ||
      '"CUSTOMER_PHONE":"' || REPLACE(NVL(:OLD.CUSTOMER_PHONE, ''), '"', '\"') || '",' ||
      '"APPOINTMENT_DATE":"' || TO_CHAR(:OLD.APPOINTMENT_DATE, 'YYYY-MM-DD') || '",' ||
      '"STATUS":"' || REPLACE(NVL(:OLD.STATUS, ''), '"', '\"') || '",' ||
      '"DESCRIPTION":"' || REPLACE(NVL(:OLD.DESCRIPTION, ''), '"', '\"') || '"' ||
      '}';
  END IF;

  -- Build new values (for INSERT/UPDATE)
  IF INSERTING OR UPDATING THEN
    v_new_values := '{' ||
      '"APPOINTMENT_ID":' || NVL(TO_CHAR(:NEW.APPOINTMENT_ID), 'null') || ',' ||
      '"CUSTOMER_PHONE":"' || REPLACE(NVL(:NEW.CUSTOMER_PHONE, ''), '"', '\"') || '",' ||
      '"APPOINTMENT_DATE":"' || TO_CHAR(:NEW.APPOINTMENT_DATE, 'YYYY-MM-DD') || '",' ||
      '"STATUS":"' || REPLACE(NVL(:NEW.STATUS, ''), '"', '\"') || '",' ||
      '"DESCRIPTION":"' || REPLACE(NVL(:NEW.DESCRIPTION, ''), '"', '\"') || '"' ||
      '}';
  END IF;

  -- Track changed columns for UPDATE
  IF UPDATING THEN
    v_changed_cols := '';
    IF ((:OLD.CUSTOMER_PHONE IS NULL AND :NEW.CUSTOMER_PHONE IS NOT NULL) OR 
        (:OLD.CUSTOMER_PHONE IS NOT NULL AND :NEW.CUSTOMER_PHONE IS NULL) OR
        (:OLD.CUSTOMER_PHONE != :NEW.CUSTOMER_PHONE)) THEN 
      v_changed_cols := v_changed_cols || 'CUSTOMER_PHONE,'; 
    END IF;
    IF (:OLD.APPOINTMENT_DATE != :NEW.APPOINTMENT_DATE) THEN v_changed_cols := v_changed_cols || 'APPOINTMENT_DATE,'; END IF;
    IF ((:OLD.STATUS IS NULL AND :NEW.STATUS IS NOT NULL) OR 
        (:OLD.STATUS IS NOT NULL AND :NEW.STATUS IS NULL) OR
        (:OLD.STATUS != :NEW.STATUS)) THEN 
      v_changed_cols := v_changed_cols || 'STATUS,'; 
    END IF;
    IF ((:OLD.DESCRIPTION IS NULL AND :NEW.DESCRIPTION IS NOT NULL) OR 
        (:OLD.DESCRIPTION IS NOT NULL AND :NEW.DESCRIPTION IS NULL) OR
        (:OLD.DESCRIPTION != :NEW.DESCRIPTION)) THEN 
      v_changed_cols := v_changed_cols || 'DESCRIPTION,'; 
    END IF;
    IF LENGTH(v_changed_cols) > 0 THEN
      v_changed_cols := SUBSTR(v_changed_cols, 1, LENGTH(v_changed_cols) - 1);
    END IF;
  END IF;

  -- Log the operation
  IF INSERTING THEN
    audit_dml_pkg.log_insert('CUSTOMER_APPOINTMENT', v_new_values);
  ELSIF UPDATING THEN
    audit_dml_pkg.log_update('CUSTOMER_APPOINTMENT', v_old_values, v_new_values, v_changed_cols);
  ELSIF DELETING THEN
    audit_dml_pkg.log_delete('CUSTOMER_APPOINTMENT', v_old_values);
  END IF;
END;

/
ALTER TRIGGER "APP"."TRG_AUDIT_CUSTOMER_APPOINTMENT" ENABLE;
--------------------------------------------------------
--  DDL for Trigger TRG_AUDIT_EMPLOYEE
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "APP"."TRG_AUDIT_EMPLOYEE" 
  AFTER INSERT OR UPDATE OR DELETE ON EMPLOYEE
  FOR EACH ROW
DECLARE
  v_old_values CLOB;
  v_new_values CLOB;
  v_changed_cols VARCHAR2(4000);
BEGIN
  -- Build old values (for UPDATE/DELETE)
  IF UPDATING OR DELETING THEN
    v_old_values := '{' ||
      '"EMP_ID":' || NVL(TO_CHAR(:OLD.EMP_ID), 'null') || ',' ||
      '"FULL_NAME":"' || REPLACE(NVL(:OLD.FULL_NAME, ''), '"', '\"') || '",' ||
      '"USERNAME":"' || REPLACE(NVL(:OLD.USERNAME, ''), '"', '\"') || '",' ||
      '"EMAIL":"' || REPLACE(NVL(:OLD.EMAIL, ''), '"', '\"') || '",' ||
      '"PHONE":"' || REPLACE(NVL(:OLD.PHONE, ''), '"', '\"') || '",' ||
      '"CREATED_AT":"' || TO_CHAR(:OLD.CREATED_AT, 'YYYY-MM-DD HH24:MI:SS') || '"' ||
      '}';
  END IF;

  -- Build new values (for INSERT/UPDATE)
  IF INSERTING OR UPDATING THEN
    v_new_values := '{' ||
      '"EMP_ID":' || NVL(TO_CHAR(:NEW.EMP_ID), 'null') || ',' ||
      '"FULL_NAME":"' || REPLACE(NVL(:NEW.FULL_NAME, ''), '"', '\"') || '",' ||
      '"USERNAME":"' || REPLACE(NVL(:NEW.USERNAME, ''), '"', '\"') || '",' ||
      '"EMAIL":"' || REPLACE(NVL(:NEW.EMAIL, ''), '"', '\"') || '",' ||
      '"PHONE":"' || REPLACE(NVL(:NEW.PHONE, ''), '"', '\"') || '",' ||
      '"CREATED_AT":"' || TO_CHAR(:NEW.CREATED_AT, 'YYYY-MM-DD HH24:MI:SS') || '"' ||
      '}';
  END IF;

  -- Track changed columns for UPDATE
  IF UPDATING THEN
    v_changed_cols := '';
    IF (:OLD.FULL_NAME IS NULL AND :NEW.FULL_NAME IS NOT NULL) OR 
       (:OLD.FULL_NAME IS NOT NULL AND :NEW.FULL_NAME IS NULL) OR
       (:OLD.FULL_NAME != :NEW.FULL_NAME) THEN
      v_changed_cols := v_changed_cols || 'FULL_NAME,';
    END IF;
    IF (:OLD.USERNAME IS NULL AND :NEW.USERNAME IS NOT NULL) OR 
       (:OLD.USERNAME IS NOT NULL AND :NEW.USERNAME IS NULL) OR
       (:OLD.USERNAME != :NEW.USERNAME) THEN
      v_changed_cols := v_changed_cols || 'USERNAME,';
    END IF;
    IF (:OLD.EMAIL IS NULL AND :NEW.EMAIL IS NOT NULL) OR 
       (:OLD.EMAIL IS NOT NULL AND :NEW.EMAIL IS NULL) OR
       (:OLD.EMAIL != :NEW.EMAIL) THEN
      v_changed_cols := v_changed_cols || 'EMAIL,';
    END IF;
    IF (:OLD.PHONE IS NULL AND :NEW.PHONE IS NOT NULL) OR 
       (:OLD.PHONE IS NOT NULL AND :NEW.PHONE IS NULL) OR
       (:OLD.PHONE != :NEW.PHONE) THEN
      v_changed_cols := v_changed_cols || 'PHONE,';
    END IF;
    -- Remove trailing comma
    IF LENGTH(v_changed_cols) > 0 THEN
      v_changed_cols := SUBSTR(v_changed_cols, 1, LENGTH(v_changed_cols) - 1);
    END IF;
  END IF;

  -- Log the operation
  IF INSERTING THEN
    audit_dml_pkg.log_insert('EMPLOYEE', v_new_values);
  ELSIF UPDATING THEN
    audit_dml_pkg.log_update('EMPLOYEE', v_old_values, v_new_values, v_changed_cols);
  ELSIF DELETING THEN
    audit_dml_pkg.log_delete('EMPLOYEE', v_old_values);
  END IF;
END;

/
ALTER TRIGGER "APP"."TRG_AUDIT_EMPLOYEE" ENABLE;
--------------------------------------------------------
--  DDL for Trigger TRG_AUDIT_INVOICE
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "APP"."TRG_AUDIT_INVOICE" 
  AFTER INSERT OR UPDATE OR DELETE ON INVOICE
  FOR EACH ROW
DECLARE
  v_old_values CLOB;
  v_new_values CLOB;
  v_changed_cols VARCHAR2(4000);
BEGIN
  -- Build old values (for UPDATE/DELETE)
  IF UPDATING OR DELETING THEN
    v_old_values := '{' ||
      '"INVOICE_ID":' || NVL(TO_CHAR(:OLD.INVOICE_ID), 'null') || ',' ||
      '"STOCKOUT_ID":' || NVL(TO_CHAR(:OLD.STOCKOUT_ID), 'null') || ',' ||
      '"CUSTOMER_PHONE":"' || REPLACE(NVL(:OLD.CUSTOMER_PHONE, ''), '"', '\"') || '",' ||
      '"EMP_ID":' || NVL(TO_CHAR(:OLD.EMP_ID), 'null') || ',' ||
      '"INVOICE_DATE":"' || TO_CHAR(:OLD.INVOICE_DATE, 'YYYY-MM-DD') || '",' ||
      '"TOTAL_AMOUNT":' || NVL(TO_CHAR(:OLD.TOTAL_AMOUNT), 'null') || ',' ||
      '"STATUS":"' || REPLACE(NVL(:OLD.STATUS, ''), '"', '\"') || '"' ||
      '}';
  END IF;

  -- Build new values (for INSERT/UPDATE)
  IF INSERTING OR UPDATING THEN
    v_new_values := '{' ||
      '"INVOICE_ID":' || NVL(TO_CHAR(:NEW.INVOICE_ID), 'null') || ',' ||
      '"STOCKOUT_ID":' || NVL(TO_CHAR(:NEW.STOCKOUT_ID), 'null') || ',' ||
      '"CUSTOMER_PHONE":"' || REPLACE(NVL(:NEW.CUSTOMER_PHONE, ''), '"', '\"') || '",' ||
      '"EMP_ID":' || NVL(TO_CHAR(:NEW.EMP_ID), 'null') || ',' ||
      '"INVOICE_DATE":"' || TO_CHAR(:NEW.INVOICE_DATE, 'YYYY-MM-DD') || '",' ||
      '"TOTAL_AMOUNT":' || NVL(TO_CHAR(:NEW.TOTAL_AMOUNT), 'null') || ',' ||
      '"STATUS":"' || REPLACE(NVL(:NEW.STATUS, ''), '"', '\"') || '"' ||
      '}';
  END IF;

  -- Track changed columns for UPDATE
  IF UPDATING THEN
    v_changed_cols := '';
    IF (:OLD.STOCKOUT_ID != :NEW.STOCKOUT_ID) THEN v_changed_cols := v_changed_cols || 'STOCKOUT_ID,'; END IF;
    IF ((:OLD.CUSTOMER_PHONE IS NULL AND :NEW.CUSTOMER_PHONE IS NOT NULL) OR 
        (:OLD.CUSTOMER_PHONE IS NOT NULL AND :NEW.CUSTOMER_PHONE IS NULL) OR
        (:OLD.CUSTOMER_PHONE != :NEW.CUSTOMER_PHONE)) THEN 
      v_changed_cols := v_changed_cols || 'CUSTOMER_PHONE,'; 
    END IF;
    IF (:OLD.EMP_ID != :NEW.EMP_ID) THEN v_changed_cols := v_changed_cols || 'EMP_ID,'; END IF;
    IF (:OLD.INVOICE_DATE != :NEW.INVOICE_DATE) THEN v_changed_cols := v_changed_cols || 'INVOICE_DATE,'; END IF;
    IF (:OLD.TOTAL_AMOUNT IS NULL AND :NEW.TOTAL_AMOUNT IS NOT NULL) OR 
       (:OLD.TOTAL_AMOUNT IS NOT NULL AND :NEW.TOTAL_AMOUNT IS NULL) OR
       (:OLD.TOTAL_AMOUNT != :NEW.TOTAL_AMOUNT) THEN
      v_changed_cols := v_changed_cols || 'TOTAL_AMOUNT,';
    END IF;
    IF ((:OLD.STATUS IS NULL AND :NEW.STATUS IS NOT NULL) OR 
        (:OLD.STATUS IS NOT NULL AND :NEW.STATUS IS NULL) OR
        (:OLD.STATUS != :NEW.STATUS)) THEN 
      v_changed_cols := v_changed_cols || 'STATUS,'; 
    END IF;
    IF LENGTH(v_changed_cols) > 0 THEN
      v_changed_cols := SUBSTR(v_changed_cols, 1, LENGTH(v_changed_cols) - 1);
    END IF;
  END IF;

  -- Log the operation
  IF INSERTING THEN
    audit_dml_pkg.log_insert('INVOICE', v_new_values);
  ELSIF UPDATING THEN
    audit_dml_pkg.log_update('INVOICE', v_old_values, v_new_values, v_changed_cols);
  ELSIF DELETING THEN
    audit_dml_pkg.log_delete('INVOICE', v_old_values);
  END IF;
END;

/
ALTER TRIGGER "APP"."TRG_AUDIT_INVOICE" ENABLE;
--------------------------------------------------------
--  DDL for Trigger TRG_AUDIT_INVOICE_ITEM
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "APP"."TRG_AUDIT_INVOICE_ITEM" 
  AFTER INSERT OR UPDATE OR DELETE ON INVOICE_ITEM
  FOR EACH ROW
DECLARE
  v_old_values CLOB;
  v_new_values CLOB;
  v_changed_cols VARCHAR2(4000);
BEGIN
  -- Build old values (for UPDATE/DELETE)
  IF UPDATING OR DELETING THEN
    v_old_values := '{' ||
      '"INVOICE_ID":' || NVL(TO_CHAR(:OLD.INVOICE_ID), 'null') || ',' ||
      '"STOCKOUT_ID":' || NVL(TO_CHAR(:OLD.STOCKOUT_ID), 'null') || ',' ||
      '"PART_ID":' || NVL(TO_CHAR(:OLD.PART_ID), 'null') || ',' ||
      '"PRICE":' || NVL(TO_CHAR(:OLD.PRICE), 'null') ||
      '}';
  END IF;

  -- Build new values (for INSERT/UPDATE)
  IF INSERTING OR UPDATING THEN
    v_new_values := '{' ||
      '"INVOICE_ID":' || NVL(TO_CHAR(:NEW.INVOICE_ID), 'null') || ',' ||
      '"STOCKOUT_ID":' || NVL(TO_CHAR(:NEW.STOCKOUT_ID), 'null') || ',' ||
      '"PART_ID":' || NVL(TO_CHAR(:NEW.PART_ID), 'null') || ',' ||
      '"PRICE":' || NVL(TO_CHAR(:NEW.PRICE), 'null') ||
      '}';
  END IF;

  -- Track changed columns for UPDATE
  IF UPDATING THEN
    v_changed_cols := '';
    IF (:OLD.INVOICE_ID != :NEW.INVOICE_ID) THEN v_changed_cols := v_changed_cols || 'INVOICE_ID,'; END IF;
    IF (:OLD.STOCKOUT_ID != :NEW.STOCKOUT_ID) THEN v_changed_cols := v_changed_cols || 'STOCKOUT_ID,'; END IF;
    IF (:OLD.PART_ID != :NEW.PART_ID) THEN v_changed_cols := v_changed_cols || 'PART_ID,'; END IF;
    IF (:OLD.PRICE IS NULL AND :NEW.PRICE IS NOT NULL) OR 
       (:OLD.PRICE IS NOT NULL AND :NEW.PRICE IS NULL) OR
       (:OLD.PRICE != :NEW.PRICE) THEN
      v_changed_cols := v_changed_cols || 'PRICE,';
    END IF;
    IF LENGTH(v_changed_cols) > 0 THEN
      v_changed_cols := SUBSTR(v_changed_cols, 1, LENGTH(v_changed_cols) - 1);
    END IF;
  END IF;

  -- Log the operation
  IF INSERTING THEN
    audit_dml_pkg.log_insert('INVOICE_ITEM', v_new_values);
  ELSIF UPDATING THEN
    audit_dml_pkg.log_update('INVOICE_ITEM', v_old_values, v_new_values, v_changed_cols);
  ELSIF DELETING THEN
    audit_dml_pkg.log_delete('INVOICE_ITEM', v_old_values);
  END IF;
END;

/
ALTER TRIGGER "APP"."TRG_AUDIT_INVOICE_ITEM" ENABLE;
--------------------------------------------------------
--  DDL for Trigger TRG_AUDIT_ORDERS
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "APP"."TRG_AUDIT_ORDERS" 
  AFTER INSERT OR UPDATE OR DELETE ON ORDERS
  FOR EACH ROW
DECLARE
  v_old_values CLOB;
  v_new_values CLOB;
  v_changed_cols VARCHAR2(4000);
BEGIN
  -- Build old values (for UPDATE/DELETE)
  IF UPDATING OR DELETING THEN
    v_old_values := '{' ||
      '"ORDER_ID":' || NVL(TO_CHAR(:OLD.ORDER_ID), 'null') || ',' ||
      '"CUSTOMER_PHONE":"' || REPLACE(NVL(:OLD.CUSTOMER_PHONE, ''), '"', '\"') || '",' ||
      '"RECEIVER_EMP":' || NVL(TO_CHAR(:OLD.RECEIVER_EMP), 'null') || ',' ||
      '"HANDLER_EMP":' || NVL(TO_CHAR(:OLD.HANDLER_EMP), 'null') || ',' ||
      '"ORDER_TYPE":"' || REPLACE(NVL(:OLD.ORDER_TYPE, ''), '"', '\"') || '",' ||
      '"RECEIVED_DATE":"' || TO_CHAR(:OLD.RECEIVED_DATE, 'YYYY-MM-DD') || '",' ||
      '"STATUS":"' || REPLACE(NVL(:OLD.STATUS, ''), '"', '\"') || '",' ||
      '"DESCRIPTION":"' || REPLACE(NVL(:OLD.DESCRIPTION, ''), '"', '\"') || '"' ||
      '}';
  END IF;

  -- Build new values (for INSERT/UPDATE)
  IF INSERTING OR UPDATING THEN
    v_new_values := '{' ||
      '"ORDER_ID":' || NVL(TO_CHAR(:NEW.ORDER_ID), 'null') || ',' ||
      '"CUSTOMER_PHONE":"' || REPLACE(NVL(:NEW.CUSTOMER_PHONE, ''), '"', '\"') || '",' ||
      '"RECEIVER_EMP":' || NVL(TO_CHAR(:NEW.RECEIVER_EMP), 'null') || ',' ||
      '"HANDLER_EMP":' || NVL(TO_CHAR(:NEW.HANDLER_EMP), 'null') || ',' ||
      '"ORDER_TYPE":"' || REPLACE(NVL(:NEW.ORDER_TYPE, ''), '"', '\"') || '",' ||
      '"RECEIVED_DATE":"' || TO_CHAR(:NEW.RECEIVED_DATE, 'YYYY-MM-DD') || '",' ||
      '"STATUS":"' || REPLACE(NVL(:NEW.STATUS, ''), '"', '\"') || '",' ||
      '"DESCRIPTION":"' || REPLACE(NVL(:NEW.DESCRIPTION, ''), '"', '\"') || '"' ||
      '}';
  END IF;

  -- Track changed columns for UPDATE
  IF UPDATING THEN
    v_changed_cols := '';
    IF ((:OLD.CUSTOMER_PHONE IS NULL AND :NEW.CUSTOMER_PHONE IS NOT NULL) OR 
        (:OLD.CUSTOMER_PHONE IS NOT NULL AND :NEW.CUSTOMER_PHONE IS NULL) OR
        (:OLD.CUSTOMER_PHONE != :NEW.CUSTOMER_PHONE)) THEN 
      v_changed_cols := v_changed_cols || 'CUSTOMER_PHONE,'; 
    END IF;
    IF (:OLD.RECEIVER_EMP != :NEW.RECEIVER_EMP) THEN v_changed_cols := v_changed_cols || 'RECEIVER_EMP,'; END IF;
    IF (:OLD.HANDLER_EMP != :NEW.HANDLER_EMP) THEN v_changed_cols := v_changed_cols || 'HANDLER_EMP,'; END IF;
    IF ((:OLD.ORDER_TYPE IS NULL AND :NEW.ORDER_TYPE IS NOT NULL) OR 
        (:OLD.ORDER_TYPE IS NOT NULL AND :NEW.ORDER_TYPE IS NULL) OR
        (:OLD.ORDER_TYPE != :NEW.ORDER_TYPE)) THEN 
      v_changed_cols := v_changed_cols || 'ORDER_TYPE,'; 
    END IF;
    IF (:OLD.RECEIVED_DATE != :NEW.RECEIVED_DATE) THEN v_changed_cols := v_changed_cols || 'RECEIVED_DATE,'; END IF;
    IF ((:OLD.STATUS IS NULL AND :NEW.STATUS IS NOT NULL) OR 
        (:OLD.STATUS IS NOT NULL AND :NEW.STATUS IS NULL) OR
        (:OLD.STATUS != :NEW.STATUS)) THEN 
      v_changed_cols := v_changed_cols || 'STATUS,'; 
    END IF;
    IF ((:OLD.DESCRIPTION IS NULL AND :NEW.DESCRIPTION IS NOT NULL) OR 
        (:OLD.DESCRIPTION IS NOT NULL AND :NEW.DESCRIPTION IS NULL) OR
        (:OLD.DESCRIPTION != :NEW.DESCRIPTION)) THEN 
      v_changed_cols := v_changed_cols || 'DESCRIPTION,'; 
    END IF;
    IF LENGTH(v_changed_cols) > 0 THEN
      v_changed_cols := SUBSTR(v_changed_cols, 1, LENGTH(v_changed_cols) - 1);
    END IF;
  END IF;

  -- Log the operation
  IF INSERTING THEN
    audit_dml_pkg.log_insert('ORDERS', v_new_values);
  ELSIF UPDATING THEN
    audit_dml_pkg.log_update('ORDERS', v_old_values, v_new_values, v_changed_cols);
  ELSIF DELETING THEN
    audit_dml_pkg.log_delete('ORDERS', v_old_values);
  END IF;
END;

/
ALTER TRIGGER "APP"."TRG_AUDIT_ORDERS" ENABLE;
--------------------------------------------------------
--  DDL for Trigger TRG_AUDIT_PART
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "APP"."TRG_AUDIT_PART" 
  AFTER INSERT OR UPDATE OR DELETE ON PART
  FOR EACH ROW
DECLARE
  v_old_values CLOB;
  v_new_values CLOB;
  v_changed_cols VARCHAR2(4000);
BEGIN
  -- Build old values (for UPDATE/DELETE)
  IF UPDATING OR DELETING THEN
    v_old_values := '{' ||
      '"PART_ID":' || NVL(TO_CHAR(:OLD.PART_ID), 'null') || ',' ||
      '"NAME":"' || REPLACE(NVL(:OLD.NAME, ''), '"', '\"') || '",' ||
      '"MANUFACTURER":"' || REPLACE(NVL(:OLD.MANUFACTURER, ''), '"', '\"') || '",' ||
      '"SERIAL":"' || REPLACE(NVL(:OLD.SERIAL, ''), '"', '\"') || '",' ||
      '"STATUS":"' || REPLACE(NVL(:OLD.STATUS, ''), '"', '\"') || '",' ||
      '"STOCK_IN_ID":' || NVL(TO_CHAR(:OLD.STOCK_IN_ID), 'null') || ',' ||
      '"ORDER_ID":' || NVL(TO_CHAR(:OLD.ORDER_ID), 'null') || ',' ||
      '"PRICE":' || NVL(TO_CHAR(:OLD.PRICE), 'null') ||
      '}';
  END IF;

  -- Build new values (for INSERT/UPDATE)
  IF INSERTING OR UPDATING THEN
    v_new_values := '{' ||
      '"PART_ID":' || NVL(TO_CHAR(:NEW.PART_ID), 'null') || ',' ||
      '"NAME":"' || REPLACE(NVL(:NEW.NAME, ''), '"', '\"') || '",' ||
      '"MANUFACTURER":"' || REPLACE(NVL(:NEW.MANUFACTURER, ''), '"', '\"') || '",' ||
      '"SERIAL":"' || REPLACE(NVL(:NEW.SERIAL, ''), '"', '\"') || '",' ||
      '"STATUS":"' || REPLACE(NVL(:NEW.STATUS, ''), '"', '\"') || '",' ||
      '"STOCK_IN_ID":' || NVL(TO_CHAR(:NEW.STOCK_IN_ID), 'null') || ',' ||
      '"ORDER_ID":' || NVL(TO_CHAR(:NEW.ORDER_ID), 'null') || ',' ||
      '"PRICE":' || NVL(TO_CHAR(:NEW.PRICE), 'null') ||
      '}';
  END IF;

  -- Track changed columns for UPDATE
  IF UPDATING THEN
    v_changed_cols := '';
    IF ((:OLD.NAME IS NULL AND :NEW.NAME IS NOT NULL) OR 
        (:OLD.NAME IS NOT NULL AND :NEW.NAME IS NULL) OR
        (:OLD.NAME != :NEW.NAME)) THEN 
      v_changed_cols := v_changed_cols || 'NAME,'; 
    END IF;
    IF ((:OLD.MANUFACTURER IS NULL AND :NEW.MANUFACTURER IS NOT NULL) OR 
        (:OLD.MANUFACTURER IS NOT NULL AND :NEW.MANUFACTURER IS NULL) OR
        (:OLD.MANUFACTURER != :NEW.MANUFACTURER)) THEN 
      v_changed_cols := v_changed_cols || 'MANUFACTURER,'; 
    END IF;
    IF ((:OLD.SERIAL IS NULL AND :NEW.SERIAL IS NOT NULL) OR 
        (:OLD.SERIAL IS NOT NULL AND :NEW.SERIAL IS NULL) OR
        (:OLD.SERIAL != :NEW.SERIAL)) THEN 
      v_changed_cols := v_changed_cols || 'SERIAL,'; 
    END IF;
    IF ((:OLD.STATUS IS NULL AND :NEW.STATUS IS NOT NULL) OR 
        (:OLD.STATUS IS NOT NULL AND :NEW.STATUS IS NULL) OR
        (:OLD.STATUS != :NEW.STATUS)) THEN 
      v_changed_cols := v_changed_cols || 'STATUS,'; 
    END IF;
    IF (:OLD.STOCK_IN_ID != :NEW.STOCK_IN_ID) THEN v_changed_cols := v_changed_cols || 'STOCK_IN_ID,'; END IF;
    IF (:OLD.ORDER_ID IS NULL AND :NEW.ORDER_ID IS NOT NULL) OR 
       (:OLD.ORDER_ID IS NOT NULL AND :NEW.ORDER_ID IS NULL) OR
       (:OLD.ORDER_ID != :NEW.ORDER_ID) THEN
      v_changed_cols := v_changed_cols || 'ORDER_ID,';
    END IF;
    IF (:OLD.PRICE IS NULL AND :NEW.PRICE IS NOT NULL) OR 
       (:OLD.PRICE IS NOT NULL AND :NEW.PRICE IS NULL) OR
       (:OLD.PRICE != :NEW.PRICE) THEN
      v_changed_cols := v_changed_cols || 'PRICE,';
    END IF;
    IF LENGTH(v_changed_cols) > 0 THEN
      v_changed_cols := SUBSTR(v_changed_cols, 1, LENGTH(v_changed_cols) - 1);
    END IF;
  END IF;

  -- Log the operation
  IF INSERTING THEN
    audit_dml_pkg.log_insert('PART', v_new_values);
  ELSIF UPDATING THEN
    audit_dml_pkg.log_update('PART', v_old_values, v_new_values, v_changed_cols);
  ELSIF DELETING THEN
    audit_dml_pkg.log_delete('PART', v_old_values);
  END IF;
END;

/
ALTER TRIGGER "APP"."TRG_AUDIT_PART" ENABLE;
--------------------------------------------------------
--  DDL for Trigger TRG_AUDIT_PART_REQUEST
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "APP"."TRG_AUDIT_PART_REQUEST" 
  AFTER INSERT OR UPDATE OR DELETE ON PART_REQUEST
  FOR EACH ROW
DECLARE
  v_old_values CLOB;
  v_new_values CLOB;
  v_changed_cols VARCHAR2(4000);
BEGIN
  -- Build old values (for UPDATE/DELETE)
  IF UPDATING OR DELETING THEN
    v_old_values := '{' ||
      '"REQUEST_ID":' || NVL(TO_CHAR(:OLD.REQUEST_ID), 'null') || ',' ||
      '"ORDER_ID":' || NVL(TO_CHAR(:OLD.ORDER_ID), 'null') || ',' ||
      '"EMP_ID":' || NVL(TO_CHAR(:OLD.EMP_ID), 'null') || ',' ||
      '"REQUEST_DATE":"' || TO_CHAR(:OLD.REQUEST_DATE, 'YYYY-MM-DD') || '",' ||
      '"STATUS":"' || REPLACE(NVL(:OLD.STATUS, ''), '"', '\"') || '"' ||
      '}';
  END IF;

  -- Build new values (for INSERT/UPDATE)
  IF INSERTING OR UPDATING THEN
    v_new_values := '{' ||
      '"REQUEST_ID":' || NVL(TO_CHAR(:NEW.REQUEST_ID), 'null') || ',' ||
      '"ORDER_ID":' || NVL(TO_CHAR(:NEW.ORDER_ID), 'null') || ',' ||
      '"EMP_ID":' || NVL(TO_CHAR(:NEW.EMP_ID), 'null') || ',' ||
      '"REQUEST_DATE":"' || TO_CHAR(:NEW.REQUEST_DATE, 'YYYY-MM-DD') || '",' ||
      '"STATUS":"' || REPLACE(NVL(:NEW.STATUS, ''), '"', '\"') || '"' ||
      '}';
  END IF;

  -- Track changed columns for UPDATE
  IF UPDATING THEN
    v_changed_cols := '';
    IF (:OLD.ORDER_ID != :NEW.ORDER_ID) THEN v_changed_cols := v_changed_cols || 'ORDER_ID,'; END IF;
    IF (:OLD.EMP_ID != :NEW.EMP_ID) THEN v_changed_cols := v_changed_cols || 'EMP_ID,'; END IF;
    IF (:OLD.REQUEST_DATE != :NEW.REQUEST_DATE) THEN v_changed_cols := v_changed_cols || 'REQUEST_DATE,'; END IF;
    IF ((:OLD.STATUS IS NULL AND :NEW.STATUS IS NOT NULL) OR 
        (:OLD.STATUS IS NOT NULL AND :NEW.STATUS IS NULL) OR
        (:OLD.STATUS != :NEW.STATUS)) THEN 
      v_changed_cols := v_changed_cols || 'STATUS,'; 
    END IF;
    IF LENGTH(v_changed_cols) > 0 THEN
      v_changed_cols := SUBSTR(v_changed_cols, 1, LENGTH(v_changed_cols) - 1);
    END IF;
  END IF;

  -- Log the operation
  IF INSERTING THEN
    audit_dml_pkg.log_insert('PART_REQUEST', v_new_values);
  ELSIF UPDATING THEN
    audit_dml_pkg.log_update('PART_REQUEST', v_old_values, v_new_values, v_changed_cols);
  ELSIF DELETING THEN
    audit_dml_pkg.log_delete('PART_REQUEST', v_old_values);
  END IF;
END;

/
ALTER TRIGGER "APP"."TRG_AUDIT_PART_REQUEST" ENABLE;
--------------------------------------------------------
--  DDL for Trigger TRG_AUDIT_PART_REQUEST_ITEM
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "APP"."TRG_AUDIT_PART_REQUEST_ITEM" 
  AFTER INSERT OR UPDATE OR DELETE ON PART_REQUEST_ITEM
  FOR EACH ROW
DECLARE
  v_old_values CLOB;
  v_new_values CLOB;
  v_changed_cols VARCHAR2(4000);
BEGIN
  -- Build old values (for UPDATE/DELETE)
  IF UPDATING OR DELETING THEN
    v_old_values := '{' ||
      '"REQUEST_ID":' || NVL(TO_CHAR(:OLD.REQUEST_ID), 'null') || ',' ||
      '"PART_ID":' || NVL(TO_CHAR(:OLD.PART_ID), 'null') ||
      '}';
  END IF;

  -- Build new values (for INSERT/UPDATE)
  IF INSERTING OR UPDATING THEN
    v_new_values := '{' ||
      '"REQUEST_ID":' || NVL(TO_CHAR(:NEW.REQUEST_ID), 'null') || ',' ||
      '"PART_ID":' || NVL(TO_CHAR(:NEW.PART_ID), 'null') ||
      '}';
  END IF;

  -- Track changed columns for UPDATE
  IF UPDATING THEN
    v_changed_cols := '';
    IF (:OLD.REQUEST_ID != :NEW.REQUEST_ID) THEN v_changed_cols := v_changed_cols || 'REQUEST_ID,'; END IF;
    IF (:OLD.PART_ID != :NEW.PART_ID) THEN v_changed_cols := v_changed_cols || 'PART_ID,'; END IF;
    IF LENGTH(v_changed_cols) > 0 THEN
      v_changed_cols := SUBSTR(v_changed_cols, 1, LENGTH(v_changed_cols) - 1);
    END IF;
  END IF;

  -- Log the operation
  IF INSERTING THEN
    audit_dml_pkg.log_insert('PART_REQUEST_ITEM', v_new_values);
  ELSIF UPDATING THEN
    audit_dml_pkg.log_update('PART_REQUEST_ITEM', v_old_values, v_new_values, v_changed_cols);
  ELSIF DELETING THEN
    audit_dml_pkg.log_delete('PART_REQUEST_ITEM', v_old_values);
  END IF;
END;

/
ALTER TRIGGER "APP"."TRG_AUDIT_PART_REQUEST_ITEM" ENABLE;
--------------------------------------------------------
--  DDL for Trigger TRG_AUDIT_STOCK_IN
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "APP"."TRG_AUDIT_STOCK_IN" 
  AFTER INSERT OR UPDATE OR DELETE ON STOCK_IN
  FOR EACH ROW
DECLARE
  v_old_values CLOB;
  v_new_values CLOB;
  v_changed_cols VARCHAR2(4000);
BEGIN
  -- Build old values (for UPDATE/DELETE)
  IF UPDATING OR DELETING THEN
    v_old_values := '{' ||
      '"STOCKIN_ID":' || NVL(TO_CHAR(:OLD.STOCKIN_ID), 'null') || ',' ||
      '"EMP_ID":' || NVL(TO_CHAR(:OLD.EMP_ID), 'null') || ',' ||
      '"IN_DATE":"' || TO_CHAR(:OLD.IN_DATE, 'YYYY-MM-DD') || '",' ||
      '"NOTE":"' || REPLACE(NVL(:OLD.NOTE, ''), '"', '\"') || '"' ||
      '}';
  END IF;

  -- Build new values (for INSERT/UPDATE)
  IF INSERTING OR UPDATING THEN
    v_new_values := '{' ||
      '"STOCKIN_ID":' || NVL(TO_CHAR(:NEW.STOCKIN_ID), 'null') || ',' ||
      '"EMP_ID":' || NVL(TO_CHAR(:NEW.EMP_ID), 'null') || ',' ||
      '"IN_DATE":"' || TO_CHAR(:NEW.IN_DATE, 'YYYY-MM-DD') || '",' ||
      '"NOTE":"' || REPLACE(NVL(:NEW.NOTE, ''), '"', '\"') || '"' ||
      '}';
  END IF;

  -- Track changed columns for UPDATE
  IF UPDATING THEN
    v_changed_cols := '';
    IF (:OLD.EMP_ID != :NEW.EMP_ID) THEN v_changed_cols := v_changed_cols || 'EMP_ID,'; END IF;
    IF (:OLD.IN_DATE != :NEW.IN_DATE) THEN v_changed_cols := v_changed_cols || 'IN_DATE,'; END IF;
    IF ((:OLD.NOTE IS NULL AND :NEW.NOTE IS NOT NULL) OR 
        (:OLD.NOTE IS NOT NULL AND :NEW.NOTE IS NULL) OR
        (:OLD.NOTE != :NEW.NOTE)) THEN 
      v_changed_cols := v_changed_cols || 'NOTE,'; 
    END IF;
    IF LENGTH(v_changed_cols) > 0 THEN
      v_changed_cols := SUBSTR(v_changed_cols, 1, LENGTH(v_changed_cols) - 1);
    END IF;
  END IF;

  -- Log the operation
  IF INSERTING THEN
    audit_dml_pkg.log_insert('STOCK_IN', v_new_values);
  ELSIF UPDATING THEN
    audit_dml_pkg.log_update('STOCK_IN', v_old_values, v_new_values, v_changed_cols);
  ELSIF DELETING THEN
    audit_dml_pkg.log_delete('STOCK_IN', v_old_values);
  END IF;
END;

/
ALTER TRIGGER "APP"."TRG_AUDIT_STOCK_IN" ENABLE;
--------------------------------------------------------
--  DDL for Trigger TRG_AUDIT_STOCK_IN_ITEM
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "APP"."TRG_AUDIT_STOCK_IN_ITEM" 
  AFTER INSERT OR UPDATE OR DELETE ON STOCK_IN_ITEM
  FOR EACH ROW
DECLARE
  v_old_values CLOB;
  v_new_values CLOB;
  v_changed_cols VARCHAR2(4000);
BEGIN
  -- Build old values (for UPDATE/DELETE)
  IF UPDATING OR DELETING THEN
    v_old_values := '{' ||
      '"STOCKIN_ITEM_ID":' || NVL(TO_CHAR(:OLD.STOCKIN_ITEM_ID), 'null') || ',' ||
      '"STOCKIN_ID":' || NVL(TO_CHAR(:OLD.STOCKIN_ID), 'null') || ',' ||
      '"PART_NAME":"' || REPLACE(NVL(:OLD.PART_NAME, ''), '"', '\"') || '",' ||
      '"MANUFACTURER":"' || REPLACE(NVL(:OLD.MANUFACTURER, ''), '"', '\"') || '",' ||
      '"SERIAL":"' || REPLACE(NVL(:OLD.SERIAL, ''), '"', '\"') || '",' ||
      '"PRICE":' || NVL(TO_CHAR(:OLD.PRICE), 'null') ||
      '}';
  END IF;

  -- Build new values (for INSERT/UPDATE)
  IF INSERTING OR UPDATING THEN
    v_new_values := '{' ||
      '"STOCKIN_ITEM_ID":' || NVL(TO_CHAR(:NEW.STOCKIN_ITEM_ID), 'null') || ',' ||
      '"STOCKIN_ID":' || NVL(TO_CHAR(:NEW.STOCKIN_ID), 'null') || ',' ||
      '"PART_NAME":"' || REPLACE(NVL(:NEW.PART_NAME, ''), '"', '\"') || '",' ||
      '"MANUFACTURER":"' || REPLACE(NVL(:NEW.MANUFACTURER, ''), '"', '\"') || '",' ||
      '"SERIAL":"' || REPLACE(NVL(:NEW.SERIAL, ''), '"', '\"') || '",' ||
      '"PRICE":' || NVL(TO_CHAR(:NEW.PRICE), 'null') ||
      '}';
  END IF;

  -- Track changed columns for UPDATE
  IF UPDATING THEN
    v_changed_cols := '';
    IF (:OLD.STOCKIN_ID != :NEW.STOCKIN_ID) THEN v_changed_cols := v_changed_cols || 'STOCKIN_ID,'; END IF;
    IF ((:OLD.PART_NAME IS NULL AND :NEW.PART_NAME IS NOT NULL) OR 
        (:OLD.PART_NAME IS NOT NULL AND :NEW.PART_NAME IS NULL) OR
        (:OLD.PART_NAME != :NEW.PART_NAME)) THEN 
      v_changed_cols := v_changed_cols || 'PART_NAME,'; 
    END IF;
    IF ((:OLD.MANUFACTURER IS NULL AND :NEW.MANUFACTURER IS NOT NULL) OR 
        (:OLD.MANUFACTURER IS NOT NULL AND :NEW.MANUFACTURER IS NULL) OR
        (:OLD.MANUFACTURER != :NEW.MANUFACTURER)) THEN 
      v_changed_cols := v_changed_cols || 'MANUFACTURER,'; 
    END IF;
    IF ((:OLD.SERIAL IS NULL AND :NEW.SERIAL IS NOT NULL) OR 
        (:OLD.SERIAL IS NOT NULL AND :NEW.SERIAL IS NULL) OR
        (:OLD.SERIAL != :NEW.SERIAL)) THEN 
      v_changed_cols := v_changed_cols || 'SERIAL,'; 
    END IF;
    IF (:OLD.PRICE IS NULL AND :NEW.PRICE IS NOT NULL) OR 
       (:OLD.PRICE IS NOT NULL AND :NEW.PRICE IS NULL) OR
       (:OLD.PRICE != :NEW.PRICE) THEN
      v_changed_cols := v_changed_cols || 'PRICE,';
    END IF;
    IF LENGTH(v_changed_cols) > 0 THEN
      v_changed_cols := SUBSTR(v_changed_cols, 1, LENGTH(v_changed_cols) - 1);
    END IF;
  END IF;

  -- Log the operation
  IF INSERTING THEN
    audit_dml_pkg.log_insert('STOCK_IN_ITEM', v_new_values);
  ELSIF UPDATING THEN
    audit_dml_pkg.log_update('STOCK_IN_ITEM', v_old_values, v_new_values, v_changed_cols);
  ELSIF DELETING THEN
    audit_dml_pkg.log_delete('STOCK_IN_ITEM', v_old_values);
  END IF;
END;

/
ALTER TRIGGER "APP"."TRG_AUDIT_STOCK_IN_ITEM" ENABLE;
--------------------------------------------------------
--  DDL for Trigger TRG_AUDIT_STOCK_OUT
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "APP"."TRG_AUDIT_STOCK_OUT" 
  AFTER INSERT OR UPDATE OR DELETE ON STOCK_OUT
  FOR EACH ROW
DECLARE
  v_old_values CLOB;
  v_new_values CLOB;
  v_changed_cols VARCHAR2(4000);
BEGIN
  -- Build old values (for UPDATE/DELETE)
  IF UPDATING OR DELETING THEN
    v_old_values := '{' ||
      '"STOCKOUT_ID":' || NVL(TO_CHAR(:OLD.STOCKOUT_ID), 'null') || ',' ||
      '"ORDER_ID":' || NVL(TO_CHAR(:OLD.ORDER_ID), 'null') || ',' ||
      '"EMP_ID":' || NVL(TO_CHAR(:OLD.EMP_ID), 'null') || ',' ||
      '"OUT_DATE":"' || TO_CHAR(:OLD.OUT_DATE, 'YYYY-MM-DD') || '",' ||
      '"NOTE":"' || REPLACE(NVL(:OLD.NOTE, ''), '"', '\"') || '"' ||
      '}';
  END IF;

  -- Build new values (for INSERT/UPDATE)
  IF INSERTING OR UPDATING THEN
    v_new_values := '{' ||
      '"STOCKOUT_ID":' || NVL(TO_CHAR(:NEW.STOCKOUT_ID), 'null') || ',' ||
      '"ORDER_ID":' || NVL(TO_CHAR(:NEW.ORDER_ID), 'null') || ',' ||
      '"EMP_ID":' || NVL(TO_CHAR(:NEW.EMP_ID), 'null') || ',' ||
      '"OUT_DATE":"' || TO_CHAR(:NEW.OUT_DATE, 'YYYY-MM-DD') || '",' ||
      '"NOTE":"' || REPLACE(NVL(:NEW.NOTE, ''), '"', '\"') || '"' ||
      '}';
  END IF;

  -- Track changed columns for UPDATE
  IF UPDATING THEN
    v_changed_cols := '';
    IF (:OLD.ORDER_ID != :NEW.ORDER_ID) THEN v_changed_cols := v_changed_cols || 'ORDER_ID,'; END IF;
    IF (:OLD.EMP_ID != :NEW.EMP_ID) THEN v_changed_cols := v_changed_cols || 'EMP_ID,'; END IF;
    IF (:OLD.OUT_DATE != :NEW.OUT_DATE) THEN v_changed_cols := v_changed_cols || 'OUT_DATE,'; END IF;
    IF ((:OLD.NOTE IS NULL AND :NEW.NOTE IS NOT NULL) OR 
        (:OLD.NOTE IS NOT NULL AND :NEW.NOTE IS NULL) OR
        (:OLD.NOTE != :NEW.NOTE)) THEN 
      v_changed_cols := v_changed_cols || 'NOTE,'; 
    END IF;
    IF LENGTH(v_changed_cols) > 0 THEN
      v_changed_cols := SUBSTR(v_changed_cols, 1, LENGTH(v_changed_cols) - 1);
    END IF;
  END IF;

  -- Log the operation
  IF INSERTING THEN
    audit_dml_pkg.log_insert('STOCK_OUT', v_new_values);
  ELSIF UPDATING THEN
    audit_dml_pkg.log_update('STOCK_OUT', v_old_values, v_new_values, v_changed_cols);
  ELSIF DELETING THEN
    audit_dml_pkg.log_delete('STOCK_OUT', v_old_values);
  END IF;
END;

/
ALTER TRIGGER "APP"."TRG_AUDIT_STOCK_OUT" ENABLE;
--------------------------------------------------------
--  DDL for Trigger TRG_AUDIT_STOCK_OUT_ITEM
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "APP"."TRG_AUDIT_STOCK_OUT_ITEM" 
  AFTER INSERT OR UPDATE OR DELETE ON STOCK_OUT_ITEM
  FOR EACH ROW
DECLARE
  v_old_values CLOB;
  v_new_values CLOB;
  v_changed_cols VARCHAR2(4000);
BEGIN
  -- Build old values (for UPDATE/DELETE)
  IF UPDATING OR DELETING THEN
    v_old_values := '{' ||
      '"STOCKOUT_ID":' || NVL(TO_CHAR(:OLD.STOCKOUT_ID), 'null') || ',' ||
      '"PART_ID":' || NVL(TO_CHAR(:OLD.PART_ID), 'null') ||
      '}';
  END IF;

  -- Build new values (for INSERT/UPDATE)
  IF INSERTING OR UPDATING THEN
    v_new_values := '{' ||
      '"STOCKOUT_ID":' || NVL(TO_CHAR(:NEW.STOCKOUT_ID), 'null') || ',' ||
      '"PART_ID":' || NVL(TO_CHAR(:NEW.PART_ID), 'null') ||
      '}';
  END IF;

  -- Track changed columns for UPDATE
  IF UPDATING THEN
    v_changed_cols := '';
    IF (:OLD.STOCKOUT_ID != :NEW.STOCKOUT_ID) THEN v_changed_cols := v_changed_cols || 'STOCKOUT_ID,'; END IF;
    IF (:OLD.PART_ID != :NEW.PART_ID) THEN v_changed_cols := v_changed_cols || 'PART_ID,'; END IF;
    IF LENGTH(v_changed_cols) > 0 THEN
      v_changed_cols := SUBSTR(v_changed_cols, 1, LENGTH(v_changed_cols) - 1);
    END IF;
  END IF;

  -- Log the operation
  IF INSERTING THEN
    audit_dml_pkg.log_insert('STOCK_OUT_ITEM', v_new_values);
  ELSIF UPDATING THEN
    audit_dml_pkg.log_update('STOCK_OUT_ITEM', v_old_values, v_new_values, v_changed_cols);
  ELSIF DELETING THEN
    audit_dml_pkg.log_delete('STOCK_OUT_ITEM', v_old_values);
  END IF;
END;

/
ALTER TRIGGER "APP"."TRG_AUDIT_STOCK_OUT_ITEM" ENABLE;
--------------------------------------------------------
--  DDL for Procedure ACCEPT_PART_REQUEST
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."ACCEPT_PART_REQUEST" (
    p_request_id IN NUMBER
)
AS
BEGIN
    -- 1. Cập nhật trạng thái request
    UPDATE PART_REQUEST
    SET STATUS = 'Đồng ý'
    WHERE REQUEST_ID = p_request_id; 
    -- 2. Cập nhật tất cả part dựa trên request items
    UPDATE PART p
       SET STATUS = 'Đã gán',
           ORDER_ID = (SELECT pr.ORDER_ID
                       FROM PART_REQUEST pr
                      WHERE pr.REQUEST_ID = p_request_id)
     WHERE p.PART_ID IN (SELECT pri.PART_ID
                           FROM PART_REQUEST_ITEM pri
                          WHERE pri.REQUEST_ID = p_request_id);

    COMMIT;
END ACCEPT_PART_REQUEST;

/

  GRANT EXECUTE ON "APP"."ACCEPT_PART_REQUEST" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."ACCEPT_PART_REQUEST" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Procedure ASSIGN_PROFILE_TO_USER
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."ASSIGN_PROFILE_TO_USER" (
    p_username IN VARCHAR2,
    p_profile_name IN VARCHAR2
)
AS
BEGIN
    EXECUTE IMMEDIATE 'ALTER USER "' || p_username || '" PROFILE "' || UPPER(p_profile_name) || '"';
END ASSIGN_PROFILE_TO_USER;

/

  GRANT EXECUTE ON "APP"."ASSIGN_PROFILE_TO_USER" TO "ROLE_ADMIN";
--------------------------------------------------------
--  DDL for Procedure ASSIGN_ROLE_PROC
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."ASSIGN_ROLE_PROC" (
    p_username IN VARCHAR2,
    p_role_name IN VARCHAR2
)
AS
BEGIN
    EXECUTE IMMEDIATE 'GRANT "' || p_role_name || '" TO "' || p_username || '"';
END;


/

  GRANT EXECUTE ON "APP"."ASSIGN_ROLE_PROC" TO "ROLE_ADMIN";
--------------------------------------------------------
--  DDL for Procedure AUDIT_STD_DISABLE_ALL
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."AUDIT_STD_DISABLE_ALL" AS
BEGIN
  EXECUTE IMMEDIATE 'NOAUDIT INSERT, UPDATE, DELETE ON EMPLOYEE';
  EXECUTE IMMEDIATE 'NOAUDIT INSERT, UPDATE, DELETE ON CUSTOMER';
  EXECUTE IMMEDIATE 'NOAUDIT INSERT, UPDATE, DELETE ON ORDERS';
  EXECUTE IMMEDIATE 'NOAUDIT INSERT, UPDATE, DELETE ON STOCK_IN';
  EXECUTE IMMEDIATE 'NOAUDIT INSERT, UPDATE, DELETE ON STOCK_IN_ITEM';
  EXECUTE IMMEDIATE 'NOAUDIT INSERT, UPDATE, DELETE ON PART';
  EXECUTE IMMEDIATE 'NOAUDIT INSERT, UPDATE, DELETE ON STOCK_OUT';
  EXECUTE IMMEDIATE 'NOAUDIT INSERT, UPDATE, DELETE ON STOCK_OUT_ITEM';
  EXECUTE IMMEDIATE 'NOAUDIT INSERT, UPDATE, DELETE ON PART_REQUEST';
  EXECUTE IMMEDIATE 'NOAUDIT INSERT, UPDATE, DELETE ON PART_REQUEST_ITEM';
  EXECUTE IMMEDIATE 'NOAUDIT INSERT, UPDATE, DELETE ON USER_OTP_LOG';
  EXECUTE IMMEDIATE 'NOAUDIT INSERT, UPDATE, DELETE ON EMPLOYEE_SHIFT';
  EXECUTE IMMEDIATE 'NOAUDIT INSERT, UPDATE, DELETE ON CUSTOMER_APPOINTMENT';
  EXECUTE IMMEDIATE 'NOAUDIT INSERT, UPDATE, DELETE ON INVOICE';
  EXECUTE IMMEDIATE 'NOAUDIT INSERT, UPDATE, DELETE ON INVOICE_ITEM';
  EXECUTE IMMEDIATE 'NOAUDIT INSERT, UPDATE, DELETE ON SERVICE';
  EXECUTE IMMEDIATE 'NOAUDIT INSERT, UPDATE, DELETE ON ORDER_SERVICE';
  EXECUTE IMMEDIATE 'NOAUDIT INSERT, UPDATE, DELETE ON INVOICE_SERVICE';
END;

/

  GRANT EXECUTE ON "APP"."AUDIT_STD_DISABLE_ALL" TO "ROLE_ADMIN";
--------------------------------------------------------
--  DDL for Procedure AUDIT_STD_ENABLE_ALL
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."AUDIT_STD_ENABLE_ALL" AS
BEGIN
  -- Chỉ cần thêm các bảng bạn muốn audit
  EXECUTE IMMEDIATE 'AUDIT INSERT, UPDATE, DELETE ON EMPLOYEE BY ACCESS';
  EXECUTE IMMEDIATE 'AUDIT INSERT, UPDATE, DELETE ON CUSTOMER BY ACCESS';
  EXECUTE IMMEDIATE 'AUDIT INSERT, UPDATE, DELETE ON ORDERS BY ACCESS';
  EXECUTE IMMEDIATE 'AUDIT INSERT, UPDATE, DELETE ON STOCK_IN BY ACCESS';
  EXECUTE IMMEDIATE 'AUDIT INSERT, UPDATE, DELETE ON STOCK_IN_ITEM BY ACCESS';
  EXECUTE IMMEDIATE 'AUDIT INSERT, UPDATE, DELETE ON PART BY ACCESS';
  EXECUTE IMMEDIATE 'AUDIT INSERT, UPDATE, DELETE ON STOCK_OUT BY ACCESS';
  EXECUTE IMMEDIATE 'AUDIT INSERT, UPDATE, DELETE ON STOCK_OUT_ITEM BY ACCESS';
  EXECUTE IMMEDIATE 'AUDIT INSERT, UPDATE, DELETE ON PART_REQUEST BY ACCESS';
  EXECUTE IMMEDIATE 'AUDIT INSERT, UPDATE, DELETE ON PART_REQUEST_ITEM BY ACCESS';
  EXECUTE IMMEDIATE 'AUDIT INSERT, UPDATE, DELETE ON USER_OTP_LOG BY ACCESS';
  EXECUTE IMMEDIATE 'AUDIT INSERT, UPDATE, DELETE ON EMPLOYEE_SHIFT BY ACCESS';
  EXECUTE IMMEDIATE 'AUDIT INSERT, UPDATE, DELETE ON CUSTOMER_APPOINTMENT BY ACCESS';
  EXECUTE IMMEDIATE 'AUDIT INSERT, UPDATE, DELETE ON INVOICE BY ACCESS';
  EXECUTE IMMEDIATE 'AUDIT INSERT, UPDATE, DELETE ON INVOICE_ITEM BY ACCESS';
  EXECUTE IMMEDIATE 'AUDIT INSERT, UPDATE, DELETE ON SERVICE BY ACCESS';
  EXECUTE IMMEDIATE 'AUDIT INSERT, UPDATE, DELETE ON ORDER_SERVICE BY ACCESS';
  EXECUTE IMMEDIATE 'AUDIT INSERT, UPDATE, DELETE ON INVOICE_SERVICE BY ACCESS';
END;

/

  GRANT EXECUTE ON "APP"."AUDIT_STD_ENABLE_ALL" TO "ROLE_ADMIN";
--------------------------------------------------------
--  DDL for Procedure CANCEL_ORDER
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."CANCEL_ORDER" (
    p_order_id IN NUMBER,
    p_result OUT VARCHAR2
)
AS
    v_order_exists NUMBER;
    v_parts_count NUMBER;
BEGIN
    -- Kiểm tra ORDER có tồn tại không
    SELECT COUNT(*) INTO v_order_exists
    FROM ORDERS
    WHERE ORDER_ID = p_order_id;

    IF v_order_exists = 0 THEN
        p_result := 'Đơn hàng không tồn tại.';
        RETURN;
    END IF;

    -- Kiểm tra ORDER đã bị hủy chưa
    SELECT COUNT(*) INTO v_order_exists
    FROM ORDERS
    WHERE ORDER_ID = p_order_id AND STATUS = 'Đã hủy';

    IF v_order_exists > 0 THEN
        p_result := 'Đơn hàng đã được hủy trước đó.';
        RETURN;
    END IF;

    -- Đếm số PART liên quan
    SELECT COUNT(*) INTO v_parts_count
    FROM PART
    WHERE ORDER_ID = p_order_id;

    -- 1. Cập nhật PART: chuyển STATUS về "Trong kho" và set ORDER_ID = NULL
    UPDATE PART
    SET STATUS = 'Trong kho',
        ORDER_ID = NULL
    WHERE ORDER_ID = p_order_id;

    -- 2. Cập nhật STATUS của ORDER thành "Đã hủy"
    UPDATE ORDERS
    SET STATUS = 'Đã hủy'
    WHERE ORDER_ID = p_order_id;

    -- Trả về kết quả
    IF v_parts_count > 0 THEN
        p_result := 'Hủy đơn hàng thành công. Đã giải phóng ' || v_parts_count || ' linh kiện về kho.';
    ELSE
        p_result := 'Hủy đơn hàng thành công.';
    END IF;

    COMMIT;

EXCEPTION
    WHEN OTHERS THEN
        ROLLBACK;
        p_result := 'Lỗi khi hủy đơn hàng: ' || SQLERRM;
        RAISE;
END CANCEL_ORDER;

/

  GRANT EXECUTE ON "APP"."CANCEL_ORDER" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."CANCEL_ORDER" TO "ROLE_TIEPTAN";
--------------------------------------------------------
--  DDL for Procedure CHANGE_CUSTOMER_PASSWORD
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."CHANGE_CUSTOMER_PASSWORD" (
    p_phone        IN VARCHAR2,  -- Số điện thoại dùng làm PK / DB user
    p_old_password IN VARCHAR2,  -- Mật khẩu cũ
    p_new_password IN VARCHAR2   -- Mật khẩu mới
)
AS
    v_old_hash VARCHAR2(256);
    v_new_hash VARCHAR2(256);
    v_pwd      VARCHAR2(20);
BEGIN
    -- 1. Lấy hash mật khẩu hiện tại từ bảng CUSTOMER
    SELECT PASSWORD_HASH
    INTO v_old_hash
    FROM CUSTOMER
    WHERE PHONE = p_phone;

    -- 2. Kiểm tra mật khẩu cũ
    IF v_old_hash != HASH_PASSWORD(p_old_password) THEN
        RAISE_APPLICATION_ERROR(-20001, 'Mật khẩu cũ không đúng cho khách hàng: ' || p_phone);
    END IF;

    -- 3. Hash mật khẩu mới
    v_new_hash := HASH_PASSWORD(p_new_password);
    v_pwd      := HASH_PASSWORD_20CHARS(p_new_password);

    -- 4. Cập nhật bảng CUSTOMER
    BEGIN
        UPDATE CUSTOMER
        SET PASSWORD_HASH = v_new_hash
        WHERE PHONE = p_phone;

        COMMIT;
    EXCEPTION
        WHEN OTHERS THEN
            ROLLBACK;
            RAISE;
    END;

    -- 5. Cập nhật Oracle DB user password
    BEGIN
        EXECUTE IMMEDIATE 'ALTER USER "' || p_phone || '" IDENTIFIED BY "' || v_pwd || '"';
    EXCEPTION
        WHEN OTHERS THEN
            RAISE_APPLICATION_ERROR(-20002, 'Không thể đổi password cho DB user ' || p_phone || ': ' || SQLERRM);
    END;

END CHANGE_CUSTOMER_PASSWORD;

/

  GRANT EXECUTE ON "APP"."CHANGE_CUSTOMER_PASSWORD" TO "ROLE_KHACHHANG";
--------------------------------------------------------
--  DDL for Procedure CHANGE_EMPLOYEE_PASSWORD
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."CHANGE_EMPLOYEE_PASSWORD" (
    p_username        IN VARCHAR2,  -- Số điện thoại dùng làm PK / DB user
    p_old_password IN VARCHAR2,  -- Mật khẩu cũ
    p_new_password IN VARCHAR2   -- Mật khẩu mới
)
AS
    v_old_hash VARCHAR2(256);
    v_new_hash VARCHAR2(256);
    v_pwd      VARCHAR2(20);
BEGIN
    -- 1. Lấy hash mật khẩu hiện tại từ bảng CUSTOMER
    SELECT PASSWORD_HASH
    INTO v_old_hash
    FROM EMPLOYEE
    WHERE USERNAME = p_username;

    -- 2. Kiểm tra mật khẩu cũ
    IF v_old_hash != HASH_PASSWORD(p_old_password) THEN
        RAISE_APPLICATION_ERROR(-20001, 'Mật khẩu cũ không đúng cho khách hàng: ' || p_username);
    END IF;

    -- 3. Hash mật khẩu mới
    v_new_hash := HASH_PASSWORD(p_new_password);
    v_pwd      := HASH_PASSWORD_20CHARS(p_new_password);

    -- 4. Cập nhật bảng Employee
    BEGIN
        UPDATE EMPLOYEE
        SET PASSWORD_HASH = v_new_hash
        WHERE USERNAME = p_username;

        COMMIT;
    EXCEPTION
        WHEN OTHERS THEN
            ROLLBACK;
            RAISE;
    END;

    -- 5. Cập nhật Oracle DB user password
    BEGIN
        EXECUTE IMMEDIATE 'ALTER USER "' || UPPER(p_username) || '" IDENTIFIED BY "' || v_pwd || '"';

    EXCEPTION
        WHEN OTHERS THEN
            RAISE_APPLICATION_ERROR(-20002, 'Không thể đổi password cho DB user ' || p_username || ': ' || SQLERRM);
    END;

END CHANGE_EMPLOYEE_PASSWORD;

/

  GRANT EXECUTE ON "APP"."CHANGE_EMPLOYEE_PASSWORD" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."CHANGE_EMPLOYEE_PASSWORD" TO "ROLE_THUKHO";
  GRANT EXECUTE ON "APP"."CHANGE_EMPLOYEE_PASSWORD" TO "ROLE_TIEPTAN";
  GRANT EXECUTE ON "APP"."CHANGE_EMPLOYEE_PASSWORD" TO "ROLE_KITHUATVIEN";
--------------------------------------------------------
--  DDL for Procedure COMPLETE_PART_REQUEST
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."COMPLETE_PART_REQUEST" (
    p_request_id IN NUMBER
)
AS
BEGIN
    -- 1. Cập nhật trạng thái request 
    UPDATE PART_REQUEST
    SET STATUS = 'Từ chối'
    WHERE REQUEST_ID = p_request_id;

    -- 2. Cập nhật tất cả part dựa trên request items
    UPDATE PART p
       SET STATUS = 'Đã gán',
           ORDER_ID = (SELECT pr.ORDER_ID
                       FROM PART_REQUEST pr
                      WHERE pr.REQUEST_ID = p_request_id)
     WHERE p.PART_ID IN (SELECT pri.PART_ID
                           FROM PART_REQUEST_ITEM pri
                          WHERE pri.REQUEST_ID = p_request_id);

    COMMIT;
END COMPLETE_PART_REQUEST;

/

  GRANT EXECUTE ON "APP"."COMPLETE_PART_REQUEST" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."COMPLETE_PART_REQUEST" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Procedure CREATE_APPOINTMENT
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."CREATE_APPOINTMENT" (
    p_customer_phone IN VARCHAR2,
    p_appointment_date IN DATE,
    p_description IN VARCHAR2 DEFAULT NULL,
    p_status OUT VARCHAR2
)
AS
BEGIN
    INSERT INTO CUSTOMER_APPOINTMENT (
        APPOINTMENT_ID,
        CUSTOMER_PHONE,
        APPOINTMENT_DATE,
        STATUS,
        DESCRIPTION
    )
    VALUES (
        APPOINTMENT_SEQ.NEXTVAL,  -- giả sử bạn có sequence APPOINTMENT_SEQ
        p_customer_phone,
        p_appointment_date,
        'Đã lên lịch',  -- mặc định trạng thái
        p_description
    );

    p_status := 'Đã lên lịch';

    COMMIT;
EXCEPTION
    WHEN OTHERS THEN
        ROLLBACK;
        RAISE_APPLICATION_ERROR(-20001, 'Không thể tạo lịch: ' || SQLERRM);
END;

/

  GRANT EXECUTE ON "APP"."CREATE_APPOINTMENT" TO "ROLE_KHACHHANG";
  GRANT EXECUTE ON "APP"."CREATE_APPOINTMENT" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."CREATE_APPOINTMENT" TO "ROLE_TIEPTAN";
--------------------------------------------------------
--  DDL for Procedure CREATE_INVOICE
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."CREATE_INVOICE" (
    p_stockout_id     IN NUMBER,
    p_invoice_id      OUT NUMBER
)
AS
    v_order_id        NUMBER;
    v_customer_phone  VARCHAR2(20);
    v_emp_id          NUMBER;
    v_total_amount    NUMBER(20,2) := 0;
    v_part_price      NUMBER(20,2);
    v_service_price   NUMBER(20,2);
BEGIN
    -- 1. Lấy thông tin từ STOCK_OUT
    SELECT so.ORDER_ID, so.EMP_ID
    INTO v_order_id, v_emp_id
    FROM APP.STOCK_OUT so
    WHERE so.STOCKOUT_ID = p_stockout_id;

    -- 2. Lấy CUSTOMER_PHONE
    SELECT o.CUSTOMER_PHONE
    INTO v_customer_phone
    FROM APP.ORDERS o
    WHERE o.ORDER_ID = v_order_id;

    -- 3. Tính tổng tiền service
    SELECT NVL(SUM(os.PRICE * os.QUANTITY), 0)
    INTO v_service_price
    FROM APP.ORDER_SERVICE os
    WHERE os.ORDER_ID = v_order_id;

    -- 4. Tính tổng tiền linh kiện (luôn tính đúng giá)
    SELECT NVL(SUM(p.PRICE), 0)
    INTO v_part_price
    FROM APP.STOCK_OUT_ITEM soi
    JOIN APP.PART p ON soi.PART_ID = p.PART_ID
    WHERE soi.STOCKOUT_ID = p_stockout_id;

    -- 5. Tính tổng tiền hóa đơn
    IF v_service_price = 0 THEN
        v_total_amount := 0;    -- Đây là bảo hành
    ELSE
        v_total_amount := v_service_price + v_part_price;
    END IF;

    -- 6. Insert INVOICE
    INSERT INTO APP.INVOICE (
        INVOICE_ID, STOCKOUT_ID, CUSTOMER_PHONE, EMP_ID,
        INVOICE_DATE, TOTAL_AMOUNT, STATUS
    )
    VALUES (
        INVOICE_SEQ.NEXTVAL,
        p_stockout_id,
        v_customer_phone,
        v_emp_id,
        SYSDATE,
        v_total_amount,
        'PENDING'
    )
    RETURNING INVOICE_ID INTO p_invoice_id;

    -- 7. INVOICE_ITEM (luôn lấy giá thật)
    INSERT INTO APP.INVOICE_ITEM (
        INVOICE_ID, STOCKOUT_ID, PART_ID, PRICE
    )
    SELECT 
        p_invoice_id,
        soi.STOCKOUT_ID,
        soi.PART_ID,
        p.PRICE
    FROM APP.STOCK_OUT_ITEM soi
    JOIN APP.PART p ON soi.PART_ID = p.PART_ID
    WHERE soi.STOCKOUT_ID = p_stockout_id;

    -- 8. INVOICE_SERVICE (giữ nguyên giá thiết lập)
    INSERT INTO APP.INVOICE_SERVICE (
        INVOICE_ID, SERVICE_ID, QUANTITY, PRICE
    )
    SELECT 
        p_invoice_id,
        os.SERVICE_ID,
        os.QUANTITY,
        os.PRICE
    FROM APP.ORDER_SERVICE os
    WHERE os.ORDER_ID = v_order_id;

EXCEPTION
    WHEN NO_DATA_FOUND THEN
        RAISE_APPLICATION_ERROR(-20005,
        'Không tìm thấy dữ liệu liên quan đến StockOut ID ' || p_stockout_id);
    WHEN OTHERS THEN
        RAISE;
END CREATE_INVOICE;

/

  GRANT EXECUTE ON "APP"."CREATE_INVOICE" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."CREATE_INVOICE" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Procedure CREATE_ORDER
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."CREATE_ORDER" (
    p_customer_phone      IN VARCHAR2,
    p_receiver_emp_name   IN VARCHAR2,
    p_handler_emp_name    IN VARCHAR2,
    p_order_type          IN VARCHAR2,
    p_status              IN VARCHAR2,
    p_description         IN VARCHAR2 DEFAULT NULL,
    p_order_id            OUT NUMBER -- ✅ Thêm tham số OUT để trả về ID mới
)
AS
    v_receiver_emp_id EMPLOYEE.EMP_ID%TYPE;
    v_handler_emp_id  EMPLOYEE.EMP_ID%TYPE;
BEGIN
    -- 1. Lấy EMP_ID từ username (Giữ nguyên logic)
    SELECT EMP_ID INTO v_receiver_emp_id
      FROM EMPLOYEE
     WHERE USERNAME = p_receiver_emp_name;

    SELECT EMP_ID INTO v_handler_emp_id
      FROM EMPLOYEE
     WHERE USERNAME = p_handler_emp_name;

    -- 2. Insert đơn hàng và trả về ID
    INSERT INTO ORDERS (
        ORDER_ID,
        CUSTOMER_PHONE,
        RECEIVER_EMP,
        HANDLER_EMP,
        ORDER_TYPE,
        RECEIVED_DATE,
        STATUS,
        DESCRIPTION
    ) VALUES (
        -- Giả định ORDERS_SEQ là Sequence để tạo ORDER_ID
        ORDERS_SEQ.NEXTVAL,
        p_customer_phone,
        v_receiver_emp_id,
        v_handler_emp_id,
        p_order_type,
        SYSDATE,
        p_status,
        p_description
    )
    -- ✅ Thêm mệnh đề RETURNING INTO để gán ID mới cho tham số OUT
    RETURNING ORDER_ID INTO p_order_id; 

    -- ❌ Đã xóa lệnh COMMIT vì Transaction được quản lý ở tầng C#
    
EXCEPTION
    WHEN NO_DATA_FOUND THEN
        -- Không cần ROLLBACK ở đây vì C# sẽ xử lý Transaction
        RAISE_APPLICATION_ERROR(-20001, 'Username nhân viên hoặc Khách hàng không tồn tại.');
    WHEN OTHERS THEN
        -- Không cần ROLLBACK
        RAISE;
END CREATE_ORDER;

/

  GRANT EXECUTE ON "APP"."CREATE_ORDER" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."CREATE_ORDER" TO "ROLE_TIEPTAN";
  GRANT EXECUTE ON "APP"."CREATE_ORDER" TO "ROLE_KITHUATVIEN";
--------------------------------------------------------
--  DDL for Procedure CREATE_ORDER_SERVICE
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."CREATE_ORDER_SERVICE" (
    p_order_id      IN ORDER_SERVICE.ORDER_ID%TYPE,
    p_service_id    IN ORDER_SERVICE.SERVICE_ID%TYPE,
    p_quantity      IN ORDER_SERVICE.QUANTITY%TYPE,
    p_price         IN ORDER_SERVICE.PRICE%TYPE,
    p_result        OUT VARCHAR2 -- Tham số OUT để trả về kết quả
)
AS
    v_count NUMBER;
BEGIN
    -- 1. Kiểm tra tính hợp lệ của ORDER_ID và SERVICE_ID

    -- Kiểm tra Order có tồn tại không
    SELECT COUNT(*) INTO v_count FROM ORDERS WHERE ORDER_ID = p_order_id;
    IF v_count = 0 THEN
        p_result := 'Lỗi: Order ID ' || p_order_id || ' không tồn tại.';
        RETURN;
    END IF;

    -- Kiểm tra Service có tồn tại không
    SELECT COUNT(*) INTO v_count FROM SERVICE WHERE SERVICE_ID = p_service_id;
    IF v_count = 0 THEN
        p_result := 'Lỗi: Service ID ' || p_service_id || ' không tồn tại.';
        RETURN;
    END IF;

    -- Kiểm tra xem dịch vụ này đã được thêm vào order này chưa (dựa vào PK)
    SELECT COUNT(*) INTO v_count 
    FROM ORDER_SERVICE 
    WHERE ORDER_ID = p_order_id AND SERVICE_ID = p_service_id;

    IF v_count > 0 THEN
        p_result := 'Lỗi: Dịch vụ này đã tồn tại trong Order ID ' || p_order_id || '.';
        RETURN;
    END IF;

    -- 2. Chèn dữ liệu mới vào ORDER_SERVICE
    INSERT INTO ORDER_SERVICE (
        ORDER_ID, 
        SERVICE_ID, 
        QUANTITY, 
        PRICE
    ) VALUES (
        p_order_id, 
        p_service_id, 
        p_quantity, 
        p_price
    );

    -- Ghi nhận thành công
    p_result := 'Thành công: Đã thêm dịch vụ ' || p_service_id || ' vào Order ' || p_order_id || '.';

    COMMIT;

EXCEPTION
    WHEN OTHERS THEN
        -- Xử lý lỗi hệ thống chung
        ROLLBACK;
        p_result := 'Lỗi hệ thống: ' || SQLERRM;
END;

/

  GRANT EXECUTE ON "APP"."CREATE_ORDER_SERVICE" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."CREATE_ORDER_SERVICE" TO "ROLE_TIEPTAN";
  GRANT EXECUTE ON "APP"."CREATE_ORDER_SERVICE" TO "ROLE_KITHUATVIEN";
--------------------------------------------------------
--  DDL for Procedure CREATE_PART
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."CREATE_PART" (
    p_stockin_id IN NUMBER,
    p_part_name IN VARCHAR2,
    p_manufacturer IN VARCHAR2,
    p_serial IN VARCHAR2,
    p_price IN NUMBER       -- thêm tham số price
)
AS
BEGIN
    INSERT INTO APP.PART (
        PART_ID, NAME, MANUFACTURER, SERIAL, STATUS, STOCK_IN_ID, PRICE
    )
    VALUES (
        PART_SEQ.NEXTVAL, p_part_name, p_manufacturer, p_serial, 'Trong kho', p_stockin_id, p_price
    );
END CREATE_PART;

/

  GRANT EXECUTE ON "APP"."CREATE_PART" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."CREATE_PART" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Procedure CREATE_PART_REQUEST
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."CREATE_PART_REQUEST" (
    p_order_id     IN NUMBER,
    p_emp_id       IN NUMBER,
    p_status       IN VARCHAR2,
    p_request_date IN DATE,       -- nhận từ C#
    p_request_id   OUT NUMBER
)
AS
BEGIN
    INSERT INTO PART_REQUEST (REQUEST_ID, ORDER_ID, EMP_ID, REQUEST_DATE, STATUS)
    VALUES (PART_REQUEST_SEQ.NEXTVAL, p_order_id, p_emp_id, p_request_date, p_status)
    RETURNING REQUEST_ID INTO p_request_id;
END;

/

  GRANT EXECUTE ON "APP"."CREATE_PART_REQUEST" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."CREATE_PART_REQUEST" TO "ROLE_KITHUATVIEN";
--------------------------------------------------------
--  DDL for Procedure CREATE_PART_REQUEST_ITEM
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."CREATE_PART_REQUEST_ITEM" (
    p_request_id IN NUMBER,
    p_part_id    IN NUMBER
    -- Không cần tham số OUT vì không có ID tự động tăng để trả về
)
AS
    -- Khai báo biến để kiểm tra sự tồn tại (Tùy chọn, Khóa Chính sẽ tự kiểm tra)
    v_count NUMBER; 
BEGIN
    -- 1. (Tùy chọn) Kiểm tra xem linh kiện đã được yêu cầu chưa
    SELECT COUNT(*) INTO v_count 
    FROM PART_REQUEST_ITEM 
    WHERE REQUEST_ID = p_request_id AND PART_ID = p_part_id;
    
    IF v_count > 0 THEN
        -- Nếu đã tồn tại, có thể RAISE lỗi hoặc đơn giản là thoát
        RAISE_APPLICATION_ERROR(-20001, 
            'Lỗi: Linh kiện ' || p_part_id || ' đã tồn tại trong yêu cầu ' || p_request_id || '.');
    END IF;

    -- 2. Chèn dữ liệu mới
    INSERT INTO PART_REQUEST_ITEM (REQUEST_ID, PART_ID)
    VALUES (p_request_id, p_part_id);
    
    -- Thêm logic nghiệp vụ: Cập nhật trạng thái của linh kiện (PART.STATUS) thành 'REQUESTED'
    UPDATE PART
    SET STATUS = 'Đã được đăng kí'
    WHERE PART_ID = p_part_id;
    
    COMMIT;
    
EXCEPTION
    -- Xử lý lỗi nếu Khóa Ngoại (FK) bị vi phạm (Request hoặc Part không tồn tại)
    WHEN OTHERS THEN
        ROLLBACK;
        -- Lỗi ORA-00001 (Unique constraint violated) sẽ tự động được xử lý nếu bạn bỏ qua bước kiểm tra v_count
        RAISE_APPLICATION_ERROR(-20002, 'Lỗi hệ thống khi tạo yêu cầu linh kiện: ' || SQLERRM);
END;

/

  GRANT EXECUTE ON "APP"."CREATE_PART_REQUEST_ITEM" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."CREATE_PART_REQUEST_ITEM" TO "ROLE_KITHUATVIEN";
--------------------------------------------------------
--  DDL for Procedure CREATE_PROFILE
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."CREATE_PROFILE" (
    p_profile_name IN VARCHAR2,
    p_idle_time IN VARCHAR2 DEFAULT 'UNLIMITED',
    p_connect_time IN VARCHAR2 DEFAULT 'UNLIMITED',
    p_failed_login IN VARCHAR2 DEFAULT 'UNLIMITED',
    p_lock_time IN VARCHAR2 DEFAULT 'UNLIMITED',
    p_inactive_account_time IN VARCHAR2 DEFAULT 'UNLIMITED'
)
AS
BEGIN
    EXECUTE IMMEDIATE 'CREATE PROFILE ' || UPPER(p_profile_name) || ' LIMIT
        IDLE_TIME ' || p_idle_time || '
        CONNECT_TIME ' || p_connect_time || '
        FAILED_LOGIN_ATTEMPTS ' || p_failed_login || '
        PASSWORD_LOCK_TIME ' || p_lock_time || '
        INACTIVE_ACCOUNT_TIME ' || p_inactive_account_time;
END CREATE_PROFILE;


/

  GRANT EXECUTE ON "APP"."CREATE_PROFILE" TO "ROLE_ADMIN";
--------------------------------------------------------
--  DDL for Procedure CREATE_ROLE_PROC
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."CREATE_ROLE_PROC" (p_role_name IN VARCHAR2)
AS
BEGIN
    EXECUTE IMMEDIATE 'CREATE ROLE "' || p_role_name || '"';
END;

/

  GRANT EXECUTE ON "APP"."CREATE_ROLE_PROC" TO "ROLE_ADMIN";
--------------------------------------------------------
--  DDL for Procedure CREATE_STOCKIN
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."CREATE_STOCKIN" (
    p_emp_id IN NUMBER,
    p_note IN VARCHAR2,
    p_signature IN VARCHAR2,
    p_stockin_id OUT NUMBER
)
AS
BEGIN
    INSERT INTO APP.STOCK_IN (STOCKIN_ID, EMP_ID, IN_DATE, NOTE, SIGNATURE)
    VALUES (STOCKIN_SEQ.NEXTVAL, p_emp_id, SYSDATE, p_note, p_signature)
    RETURNING STOCKIN_ID INTO p_stockin_id;
END CREATE_STOCKIN;

/

  GRANT EXECUTE ON "APP"."CREATE_STOCKIN" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."CREATE_STOCKIN" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Procedure CREATE_STOCKIN_ITEM
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."CREATE_STOCKIN_ITEM" (
    p_stockin_id IN NUMBER,
    p_part_name IN VARCHAR2,
    p_manufacturer IN VARCHAR2,
    p_serial IN VARCHAR2,
    p_price IN NUMBER,             -- thêm tham số price
    p_stockin_item_id OUT NUMBER
)
AS
BEGIN
    INSERT INTO APP.STOCK_IN_ITEM (
        STOCKIN_ITEM_ID, STOCKIN_ID, PART_NAME, MANUFACTURER, SERIAL, PRICE
    )
    VALUES (
        STOCKIN_ITEM_SEQ.NEXTVAL, p_stockin_id, p_part_name, p_manufacturer, p_serial, p_price
    )
    RETURNING STOCKIN_ITEM_ID INTO p_stockin_item_id;
END CREATE_STOCKIN_ITEM;

/

  GRANT EXECUTE ON "APP"."CREATE_STOCKIN_ITEM" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."CREATE_STOCKIN_ITEM" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Procedure CREATE_STOCKOUT_TRANSACTION
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."CREATE_STOCKOUT_TRANSACTION" (
    p_order_id     IN NUMBER,
    p_emp_id       IN NUMBER,
    p_note         IN VARCHAR2,
    p_signature    IN VARCHAR2,
    p_stockout_id  OUT NUMBER
)
AS
    l_part_count NUMBER := 0;
BEGIN
    -- 1. KIỂM TRA ĐƠN HÀNG VÀ SỐ LƯỢNG LINH KIỆN
    -- Kiểm tra Order có tồn tại không
    SELECT COUNT(*) INTO l_part_count
    FROM APP.ORDERS o
    WHERE o.ORDER_ID = p_order_id;

    IF l_part_count = 0 THEN
        RAISE_APPLICATION_ERROR(-20002, 'Lỗi: Order ID ' || p_order_id || ' không tồn tại.');
    END IF;

    -- Đếm số lượng linh kiện (PART) đã gán cho Order này
    SELECT COUNT(*) INTO l_part_count
    FROM APP.PART p
    WHERE p.ORDER_ID = p_order_id
      AND p.STATUS IN ('Đã gán'); 

    IF l_part_count = 0 THEN
        RAISE_APPLICATION_ERROR(-20003, 'Lỗi: Không có linh kiện nào sẵn sàng để xuất kho cho Order ID ' || p_order_id);
    END IF;

    -- 2. TẠO PHIẾU XUẤT KHO (STOCK_OUT)
    INSERT INTO APP.STOCK_OUT (STOCKOUT_ID, ORDER_ID, EMP_ID, OUT_DATE, NOTE, SIGNATURE)
    VALUES (STOCKOUT_SEQ.NEXTVAL, p_order_id, p_emp_id, SYSDATE, p_note, p_signature)
    RETURNING STOCKOUT_ID INTO p_stockout_id;

    -- 3. CHÈN BẢN GHI VÀO STOCK_OUT_ITEM VÀ CẬP NHẬT PART

    -- Chèn tất cả PART_ID có cùng ORDER_ID vào STOCK_OUT_ITEM
    INSERT INTO APP.STOCK_OUT_ITEM (STOCKOUT_ID, PART_ID)
    SELECT 
        p_stockout_id, 
        p.PART_ID
    FROM 
        APP.PART p
    WHERE 
        p.ORDER_ID = p_order_id
        AND p.STATUS IN ('Đã gán');

    -- Cập nhật trạng thái và Order_ID cho các linh kiện đã được xuất
    UPDATE APP.PART
    SET 
        STATUS = 'Đã xuất kho' -- Đánh dấu đã sử dụng
    WHERE 
        ORDER_ID = p_order_id
        AND STATUS IN ('Đã gán');

    -- 4. CẬP NHẬT TRẠNG THÁI ORDER (Tùy chọn: Đánh dấu Order đã được xuất kho)
     UPDATE APP.ORDERS
     SET STATUS = 'Đã hoàn thành' 
     WHERE ORDER_ID = p_order_id;

    COMMIT; -- Tự động commit sau khi thành công

EXCEPTION
    WHEN OTHERS THEN
        ROLLBACK;
        RAISE;
END CREATE_STOCKOUT_TRANSACTION;

/

  GRANT EXECUTE ON "APP"."CREATE_STOCKOUT_TRANSACTION" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."CREATE_STOCKOUT_TRANSACTION" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Procedure DELETE_PROFILE
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."DELETE_PROFILE" (
    p_profile_name IN VARCHAR2
)
AS
BEGIN
    EXECUTE IMMEDIATE 'DROP PROFILE ' || UPPER(p_profile_name) || ' CASCADE';
END DELETE_PROFILE;

/

  GRANT EXECUTE ON "APP"."DELETE_PROFILE" TO "ROLE_ADMIN";
--------------------------------------------------------
--  DDL for Procedure DELETE_ROLE_PROC
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."DELETE_ROLE_PROC" (p_role_name IN VARCHAR2)
AS
BEGIN
    EXECUTE IMMEDIATE 'DROP ROLE "' || p_role_name || '"';
END;

/

  GRANT EXECUTE ON "APP"."DELETE_ROLE_PROC" TO "ROLE_ADMIN";
--------------------------------------------------------
--  DDL for Procedure DENY_PART_REQUEST
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."DENY_PART_REQUEST" (
    p_request_id IN NUMBER
)
AS
BEGIN
    -- 1. Cập nhật trạng thái request
    UPDATE PART_REQUEST
    SET STATUS = 'Từ chối'
    WHERE REQUEST_ID = p_request_id;



    COMMIT;
END DENY_PART_REQUEST;

/

  GRANT EXECUTE ON "APP"."DENY_PART_REQUEST" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."DENY_PART_REQUEST" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Procedure DISABLE_ALL_FGA
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."DISABLE_ALL_FGA" AS
BEGIN
  DBMS_FGA.DISABLE_POLICY(USER, 'EMPLOYEE', 'FGA_EMPLOYEE_DML');
  DBMS_FGA.DISABLE_POLICY(USER, 'CUSTOMER', 'FGA_CUSTOMER_DML');
  DBMS_FGA.DISABLE_POLICY(USER, 'ORDERS', 'FGA_ORDERS_DML');
  DBMS_FGA.DISABLE_POLICY(USER, 'STOCK_IN', 'FGA_STOCK_IN_DML');
  DBMS_FGA.DISABLE_POLICY(USER, 'STOCK_IN_ITEM', 'FGA_STOCK_IN_ITEM_DML');
  DBMS_FGA.DISABLE_POLICY(USER, 'PART', 'FGA_PART_DML');
  DBMS_FGA.DISABLE_POLICY(USER, 'STOCK_OUT', 'FGA_STOCK_OUT_DML');
  DBMS_FGA.DISABLE_POLICY(USER, 'STOCK_OUT_ITEM', 'FGA_STOCK_OUT_ITEM_DML');
  DBMS_FGA.DISABLE_POLICY(USER, 'PART_REQUEST', 'FGA_PART_REQUEST_DML');
  DBMS_FGA.DISABLE_POLICY(USER, 'PART_REQUEST_ITEM', 'FGA_PART_REQUEST_ITEM_DML');
  DBMS_FGA.DISABLE_POLICY(USER, 'USER_OTP_LOG', 'FGA_USER_OTP_LOG_DML');
  DBMS_FGA.DISABLE_POLICY(USER, 'EMPLOYEE_SHIFT', 'FGA_EMPLOYEE_SHIFT_DML');
  DBMS_FGA.DISABLE_POLICY(USER, 'CUSTOMER_APPOINTMENT', 'FGA_CUSTOMER_APPOINTMENT_DML');
  DBMS_FGA.DISABLE_POLICY(USER, 'INVOICE', 'FGA_INVOICE_DML');
  DBMS_FGA.DISABLE_POLICY(USER, 'INVOICE_ITEM', 'FGA_INVOICE_ITEM_DML');
  DBMS_FGA.DISABLE_POLICY(USER, 'SERVICE', 'FGA_SERVICE_DML');
  DBMS_FGA.DISABLE_POLICY(USER, 'ORDER_SERVICE', 'FGA_ORDER_SERVICE_DML');
  DBMS_FGA.DISABLE_POLICY(USER, 'INVOICE_SERVICE', 'FGA_INVOICE_SERVICE_DML');
END disable_all_fga;

/

  GRANT EXECUTE ON "APP"."DISABLE_ALL_FGA" TO "ROLE_ADMIN";
--------------------------------------------------------
--  DDL for Procedure ENABLE_ALL_FGA
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."ENABLE_ALL_FGA" AS
BEGIN
  DBMS_FGA.ENABLE_POLICY(USER, 'EMPLOYEE', 'FGA_EMPLOYEE_DML', TRUE);
  DBMS_FGA.ENABLE_POLICY(USER, 'CUSTOMER', 'FGA_CUSTOMER_DML', TRUE);
  DBMS_FGA.ENABLE_POLICY(USER, 'ORDERS', 'FGA_ORDERS_DML', TRUE);
  DBMS_FGA.ENABLE_POLICY(USER, 'STOCK_IN', 'FGA_STOCK_IN_DML', TRUE);
  DBMS_FGA.ENABLE_POLICY(USER, 'STOCK_IN_ITEM', 'FGA_STOCK_IN_ITEM_DML', TRUE);
  DBMS_FGA.ENABLE_POLICY(USER, 'PART', 'FGA_PART_DML', TRUE);
  DBMS_FGA.ENABLE_POLICY(USER, 'STOCK_OUT', 'FGA_STOCK_OUT_DML', TRUE);
  DBMS_FGA.ENABLE_POLICY(USER, 'STOCK_OUT_ITEM', 'FGA_STOCK_OUT_ITEM_DML', TRUE);
  DBMS_FGA.ENABLE_POLICY(USER, 'PART_REQUEST', 'FGA_PART_REQUEST_DML', TRUE);
  DBMS_FGA.ENABLE_POLICY(USER, 'PART_REQUEST_ITEM', 'FGA_PART_REQUEST_ITEM_DML', TRUE);
  DBMS_FGA.ENABLE_POLICY(USER, 'USER_OTP_LOG', 'FGA_USER_OTP_LOG_DML', TRUE);
  DBMS_FGA.ENABLE_POLICY(USER, 'EMPLOYEE_SHIFT', 'FGA_EMPLOYEE_SHIFT_DML', TRUE);
  DBMS_FGA.ENABLE_POLICY(USER, 'CUSTOMER_APPOINTMENT', 'FGA_CUSTOMER_APPOINTMENT_DML', TRUE);
  DBMS_FGA.ENABLE_POLICY(USER, 'INVOICE', 'FGA_INVOICE_DML', TRUE);
  DBMS_FGA.ENABLE_POLICY(USER, 'INVOICE_ITEM', 'FGA_INVOICE_ITEM_DML', TRUE);
  DBMS_FGA.ENABLE_POLICY(USER, 'SERVICE', 'FGA_SERVICE_DML', TRUE);
  DBMS_FGA.ENABLE_POLICY(USER, 'ORDER_SERVICE', 'FGA_ORDER_SERVICE_DML', TRUE);
  DBMS_FGA.ENABLE_POLICY(USER, 'INVOICE_SERVICE', 'FGA_INVOICE_SERVICE_DML', TRUE);
END enable_all_fga;

/

  GRANT EXECUTE ON "APP"."ENABLE_ALL_FGA" TO "ROLE_ADMIN";
--------------------------------------------------------
--  DDL for Procedure GENERATE_OTP_CUSTOMER
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GENERATE_OTP_CUSTOMER" (
    p_email IN VARCHAR2,
    p_otp OUT VARCHAR2,
    p_result OUT VARCHAR2
)
AS
    v_customer_exists NUMBER;
    v_user_id NUMBER;
    v_otp_code VARCHAR2(10);
    v_expired_at TIMESTAMP;
    p_phone VARCHAR2(20);
BEGIN
    -- Kiểm tra customer có tồn tại không
    SELECT COUNT(*) INTO v_customer_exists
    FROM CUSTOMER
    WHERE EMAIL = p_email;
    
    SELECT PHONE INTO p_phone
    FROM CUSTOMER
    WHERE EMAIL = p_email;
    
    IF v_customer_exists = 0 THEN
        p_result := 'Email này không tồn tại trong hệ thống.';
        p_otp := NULL;
        RETURN;
    END IF;

    -- Lấy USER_ID từ CUSTOMER (giả sử có mapping, nếu không thì dùng 0 hoặc tạo mapping)
    -- Vì USER_OTP_LOG cần USER_ID, ta sẽ dùng 0 hoặc tạo một mapping
    -- Ở đây ta sẽ dùng 0 vì customer không có EMP_ID
    v_user_id := 0;

    -- Generate OTP 6 chữ số
    v_otp_code := LPAD(TRUNC(DBMS_RANDOM.VALUE(100000, 999999)), 6, '0');
    v_expired_at := SYSTIMESTAMP + INTERVAL '10' MINUTE; -- OTP hết hạn sau 10 phút

    -- Insert OTP vào USER_OTP_LOG
    INSERT INTO USER_OTP_LOG (USER_ID, USERNAME, OTP, CREATED_AT, EXPIRED_AT, USED)
    VALUES (v_user_id, p_phone, v_otp_code, SYSTIMESTAMP, v_expired_at, 'N');

    p_otp := v_otp_code;
    p_result := 'OTP đã được tạo thành công.';

    COMMIT;

EXCEPTION
    WHEN OTHERS THEN
        ROLLBACK;
        p_result := 'Lỗi khi tạo OTP: ' || SQLERRM;
        p_otp := NULL;
        RAISE;
END GENERATE_OTP_CUSTOMER;

/

  GRANT EXECUTE ON "APP"."GENERATE_OTP_CUSTOMER" TO "ROLE_KHACHHANG";
--------------------------------------------------------
--  DDL for Procedure GET_ALL_APPOINTMENTS
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_ALL_APPOINTMENTS" (
    p_cursor OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN p_cursor FOR
        SELECT APPOINTMENT_ID,
               CUSTOMER_PHONE,
               APPOINTMENT_DATE,
               STATUS,
               DESCRIPTION
        FROM CUSTOMER_APPOINTMENT
        ORDER BY APPOINTMENT_DATE DESC;
END;

/

  GRANT EXECUTE ON "APP"."GET_ALL_APPOINTMENTS" TO "ROLE_KHACHHANG";
  GRANT EXECUTE ON "APP"."GET_ALL_APPOINTMENTS" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_ALL_APPOINTMENTS" TO "ROLE_TIEPTAN";
--------------------------------------------------------
--  DDL for Procedure GET_ALL_AUDIT_LOG
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_ALL_AUDIT_LOG" (
    p_cursor OUT SYS_REFCURSOR
) AS
BEGIN
    OPEN p_cursor FOR
    SELECT 
        LOG_ID,
        EVENT_TS,
        DB_USER,
        OS_USER,
        MACHINE,
        MODULE,
        APP_ROLE,
        EMP_ID,
        CUSTOMER_PHONE,
        OBJECT_NAME,
        NOTE,
        DML_TYPE,          -- INSERT / UPDATE / DELETE
        CHANGED_COLUMNS,   -- Các cột bị thay đổi
        OLD_VALUES,        -- JSON giá trị cũ
        NEW_VALUES         -- JSON giá trị mới
    FROM AUDIT_ALERT_LOG
    ORDER BY EVENT_TS DESC;
END GET_ALL_AUDIT_LOG;

/

  GRANT EXECUTE ON "APP"."GET_ALL_AUDIT_LOG" TO "ADMIN";
  GRANT EXECUTE ON "APP"."GET_ALL_AUDIT_LOG" TO "ROLE_ADMIN";
--------------------------------------------------------
--  DDL for Procedure GET_ALL_AUDIT_PROJECT
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_ALL_AUDIT_PROJECT" (
    p_cursor OUT SYS_REFCURSOR
) AS
BEGIN
    OPEN p_cursor FOR
    SELECT timestamp AS event_ts,
           username AS db_user,
           owner AS object_schema,
           obj_name AS object_name,
           action_name AS action,
           sql_text AS note
    FROM DBA_AUDIT_TRAIL
    WHERE obj_name IN (
        'EMPLOYEE','CUSTOMER','ORDERS','STOCK_IN','STOCK_IN_ITEM',
        'PART','STOCK_OUT','STOCK_OUT_ITEM','PART_REQUEST','PART_REQUEST_ITEM',
        'USER_OTP_LOG','EMPLOYEE_SHIFT','CUSTOMER_APPOINTMENT','INVOICE',
        'INVOICE_ITEM','SERVICE','ORDER_SERVICE','INVOICE_SERVICE'
    )
    ORDER BY timestamp DESC;
END get_all_audit_project;

/

  GRANT EXECUTE ON "APP"."GET_ALL_AUDIT_PROJECT" TO "ADMIN";
  GRANT EXECUTE ON "APP"."GET_ALL_AUDIT_PROJECT" TO "ROLE_ADMIN";
--------------------------------------------------------
--  DDL for Procedure GET_ALL_CUSTOMERS
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_ALL_CUSTOMERS" (
    p_cursor OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN p_cursor FOR
        SELECT c.PHONE,
               c.FULL_NAME,
               c.EMAIL,
               -- Lấy trạng thái từ DBA_USERS
               (SELECT ACCOUNT_STATUS 
                FROM DBA_USERS d 
                WHERE d.USERNAME = UPPER(c.PHONE)) AS STATUS,
               -- Lấy role gộp thành 1 chuỗi
               (SELECT LISTAGG(GRANTED_ROLE, ', ') WITHIN GROUP (ORDER BY GRANTED_ROLE)
                FROM DBA_ROLE_PRIVS r
                WHERE r.GRANTEE = UPPER(c.PHONE)) AS ROLES
        FROM APP.CUSTOMER c
        ORDER BY c.PHONE;
END;

/

  GRANT EXECUTE ON "APP"."GET_ALL_CUSTOMERS" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_ALL_CUSTOMERS" TO "ROLE_TIEPTAN";
  GRANT EXECUTE ON "APP"."GET_ALL_CUSTOMERS" TO "ROLE_THUKHO";
  GRANT EXECUTE ON "APP"."GET_ALL_CUSTOMERS" TO "ROLE_KITHUATVIEN";
  GRANT EXECUTE ON "APP"."GET_ALL_CUSTOMERS" TO "ROLE_KHACHHANG";
--------------------------------------------------------
--  DDL for Procedure GET_ALL_EMPLOYEES
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_ALL_EMPLOYEES" (
    p_cursor OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN p_cursor FOR
        SELECT e.EMP_ID,
               e.FULL_NAME,
               e.USERNAME,
               e.EMAIL,
               e.PHONE,
               -- Lấy trạng thái từ DBA_USERS
               (SELECT ACCOUNT_STATUS 
                FROM DBA_USERS d 
                WHERE d.USERNAME = UPPER(e.USERNAME)) AS STATUS,
               -- Lấy role gộp thành 1 chuỗi
               (SELECT LISTAGG(GRANTED_ROLE, ', ') WITHIN GROUP (ORDER BY GRANTED_ROLE)
                FROM DBA_ROLE_PRIVS r
                WHERE r.GRANTEE = UPPER(e.USERNAME)) AS ROLES
        FROM APP.EMPLOYEE e
        ORDER BY e.EMP_ID;
END;

/

  GRANT EXECUTE ON "APP"."GET_ALL_EMPLOYEES" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_ALL_EMPLOYEES" TO "ROLE_TIEPTAN";
  GRANT EXECUTE ON "APP"."GET_ALL_EMPLOYEES" TO "THUKHO";
  GRANT EXECUTE ON "APP"."GET_ALL_EMPLOYEES" TO "ROLE_KITHUATVIEN";
--------------------------------------------------------
--  DDL for Procedure GET_ALL_EXPORTS
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_ALL_EXPORTS" (
    cur_out OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN cur_out FOR
    SELECT si.STOCKOUT_ID,
           e.USERNAME AS EmpUsername,
           si.OUT_DATE,
           si.NOTE
    FROM APP.STOCK_OUT si
    JOIN APP.EMPLOYEE e ON si.EMP_ID = e.EMP_ID
    ORDER BY si.STOCKOUT_ID DESC;
END GET_ALL_EXPORTS;

/

  GRANT EXECUTE ON "APP"."GET_ALL_EXPORTS" TO "ROLE_THUKHO";
  GRANT EXECUTE ON "APP"."GET_ALL_EXPORTS" TO "ROLE_ADMIN";
--------------------------------------------------------
--  DDL for Procedure GET_ALL_IMPORTS
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_ALL_IMPORTS" (
    cur_out OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN cur_out FOR
    SELECT si.STOCKIN_ID,
           e.USERNAME AS EmpUsername,
           si.IN_DATE,
           si.NOTE
    FROM APP.STOCK_IN si
    JOIN APP.EMPLOYEE e ON si.EMP_ID = e.EMP_ID
    ORDER BY si.STOCKIN_ID DESC;
END GET_ALL_IMPORTS;

/

  GRANT EXECUTE ON "APP"."GET_ALL_IMPORTS" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_ALL_IMPORTS" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Procedure GET_ALL_INVOICES
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_ALL_INVOICES" (
    cur_out OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN cur_out FOR
    SELECT i.INVOICE_ID,
           i.STOCKOUT_ID,
           i.CUSTOMER_PHONE,
           e.USERNAME AS EmpUsername,
           i.INVOICE_DATE,
           i.TOTAL_AMOUNT,
           i.STATUS
    FROM APP.INVOICE i
    LEFT JOIN APP.EMPLOYEE e ON i.EMP_ID = e.EMP_ID
    ORDER BY i.INVOICE_DATE DESC;
END GET_ALL_INVOICES;


/

  GRANT EXECUTE ON "APP"."GET_ALL_INVOICES" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_ALL_INVOICES" TO "ROLE_TIEPTAN";
  GRANT EXECUTE ON "APP"."GET_ALL_INVOICES" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Procedure GET_ALL_ORDERS
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_ALL_ORDERS" (
    cur_out OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN cur_out FOR
    SELECT 
        o.ORDER_ID,
        o.CUSTOMER_PHONE,
        recv.USERNAME AS ReceiverEmpName,
        hand.USERNAME AS HandlerEmpName,
        o.ORDER_TYPE,
        o.RECEIVED_DATE,
        o.STATUS,
        o.DESCRIPTION
    FROM ORDERS o
    LEFT JOIN EMPLOYEE recv ON o.RECEIVER_EMP = recv.EMP_ID
    LEFT JOIN EMPLOYEE hand ON o.HANDLER_EMP = hand.EMP_ID
    ORDER BY o.RECEIVED_DATE DESC;
END GET_ALL_ORDERS;

/

  GRANT EXECUTE ON "APP"."GET_ALL_ORDERS" TO "ROLE_KHACHHANG";
  GRANT EXECUTE ON "APP"."GET_ALL_ORDERS" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_ALL_ORDERS" TO "ROLE_TIEPTAN";
  GRANT EXECUTE ON "APP"."GET_ALL_ORDERS" TO "ROLE_KITHUATVIEN";
--------------------------------------------------------
--  DDL for Procedure GET_ALL_PART
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_ALL_PART" (
    p_cursor OUT SYS_REFCURSOR
)
IS
BEGIN
    OPEN p_cursor FOR
        SELECT
            PART_ID,
            NAME,
            MANUFACTURER,
            SERIAL,
            STATUS,
            STOCK_IN_ID,
            ORDER_ID,
            PRICE
        FROM
            PART
        ORDER BY PART_ID;
END get_all_part;

/

  GRANT EXECUTE ON "APP"."GET_ALL_PART" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_ALL_PART" TO "ROLE_THUKHO";
  GRANT EXECUTE ON "APP"."GET_ALL_PART" TO "ROLE_KITHUATVIEN";
--------------------------------------------------------
--  DDL for Procedure GET_ALL_PART_IN_STOCK
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_ALL_PART_IN_STOCK" (
    p_cursor OUT SYS_REFCURSOR
)
IS
BEGIN
    OPEN p_cursor FOR
        SELECT
            PART_ID,
            NAME,
            MANUFACTURER,
            SERIAL,
            STATUS,
            STOCK_IN_ID,
            ORDER_ID,
            PRICE
        FROM
            PART
        WHERE
            STATUS = 'Trong kho';
END GET_ALL_PART_IN_STOCK;

/

  GRANT EXECUTE ON "APP"."GET_ALL_PART_IN_STOCK" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_ALL_PART_IN_STOCK" TO "ROLE_THUKHO";
  GRANT EXECUTE ON "APP"."GET_ALL_PART_IN_STOCK" TO "ROLE_KITHUATVIEN";
--------------------------------------------------------
--  DDL for Procedure GET_ALL_PART_REQUESTS
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_ALL_PART_REQUESTS" (
    cur_out OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN cur_out FOR
    SELECT 
        pr.REQUEST_ID,
        pr.ORDER_ID,
        pr.EMP_ID,
        e.USERNAME AS EmpUsername,
        pr.REQUEST_DATE,
        pr.STATUS
    FROM PART_REQUEST pr
    LEFT JOIN EMPLOYEE e ON pr.EMP_ID = e.EMP_ID
    ORDER BY pr.REQUEST_DATE DESC;
END GET_ALL_PART_REQUESTS;

/

  GRANT EXECUTE ON "APP"."GET_ALL_PART_REQUESTS" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_ALL_PART_REQUESTS" TO "KITHUATVIEN";
  GRANT EXECUTE ON "APP"."GET_ALL_PART_REQUESTS" TO "ROLE_THUKHO";
  GRANT EXECUTE ON "APP"."GET_ALL_PART_REQUESTS" TO "ROLE_KITHUATVIEN";
--------------------------------------------------------
--  DDL for Procedure GET_ALL_PROFILES_WITH_LIMITS
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_ALL_PROFILES_WITH_LIMITS" (
    cur_out OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN cur_out FOR
        SELECT PROFILE,
               RESOURCE_NAME,
               LIMIT
        FROM DBA_PROFILES
        WHERE RESOURCE_NAME IN ('IDLE_TIME','CONNECT_TIME','FAILED_LOGIN_ATTEMPTS','PASSWORD_LOCK_TIME','INACTIVE_ACCOUNT_TIME')
        ORDER BY PROFILE, RESOURCE_NAME;
END GET_ALL_PROFILES_WITH_LIMITS;


/

  GRANT EXECUTE ON "APP"."GET_ALL_PROFILES_WITH_LIMITS" TO "ROLE_ADMIN";
--------------------------------------------------------
--  DDL for Procedure GET_ALL_ROLES
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_ALL_ROLES" (p_cursor OUT SYS_REFCURSOR)
AS
BEGIN
    OPEN p_cursor FOR
        SELECT ROLE FROM DBA_ROLES;
END;

/

  GRANT EXECUTE ON "APP"."GET_ALL_ROLES" TO "ROLE_ADMIN";
--------------------------------------------------------
--  DDL for Procedure GET_ALL_SERVICES
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_ALL_SERVICES" (
    p_service_cursor OUT SYS_REFCURSOR -- Khai báo tham số OUT là REF CURSOR
)
AS
BEGIN
    -- Mở con trỏ và thực hiện câu lệnh SELECT
    OPEN p_service_cursor FOR
        SELECT 
            service_id,
            name, 
            description, 
            price
        FROM 
            SERVICE
        ORDER BY 
            service_id;
END GET_ALL_SERVICES;

/

  GRANT EXECUTE ON "APP"."GET_ALL_SERVICES" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_ALL_SERVICES" TO "ROLE_TIEPTAN";
  GRANT EXECUTE ON "APP"."GET_ALL_SERVICES" TO "ROLE_KITHUATVIEN";
--------------------------------------------------------
--  DDL for Procedure GET_ALL_USERS
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_ALL_USERS" (p_cursor OUT SYS_REFCURSOR)
AS
BEGIN
    OPEN p_cursor FOR
        SELECT USERNAME FROM DBA_USERS;
END;

/

  GRANT EXECUTE ON "APP"."GET_ALL_USERS" TO "ROLE_ADMIN";
--------------------------------------------------------
--  DDL for Procedure GET_ALL_USERS_WITH_PROFILE
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_ALL_USERS_WITH_PROFILE" (
    cur_out OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN cur_out FOR
        SELECT USERNAME, PROFILE
        FROM DBA_USERS
        ORDER BY PROFILE, USERNAME;
END GET_ALL_USERS_WITH_PROFILE;

/

  GRANT EXECUTE ON "APP"."GET_ALL_USERS_WITH_PROFILE" TO "ROLE_ADMIN";
--------------------------------------------------------
--  DDL for Procedure GET_BY_ORDER_TYPE
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_BY_ORDER_TYPE" (
    p_order_type IN VARCHAR2,
    cur_out OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN cur_out FOR
    SELECT 
        o.ORDER_ID,
        o.CUSTOMER_PHONE,
        recv.USERNAME AS ReceiverEmpName,
        hand.USERNAME AS HandlerEmpName,
        o.ORDER_TYPE,
        o.RECEIVED_DATE,
        o.STATUS,
        o.DESCRIPTION
    FROM ORDERS o
    LEFT JOIN EMPLOYEE recv ON o.RECEIVER_EMP = recv.EMP_ID
    LEFT JOIN EMPLOYEE hand ON o.HANDLER_EMP = hand.EMP_ID
    WHERE o.ORDER_TYPE = p_order_type
    ORDER BY o.RECEIVED_DATE DESC;
END GET_BY_ORDER_TYPE;

/

  GRANT EXECUTE ON "APP"."GET_BY_ORDER_TYPE" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_BY_ORDER_TYPE" TO "ROLE_TIEPTAN";
  GRANT EXECUTE ON "APP"."GET_BY_ORDER_TYPE" TO "ROLE_KITHUATVIEN";
--------------------------------------------------------
--  DDL for Procedure GET_EMPLOYEE_BY_ID
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_EMPLOYEE_BY_ID" (
    p_empid  IN  NUMBER,
    p_cursor OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN p_cursor FOR
        SELECT e.EMP_ID,
               e.FULL_NAME,
               e.USERNAME,
               e.EMAIL,
               e.PHONE,
               -- Lấy trạng thái từ DBA_USERS
               (SELECT d.ACCOUNT_STATUS
                FROM DBA_USERS d
                WHERE d.USERNAME = UPPER(e.USERNAME)) AS STATUS
        FROM APP.EMPLOYEE e
        WHERE e.EMP_ID = p_empid;
END;

/

  GRANT EXECUTE ON "APP"."GET_EMPLOYEE_BY_ID" TO "ROLE_ADMIN";
--------------------------------------------------------
--  DDL for Procedure GET_EMPLOYEE_ID_BY_USERNAME
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_EMPLOYEE_ID_BY_USERNAME" (
    p_username IN  VARCHAR2,
    p_emp_id  OUT NUMBER
)
AS
BEGIN
    SELECT EMP_ID
      INTO p_emp_id
      FROM APP.EMPLOYEE
     WHERE USERNAME = p_username;
EXCEPTION
    WHEN NO_DATA_FOUND THEN
        RAISE_APPLICATION_ERROR(-20001, 'Username không tồn tại: ' || p_username);
    WHEN TOO_MANY_ROWS THEN
        RAISE_APPLICATION_ERROR(-20002, 'Có nhiều hơn một user trùng username: ' || p_username);
END GET_EMPLOYEE_ID_BY_USERNAME;

/

  GRANT EXECUTE ON "APP"."GET_EMPLOYEE_ID_BY_USERNAME" TO "ROLE_KITHUATVIEN";
  GRANT EXECUTE ON "APP"."GET_EMPLOYEE_ID_BY_USERNAME" TO "ROLE_TIEPTAN";
  GRANT EXECUTE ON "APP"."GET_EMPLOYEE_ID_BY_USERNAME" TO "ROLE_THUKHO";
  GRANT EXECUTE ON "APP"."GET_EMPLOYEE_ID_BY_USERNAME" TO "ROLE_ADMIN";
--------------------------------------------------------
--  DDL for Procedure GET_EMPLOYEE_NAME_BY_ID
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_EMPLOYEE_NAME_BY_ID" (
    p_empid IN NUMBER,
    p_emp_name OUT VARCHAR2
)
AS
BEGIN
    SELECT USERNAME
      INTO p_emp_name
      FROM APP.EMPLOYEE
     WHERE EMP_ID = p_empid;
EXCEPTION
    WHEN NO_DATA_FOUND THEN
        p_emp_name := 'Unknown';
    WHEN TOO_MANY_ROWS THEN
        p_emp_name := 'Multiple Employees';
END GET_EMPLOYEE_NAME_BY_ID;

/

  GRANT EXECUTE ON "APP"."GET_EMPLOYEE_NAME_BY_ID" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_EMPLOYEE_NAME_BY_ID" TO "ROLE_TIEPTAN";
  GRANT EXECUTE ON "APP"."GET_EMPLOYEE_NAME_BY_ID" TO "ROLE_KITHUATVIEN";
--------------------------------------------------------
--  DDL for Procedure GET_EMPLOYEE_PUBLIC_KEY
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_EMPLOYEE_PUBLIC_KEY" (
    p_emp_id    IN  NUMBER,
    p_pub_key   OUT CLOB
) AS
BEGIN
    SELECT PUBLIC_KEY
    INTO p_pub_key
    FROM APP.EMPLOYEE
    WHERE EMP_ID = p_emp_id;

EXCEPTION
    WHEN NO_DATA_FOUND THEN
        p_pub_key := NULL;
END GET_EMPLOYEE_PUBLIC_KEY;

/

  GRANT EXECUTE ON "APP"."GET_EMPLOYEE_PUBLIC_KEY" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_EMPLOYEE_PUBLIC_KEY" TO "ROLE_THUKHO";
  GRANT EXECUTE ON "APP"."GET_EMPLOYEE_PUBLIC_KEY" TO "ROLE_TIEPTAN";
--------------------------------------------------------
--  DDL for Procedure GET_EMP_ID_FROM_INVOICE
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_EMP_ID_FROM_INVOICE" (
    p_invoice_id  IN  NUMBER,
    p_emp_id      OUT NUMBER
) AS
BEGIN
    SELECT EMP_ID
    INTO p_emp_id
    FROM APP.INVOICE
    WHERE INVOICE_ID = p_invoice_id;

EXCEPTION
    WHEN NO_DATA_FOUND THEN
        p_emp_id := NULL;
END GET_EMP_ID_FROM_INVOICE;


/

  GRANT EXECUTE ON "APP"."GET_EMP_ID_FROM_INVOICE" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_EMP_ID_FROM_INVOICE" TO "ROLE_TIEPTAN";
  GRANT EXECUTE ON "APP"."GET_EMP_ID_FROM_INVOICE" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Procedure GET_EMP_ID_FROM_STOCKIN
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_EMP_ID_FROM_STOCKIN" (
    p_stockin_id  IN  NUMBER,
    p_emp_id      OUT NUMBER
) AS
BEGIN
    SELECT EMP_ID
    INTO p_emp_id
    FROM APP.STOCK_IN
    WHERE STOCKIN_ID = p_stockin_id;

EXCEPTION
    WHEN NO_DATA_FOUND THEN
        p_emp_id := NULL;
END GET_EMP_ID_FROM_STOCKIN;

/

  GRANT EXECUTE ON "APP"."GET_EMP_ID_FROM_STOCKIN" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_EMP_ID_FROM_STOCKIN" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Procedure GET_EMP_ID_FROM_STOCKOUT
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_EMP_ID_FROM_STOCKOUT" (
    p_stockout_id IN NUMBER,
    p_emp_id      OUT NUMBER
)
AS
BEGIN
    SELECT EMP_ID
    INTO p_emp_id
    FROM APP.STOCK_OUT
    WHERE STOCKOUT_ID = p_stockout_id;

EXCEPTION
    WHEN NO_DATA_FOUND THEN
        p_emp_id := NULL; -- Trả về NULL nếu không tìm thấy ID
END GET_EMP_ID_FROM_STOCKOUT;

/

  GRANT EXECUTE ON "APP"."GET_EMP_ID_FROM_STOCKOUT" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_EMP_ID_FROM_STOCKOUT" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Procedure GET_ENABLED_TRIGGERS_COUNT
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_ENABLED_TRIGGERS_COUNT" (
    p_count OUT NUMBER
)
AS
BEGIN
    SELECT COUNT(*)
    INTO p_count
    FROM user_triggers
    WHERE trigger_name IN (
        'TRG_AUDIT_CUSTOMER_APPOINTMENT',
        'TRG_AUDIT_CUSTOMER',
        'TRG_AUDIT_EMPLOYEE',
        'TRG_AUDIT_INVOICE',
        'TRG_AUDIT_INVOICE_ITEM',
        'TRG_AUDIT_ORDERS',
        'TRG_AUDIT_PART',
        'TRG_AUDIT_PART_REQUEST',
        'TRG_AUDIT_STOCK_IN',
        'TRG_AUDIT_STOCK_IN_ITEM',
        'TRG_AUDIT_STOCK_OUT',
        'TRG_AUDIT_STOCK_OUT_ITEM'
    )
    AND status = 'ENABLED';
END;

/

  GRANT EXECUTE ON "APP"."GET_ENABLED_TRIGGERS_COUNT" TO "ADMIN";
--------------------------------------------------------
--  DDL for Procedure GET_EXPORT_BY_ID
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_EXPORT_BY_ID" (
    p_stockout_id IN NUMBER,
    cur_out OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN cur_out FOR
        SELECT  
            -- Thông tin Header (Phiếu xuất kho)
            so.STOCKOUT_ID      AS "StockOutId",
            e.FULL_NAME         AS "EmpUsername", -- Đổi từ Username sang Name
            so.OUT_DATE         AS "OutDate",
            so.NOTE             AS "Note",
            p.NAME              AS "PartName", 
            p.MANUFACTURER      AS "Manufacturer",
            p.SERIAL            AS "Serial",
            NVL(p.PRICE, 0)     AS "Price" -- Lấy giá từ bảng PART
        FROM 
            APP.STOCK_OUT so
        JOIN 
            APP.EMPLOYEE e 
            ON so.EMP_ID = e.EMP_ID
        JOIN 
            APP.STOCK_OUT_ITEM soi -- Bảng liên kết
            ON so.STOCKOUT_ID = soi.STOCKOUT_ID
        JOIN 
            APP.PART p             -- Bảng chi tiết linh kiện
            ON soi.PART_ID = p.PART_ID
        WHERE 
            so.STOCKOUT_ID = p_stockout_id;
END GET_EXPORT_BY_ID;

/

  GRANT EXECUTE ON "APP"."GET_EXPORT_BY_ID" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_EXPORT_BY_ID" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Procedure GET_IMPORT_BY_ID
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_IMPORT_BY_ID" (
    p_stockin_id IN NUMBER,
    cur_out OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN cur_out FOR
    SELECT 
        si.STOCKIN_ID       AS "StockInId",
        e.FULL_NAME         AS "EmpUsername",
        si.IN_DATE          AS "InDate",
        si.NOTE             AS "Note",
        sii.PART_NAME       AS "PartName",
        sii.MANUFACTURER    AS "Manufacturer",
        sii.SERIAL          AS "Serial",
        NVL(sii.PRICE, 0)  AS "Price"
    FROM APP.STOCK_IN si
    LEFT JOIN APP.STOCK_IN_ITEM sii 
        ON si.STOCKIN_ID = sii.STOCKIN_ID
    LEFT JOIN APP.EMPLOYEE e
        ON si.EMP_ID = e.EMP_ID
    WHERE si.STOCKIN_ID = p_stockin_id;
END GET_IMPORT_BY_ID;

/

  GRANT EXECUTE ON "APP"."GET_IMPORT_BY_ID" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_IMPORT_BY_ID" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Procedure GET_INVOICE_BY_ID
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_INVOICE_BY_ID" (
    p_invoice_id IN NUMBER,
    cur_out OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN cur_out FOR
    SELECT 
        -- Thông tin Invoice header
        i.INVOICE_ID       AS "InvoiceId",
        i.STOCKOUT_ID      AS "StockOutId",
        i.CUSTOMER_PHONE   AS "CustomerPhone",
        e.FULL_NAME        AS "EmpUsername",
        i.INVOICE_DATE     AS "InvoiceDate",
        i.TOTAL_AMOUNT     AS "TotalAmount",
        i.STATUS           AS "Status",
        -- Thông tin Items (Parts)
        ii.PART_ID         AS "PartId",
        p.NAME             AS "PartName",
        p.MANUFACTURER     AS "Manufacturer",
        p.SERIAL           AS "Serial",
        ii.PRICE           AS "ItemPrice",
        NULL               AS "ServiceId",
        NULL               AS "ServiceName",
        NULL               AS "Quantity",
        NULL               AS "ServicePrice",
        'ITEM'             AS "ItemType"
    FROM APP.INVOICE i
    LEFT JOIN APP.EMPLOYEE e ON i.EMP_ID = e.EMP_ID
    LEFT JOIN APP.INVOICE_ITEM ii ON i.INVOICE_ID = ii.INVOICE_ID
    LEFT JOIN APP.PART p ON ii.PART_ID = p.PART_ID
    WHERE i.INVOICE_ID = p_invoice_id

    UNION ALL

    SELECT 
        -- Thông tin Invoice header (lặp lại cho services)
        i.INVOICE_ID       AS "InvoiceId",
        i.STOCKOUT_ID      AS "StockOutId",
        i.CUSTOMER_PHONE   AS "CustomerPhone",
        e.FULL_NAME        AS "EmpUsername",
        i.INVOICE_DATE     AS "InvoiceDate",
        i.TOTAL_AMOUNT     AS "TotalAmount",
        i.STATUS           AS "Status",
        -- Thông tin Services
        NULL               AS "PartId",
        NULL               AS "PartName",
        NULL               AS "Manufacturer",
        NULL               AS "Serial",
        NULL               AS "ItemPrice",
        isv.SERVICE_ID     AS "ServiceId",
        s.NAME             AS "ServiceName",
        isv.QUANTITY       AS "Quantity",
        isv.PRICE          AS "ServicePrice",
        'SERVICE'          AS "ItemType"
    FROM APP.INVOICE i
    LEFT JOIN APP.EMPLOYEE e ON i.EMP_ID = e.EMP_ID
    LEFT JOIN APP.INVOICE_SERVICE isv ON i.INVOICE_ID = isv.INVOICE_ID
    LEFT JOIN APP.SERVICE s ON isv.SERVICE_ID = s.SERVICE_ID
    WHERE i.INVOICE_ID = p_invoice_id
    ORDER BY "ItemType", "PartId", "ServiceId";
END GET_INVOICE_BY_ID;


/

  GRANT EXECUTE ON "APP"."GET_INVOICE_BY_ID" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_INVOICE_BY_ID" TO "ROLE_THUKHO";
  GRANT EXECUTE ON "APP"."GET_INVOICE_BY_ID" TO "ROLE_TIEPTAN";
--------------------------------------------------------
--  DDL for Procedure GET_INVOICE_PDF
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_INVOICE_PDF" (
    p_invoice_id IN NUMBER,
    p_pdf OUT BLOB
)
AS
BEGIN
    SELECT PDF
    INTO p_pdf
    FROM APP.INVOICE
    WHERE INVOICE_ID = p_invoice_id;
EXCEPTION
    WHEN NO_DATA_FOUND THEN
        p_pdf := NULL;
    WHEN OTHERS THEN
        RAISE;
END GET_INVOICE_PDF;


/

  GRANT EXECUTE ON "APP"."GET_INVOICE_PDF" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_INVOICE_PDF" TO "ROLE_THUKHO";
  GRANT EXECUTE ON "APP"."GET_INVOICE_PDF" TO "ROLE_TIEPTAN";
--------------------------------------------------------
--  DDL for Procedure GET_INVOICE_SIGNATURE
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_INVOICE_SIGNATURE" (
    p_invoice_id   IN  NUMBER,
    p_signature    OUT CLOB
) AS
BEGIN
    SELECT SIGNATURE
    INTO p_signature
    FROM APP.INVOICE
    WHERE INVOICE_ID = p_invoice_id;

EXCEPTION
    WHEN NO_DATA_FOUND THEN
        p_signature := NULL;
END GET_INVOICE_SIGNATURE;


/

  GRANT EXECUTE ON "APP"."GET_INVOICE_SIGNATURE" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_INVOICE_SIGNATURE" TO "ROLE_THUKHO";
  GRANT EXECUTE ON "APP"."GET_INVOICE_SIGNATURE" TO "ROLE_TIEPTAN";
--------------------------------------------------------
--  DDL for Procedure GET_OBJ_AUDIT_COUNT
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_OBJ_AUDIT_COUNT" (
    p_count OUT NUMBER
)
AS
BEGIN
    SELECT COUNT(*) INTO p_count FROM DBA_OBJ_AUDIT_OPTS WHERE object_name IN ( 'EMPLOYEE','CUSTOMER','ORDERS','STOCK_IN','STOCK_IN_ITEM', 'PART','STOCK_OUT','STOCK_OUT_ITEM','PART_REQUEST','PART_REQUEST_ITEM', 'USER_OTP_LOG','EMPLOYEE_SHIFT','CUSTOMER_APPOINTMENT','INVOICE', 'INVOICE_ITEM','SERVICE','ORDER_SERVICE','INVOICE_SERVICE' );
END;

/

  GRANT EXECUTE ON "APP"."GET_OBJ_AUDIT_COUNT" TO "ADMIN";
--------------------------------------------------------
--  DDL for Procedure GET_ORDER_BY_ID
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_ORDER_BY_ID" (
    p_order_id IN ORDERS.ORDER_ID%TYPE,
    cur_out OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN cur_out FOR
    SELECT 
        o.ORDER_ID,
        o.CUSTOMER_PHONE,
        recv.USERNAME AS ReceiverEmpName,
        hand.USERNAME AS HandlerEmpName,
        o.ORDER_TYPE,
        o.RECEIVED_DATE,
        o.STATUS,
        o.DESCRIPTION
    FROM ORDERS o
    LEFT JOIN EMPLOYEE recv ON o.RECEIVER_EMP = recv.EMP_ID
    LEFT JOIN EMPLOYEE hand ON o.HANDLER_EMP = hand.EMP_ID
    WHERE o.ORDER_ID = p_order_id;
END GET_ORDER_BY_ID;

/

  GRANT EXECUTE ON "APP"."GET_ORDER_BY_ID" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_ORDER_BY_ID" TO "ROLE_TIEPTAN";
  GRANT EXECUTE ON "APP"."GET_ORDER_BY_ID" TO "ROLE_KITHUATVIEN";
  GRANT EXECUTE ON "APP"."GET_ORDER_BY_ID" TO "ROLE_KHACHHANG";
--------------------------------------------------------
--  DDL for Procedure GET_PART_BY_ORDERID
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_PART_BY_ORDERID" (
    p_order_id IN PART.ORDER_ID%TYPE,
    p_cursor OUT SYS_REFCURSOR
)
IS
BEGIN
    OPEN p_cursor FOR
        SELECT
            PART_ID,
            NAME,
            MANUFACTURER,
            SERIAL,
            STATUS,
            STOCK_IN_ID,
            ORDER_ID,
            PRICE 
        FROM
            PART
        WHERE
            ORDER_ID = p_order_id;
END get_part_by_orderId;


/

  GRANT EXECUTE ON "APP"."GET_PART_BY_ORDERID" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_PART_BY_ORDERID" TO "ROLE_THUKHO";
  GRANT EXECUTE ON "APP"."GET_PART_BY_ORDERID" TO "ROLE_KITHUATVIEN";
--------------------------------------------------------
--  DDL for Procedure GET_PART_BY_PARTREQUEST
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_PART_BY_PARTREQUEST" (
    p_order_id IN PART_REQUEST.ORDER_ID%TYPE,
    p_cursor OUT SYS_REFCURSOR
)
IS
BEGIN
    OPEN p_cursor FOR
        SELECT
            p.PART_ID,
            p.NAME,
            p.MANUFACTURER,
            p.SERIAL,
            p.STATUS,
            p.STOCK_IN_ID,
            p.ORDER_ID,
            p.PRICE,
            pri.REQUEST_ID,
            pr.REQUEST_DATE,
            pr.STATUS AS REQUEST_STATUS
        FROM
            PART p
        INNER JOIN PART_REQUEST_ITEM pri ON p.PART_ID = pri.PART_ID
        INNER JOIN PART_REQUEST pr ON pri.REQUEST_ID = pr.REQUEST_ID
        WHERE
            pr.ORDER_ID = p_order_id;
END GET_PART_BY_PARTREQUEST;


/

  GRANT EXECUTE ON "APP"."GET_PART_BY_PARTREQUEST" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_PART_BY_PARTREQUEST" TO "ROLE_THUKHO";
  GRANT EXECUTE ON "APP"."GET_PART_BY_PARTREQUEST" TO "ROLE_KITHUATVIEN";
--------------------------------------------------------
--  DDL for Procedure GET_PART_BY_REQUEST_ID
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_PART_BY_REQUEST_ID" (
    p_request_id IN PART_REQUEST.REQUEST_ID%TYPE,
    p_cursor OUT SYS_REFCURSOR
)
IS
BEGIN
    OPEN p_cursor FOR
        SELECT
            p.PART_ID,
            p.NAME,
            p.MANUFACTURER,
            p.SERIAL,
            p.STATUS,
            p.STOCK_IN_ID,
            p.ORDER_ID,
            p.PRICE,
            pri.REQUEST_ID,
            pr.REQUEST_DATE,
            pr.STATUS AS REQUEST_STATUS
        FROM
            PART p
        INNER JOIN PART_REQUEST_ITEM pri ON p.PART_ID = pri.PART_ID
        INNER JOIN PART_REQUEST pr ON pri.REQUEST_ID = pr.REQUEST_ID
        WHERE
            pr.REQUEST_ID = p_request_id;
END GET_PART_BY_REQUEST_ID;


/

  GRANT EXECUTE ON "APP"."GET_PART_BY_REQUEST_ID" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_PART_BY_REQUEST_ID" TO "ROLE_THUKHO";
  GRANT EXECUTE ON "APP"."GET_PART_BY_REQUEST_ID" TO "ROLE_KITHUATVIEN";
--------------------------------------------------------
--  DDL for Procedure GET_PART_BY_SERIAL
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_PART_BY_SERIAL" (
    p_serial IN PART.SERIAL%TYPE,
    p_cursor OUT SYS_REFCURSOR
)
IS
BEGIN
    OPEN p_cursor FOR
        SELECT
            PART_ID,
            NAME,
            MANUFACTURER,
            SERIAL,
            STATUS,
            STOCK_IN_ID,
            ORDER_ID,
            PRICE
        FROM
            PART
        WHERE
            SERIAL = p_serial;
END get_part_by_serial;

/

  GRANT EXECUTE ON "APP"."GET_PART_BY_SERIAL" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_PART_BY_SERIAL" TO "ROLE_THUKHO";
  GRANT EXECUTE ON "APP"."GET_PART_BY_SERIAL" TO "ROLE_KITHUATVIEN";
--------------------------------------------------------
--  DDL for Procedure GET_PART_BY_STATUS
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_PART_BY_STATUS" (
    p_status IN PART.STATUS%TYPE,
    p_cursor OUT SYS_REFCURSOR
)
IS
BEGIN
    OPEN p_cursor FOR
        SELECT
            PART_ID,
            NAME,
            MANUFACTURER,
            SERIAL,
            STATUS,
            STOCK_IN_ID,
            ORDER_ID,
            PRICE
        FROM
            PART
        WHERE
            STATUS = p_status;
END get_part_by_status;

/

  GRANT EXECUTE ON "APP"."GET_PART_BY_STATUS" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_PART_BY_STATUS" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Procedure GET_PART_BY_STOCK
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_PART_BY_STOCK" (
    p_stock_id IN PART.STOCK_IN_ID%TYPE,
    p_cursor OUT SYS_REFCURSOR
)
IS
BEGIN
    OPEN p_cursor FOR
        SELECT
            PART_ID,
            NAME,
            MANUFACTURER,
            SERIAL,
            STATUS,
            STOCK_IN_ID,
            ORDER_ID,
            PRICE
        FROM
            PART
        WHERE
            STOCK_IN_ID = p_stock_id;
END get_part_by_stock;

/

  GRANT EXECUTE ON "APP"."GET_PART_BY_STOCK" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_PART_BY_STOCK" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Procedure GET_PART_BY_STOCKINID
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_PART_BY_STOCKINID" (
    p_stockin_id IN PART.STOCK_IN_ID%TYPE,
    p_cursor OUT SYS_REFCURSOR
)
IS
BEGIN
    OPEN p_cursor FOR
        SELECT
            PART_ID,
            NAME,
            MANUFACTURER,
            SERIAL,
            STATUS,
            STOCK_IN_ID,
            ORDER_ID,
            PRICE
        FROM
            PART
        WHERE
            STOCK_IN_ID = p_stockin_id;
END get_part_by_stockinid;

/

  GRANT EXECUTE ON "APP"."GET_PART_BY_STOCKINID" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_PART_BY_STOCKINID" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Procedure GET_PROFILE_BY_NAME
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_PROFILE_BY_NAME" (
    p_profile_name IN VARCHAR2,
    cur_out OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN cur_out FOR
        SELECT PROFILE,
               RESOURCE_NAME,
               LIMIT
        FROM DBA_PROFILES
        WHERE PROFILE = UPPER(p_profile_name)
          AND RESOURCE_NAME IN ('IDLE_TIME','CONNECT_TIME','FAILED_LOGIN_ATTEMPTS','PASSWORD_LOCK_TIME','INACTIVE_ACCOUNT_TIME')
        ORDER BY RESOURCE_NAME;
END GET_PROFILE_BY_NAME;


/

  GRANT EXECUTE ON "APP"."GET_PROFILE_BY_NAME" TO "ROLE_ADMIN";
--------------------------------------------------------
--  DDL for Procedure GET_PUBLICKEY_BY_USERNAME
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_PUBLICKEY_BY_USERNAME" (
    p_username IN  VARCHAR2,
    p_public_key OUT CLOB
) AS
BEGIN
    SELECT PUBLIC_KEY
    INTO p_public_key
    FROM APP.EMPLOYEE
    WHERE USERNAME = p_username;

EXCEPTION
    WHEN NO_DATA_FOUND THEN
        p_public_key := NULL;
    WHEN TOO_MANY_ROWS THEN
        RAISE_APPLICATION_ERROR(-20002, 'Có nhiều hơn một employee trùng username: ' || p_username);
END GET_PUBLICKEY_BY_USERNAME;

/

  GRANT EXECUTE ON "APP"."GET_PUBLICKEY_BY_USERNAME" TO "ROLE_TIEPTAN";
  GRANT EXECUTE ON "APP"."GET_PUBLICKEY_BY_USERNAME" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_PUBLICKEY_BY_USERNAME" TO "ROLE_THUKHO";
  GRANT EXECUTE ON "APP"."GET_PUBLICKEY_BY_USERNAME" TO "ROLE_KITHUATVIEN";
--------------------------------------------------------
--  DDL for Procedure GET_ROLES_OF_USER
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_ROLES_OF_USER" (
    p_username IN VARCHAR2,
    p_cursor OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN p_cursor FOR
        SELECT GRANTED_ROLE
        FROM DBA_ROLE_PRIVS
        WHERE GRANTEE = UPPER(p_username);
END;

/

  GRANT EXECUTE ON "APP"."GET_ROLES_OF_USER" TO "ROLE_ADMIN";
--------------------------------------------------------
--  DDL for Procedure GET_SERVICES_BY_ORDER_ID
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_SERVICES_BY_ORDER_ID" (
    p_order_id       IN NUMBER,              -- Tham số đầu vào: ID của đơn hàng
    p_service_cursor OUT SYS_REFCURSOR      -- Tham số đầu ra: REF CURSOR chứa danh sách dịch vụ
)
AS
BEGIN
    -- Mở con trỏ và thực hiện câu lệnh SELECT JOIN
    OPEN p_service_cursor FOR
        SELECT 
            S.SERVICE_ID,
            S.NAME, 
            S.DESCRIPTION, 
            OS.QUANTITY,      -- Số lượng dịch vụ đã đặt
            OS.PRICE AS AGREED_PRICE -- Giá dịch vụ tại thời điểm đặt hàng (từ ORDER_SERVICE)
        FROM 
            SERVICE S
        JOIN
            ORDER_SERVICE OS ON S.SERVICE_ID = OS.SERVICE_ID
        WHERE 
            OS.ORDER_ID = p_order_id -- Lọc theo Order ID
        ORDER BY
            S.SERVICE_ID;
END GET_SERVICES_BY_ORDER_ID;

/

  GRANT EXECUTE ON "APP"."GET_SERVICES_BY_ORDER_ID" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_SERVICES_BY_ORDER_ID" TO "ROLE_TIEPTAN";
  GRANT EXECUTE ON "APP"."GET_SERVICES_BY_ORDER_ID" TO "ROLE_KITHUATVIEN";
--------------------------------------------------------
--  DDL for Procedure GET_STOCKIN_PDF
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_STOCKIN_PDF" (
    p_stockin_id IN NUMBER,
    p_pdf OUT BLOB
)
AS
BEGIN
    SELECT PDF
    INTO p_pdf
    FROM STOCK_IN
    WHERE STOCKIN_ID = p_stockin_id;
EXCEPTION
    WHEN NO_DATA_FOUND THEN
        p_pdf := NULL;
    WHEN OTHERS THEN
        RAISE;
END GET_STOCKIN_PDF;

/

  GRANT EXECUTE ON "APP"."GET_STOCKIN_PDF" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_STOCKIN_PDF" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Procedure GET_STOCKIN_SIGNATURE
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_STOCKIN_SIGNATURE" (
    p_stockin_id   IN  NUMBER,
    p_signature    OUT CLOB
) AS
BEGIN
    SELECT SIGNATURE
    INTO p_signature
    FROM APP.STOCK_IN
    WHERE STOCKIN_ID = p_stockin_id;

EXCEPTION
    WHEN NO_DATA_FOUND THEN
        p_signature := NULL;
END GET_STOCKIN_SIGNATURE;

/

  GRANT EXECUTE ON "APP"."GET_STOCKIN_SIGNATURE" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_STOCKIN_SIGNATURE" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Procedure GET_STOCKOUT_PDF
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_STOCKOUT_PDF" (
    p_stockout_id IN NUMBER,
    p_pdf OUT BLOB
)
AS
BEGIN
    SELECT PDF
    INTO p_pdf
    FROM STOCK_OUT
    WHERE STOCKOUT_ID = p_stockout_id;
EXCEPTION
    WHEN NO_DATA_FOUND THEN
        p_pdf := NULL;
    WHEN OTHERS THEN
        RAISE;
END GET_STOCKOUT_PDF;

/

  GRANT EXECUTE ON "APP"."GET_STOCKOUT_PDF" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_STOCKOUT_PDF" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Procedure GET_STOCKOUT_SIGNATURE
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_STOCKOUT_SIGNATURE" (
    p_stockout_id IN NUMBER,
    p_signature   OUT VARCHAR2 -- Hoặc CLOB nếu bạn thay đổi kiểu dữ liệu
)
AS
BEGIN
    SELECT SIGNATURE
    INTO p_signature
    FROM APP.STOCK_OUT
    WHERE STOCKOUT_ID = p_stockout_id;

EXCEPTION
    WHEN NO_DATA_FOUND THEN
        p_signature := NULL; -- Trả về NULL nếu không tìm thấy ID
END GET_STOCKOUT_SIGNATURE;

/

  GRANT EXECUTE ON "APP"."GET_STOCKOUT_SIGNATURE" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_STOCKOUT_SIGNATURE" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Procedure GET_UNFINISHED_ORDERS
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."GET_UNFINISHED_ORDERS" (
    cur_out OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN cur_out FOR
    SELECT 
        o.ORDER_ID,
        o.CUSTOMER_PHONE,
        recv.USERNAME AS ReceiverEmpName,
        hand.USERNAME AS HandlerEmpName,
        o.ORDER_TYPE,
        o.RECEIVED_DATE,
        o.STATUS,
        o.DESCRIPTION
    FROM ORDERS o
    LEFT JOIN EMPLOYEE recv ON o.RECEIVER_EMP = recv.EMP_ID
    LEFT JOIN EMPLOYEE hand ON o.HANDLER_EMP = hand.EMP_ID
    WHERE o.STATUS != 'Đã hoàn thành'
       OR o.STATUS IS NULL       -- phòng trường hợp giá trị rỗng
    ORDER BY o.RECEIVED_DATE DESC;
END GET_UNFINISHED_ORDERS;

/

  GRANT EXECUTE ON "APP"."GET_UNFINISHED_ORDERS" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_UNFINISHED_ORDERS" TO "ROLE_TIEPTAN";
  GRANT EXECUTE ON "APP"."GET_UNFINISHED_ORDERS" TO "ROLE_KITHUATVIEN";
--------------------------------------------------------
--  DDL for Procedure LOCK_DB_USER
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."LOCK_DB_USER" (
    p_username IN VARCHAR2
)
AS
BEGIN
    BEGIN
        EXECUTE IMMEDIATE 'ALTER USER "' || UPPER(p_username) || '" ACCOUNT LOCK';

    EXCEPTION
        WHEN OTHERS THEN
            RAISE_APPLICATION_ERROR(-20002, 'Không thể lock user ' || p_username || ': ' || SQLERRM);
    END;
END;

/

  GRANT EXECUTE ON "APP"."LOCK_DB_USER" TO "ROLE_ADMIN";
--------------------------------------------------------
--  DDL for Procedure LOGIN_CUSTOMER
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."LOGIN_CUSTOMER" (
    p_phone        IN  VARCHAR2,
    p_password     IN  VARCHAR2,
    p_out_phone    OUT VARCHAR2,
    p_out_result   OUT VARCHAR2
) AS
    PRAGMA AUTONOMOUS_TRANSACTION;

    v_hash       VARCHAR2(256);
    v_db_hash    VARCHAR2(256);
    v_fail_count NUMBER;
BEGIN
    v_hash := HASH_PASSWORD(p_password);

    BEGIN
        SELECT PASSWORD_HASH
        INTO v_db_hash
        FROM CUSTOMER
        WHERE PHONE = p_phone;
        p_out_phone := p_phone;

        IF v_db_hash = v_hash THEN
            p_out_result := 'SUCCESS';
        ELSE
            p_out_result := 'FAILED';
        END IF;

    EXCEPTION
        WHEN NO_DATA_FOUND THEN

            p_out_phone := NULL;
            
            p_out_result := 'FAILED';
    END;
END LOGIN_CUSTOMER;

/

  GRANT EXECUTE ON "APP"."LOGIN_CUSTOMER" TO "ROLE_KHACHHANG";
--------------------------------------------------------
--  DDL for Procedure LOGIN_EMPLOYEE
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."LOGIN_EMPLOYEE" (
    p_username     IN  VARCHAR2,
    p_password     IN  VARCHAR2,
    p_out_username OUT VARCHAR2,
    p_out_result   OUT VARCHAR2,
    p_out_role     OUT VARCHAR2
) AS
    PRAGMA AUTONOMOUS_TRANSACTION;

    v_hash       VARCHAR2(256);
    v_db_hash    VARCHAR2(256);
    v_status     VARCHAR2(30);
BEGIN
    v_hash := HASH_PASSWORD(p_password);

    BEGIN
        -- Lấy mật khẩu từ bảng EMPLOYEE
        SELECT PASSWORD_HASH
        INTO v_db_hash
        FROM EMPLOYEE
        WHERE USERNAME = p_username;
        p_out_username := p_username;
        -- Lấy trạng thái từ DBA_USERS
        BEGIN
            SELECT ACCOUNT_STATUS
            INTO v_status
            FROM DBA_USERS
            WHERE USERNAME = UPPER(p_username);
        EXCEPTION
            WHEN NO_DATA_FOUND THEN
                v_status := 'UNKNOWN';
        END;

        IF v_status LIKE 'LOCKED%' THEN
            p_out_result := 'ACCOUNT LOCKED';
            p_out_role := NULL;
            RETURN;
        END IF;

        IF v_db_hash = v_hash THEN
            p_out_result := 'SUCCESS';

            -- Lấy role của user
            BEGIN
                SELECT LISTAGG(GRANTED_ROLE, ', ') WITHIN GROUP (ORDER BY GRANTED_ROLE)
                INTO p_out_role
                FROM DBA_ROLE_PRIVS
                WHERE GRANTEE = UPPER(p_username);
            EXCEPTION
                WHEN NO_DATA_FOUND THEN
                    p_out_role := NULL;
            END;

        ELSE
            p_out_result := 'FAILED';
            p_out_role := NULL;
        END IF;

    EXCEPTION
        WHEN NO_DATA_FOUND THEN
            p_out_username := NULL;
            p_out_result := 'FAILED';
            p_out_role := NULL;
    END;
END LOGIN_EMPLOYEE;

/

  GRANT EXECUTE ON "APP"."LOGIN_EMPLOYEE" TO "ADMIN";
  GRANT EXECUTE ON "APP"."LOGIN_EMPLOYEE" TO "THUKHO";
  GRANT EXECUTE ON "APP"."LOGIN_EMPLOYEE" TO "KITHUATVIEN";
  GRANT EXECUTE ON "APP"."LOGIN_EMPLOYEE" TO "TIEPTAN";
  GRANT EXECUTE ON "APP"."LOGIN_EMPLOYEE" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."LOGIN_EMPLOYEE" TO "ROLE_KITHUATVIEN";
  GRANT EXECUTE ON "APP"."LOGIN_EMPLOYEE" TO "ROLE_TIEPTAN";
  GRANT EXECUTE ON "APP"."LOGIN_EMPLOYEE" TO "ROLE_THUKHO";
  GRANT EXECUTE ON "APP"."LOGIN_EMPLOYEE" TO "KTV02";
  GRANT EXECUTE ON "APP"."LOGIN_EMPLOYEE" TO "KTV03";
  GRANT EXECUTE ON "APP"."LOGIN_EMPLOYEE" TO "ADMINN";
  GRANT EXECUTE ON "APP"."LOGIN_EMPLOYEE" TO "ADMINNN";
--------------------------------------------------------
--  DDL for Procedure REGISTER_CUSTOMER
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."REGISTER_CUSTOMER" (
    p_phone     IN VARCHAR2,   -- dùng làm PK
    p_full_name IN VARCHAR2,
    p_password  IN VARCHAR2,
    p_email     IN VARCHAR2,
    p_address   IN VARCHAR2
)
AS
    v_hash VARCHAR2(256);
    v_pub  CLOB;
    v_priv CLOB;
    v_keys      CLOB;
    v_pwd VARCHAR2(20);
BEGIN
    -- Hash mật khẩu
    v_hash := HASH_PASSWORD(p_password);

    -- 2. Sinh cặp RSA
    v_keys := CRYPTO.RSA_GENERATE_KEYS(KEY_SIZE => 1024);

    -- 3. Tách public key (loại bỏ ****)
    v_pub := TRIM(
                SUBSTR(
                    v_keys,
                    INSTR(v_keys, 'publicKey start*****') + LENGTH('publicKey start*****'),
                    INSTR(v_keys, '****publicKey end') - (INSTR(v_keys, 'publicKey start*****') + LENGTH('publicKey start*****'))
                )
             );

    -- 4. Tách private key (loại bỏ ****)
    v_priv := TRIM(
                 SUBSTR(
                     v_keys,
                     INSTR(v_keys, 'privateKey start****') + LENGTH('privateKey start****'),
                     INSTR(v_keys, '****privateKey end') - (INSTR(v_keys, 'privateKey start****') + LENGTH('privateKey start****'))
                 )
              );
    v_pwd := HASH_PASSWORD_20CHARS(p_password);
    -- 1. Tạo Oracle DB user trước
    BEGIN
        EXECUTE IMMEDIATE 'CREATE USER "' || p_phone || '"' ||
                          ' IDENTIFIED BY "' || v_pwd || '"' ||
                          ' DEFAULT TABLESPACE USERS QUOTA UNLIMITED ON USERS';
        EXECUTE IMMEDIATE 'GRANT ROLE_KHACHHANG TO "' || p_phone || '"';
        EXECUTE IMMEDIATE 'ALTER USER ' || p_phone || ' GRANT CONNECT THROUGH APP';
    EXCEPTION
        WHEN OTHERS THEN
            RAISE_APPLICATION_ERROR(-20002, 'Không thể tạo DB User cho Customer ' || p_phone || ': ' || SQLERRM);
    END;

    -- 2. Insert vào bảng CUSTOMER (chỉ khi tạo DB user thành công)
    BEGIN
        INSERT INTO CUSTOMER(PHONE, FULL_NAME, PASSWORD_HASH, PUBLIC_KEY, EMAIL, ADDRESS)
        VALUES (p_phone, p_full_name, v_hash, v_pub, p_email, p_address);

        COMMIT;
    EXCEPTION
        WHEN OTHERS THEN
            -- Nếu lỗi ở bước insert thì rollback + xóa DB user vừa tạo
            ROLLBACK;
            BEGIN
                EXECUTE IMMEDIATE 'DROP USER "' || p_phone || '" CASCADE';
            EXCEPTION
                WHEN OTHERS THEN NULL;
            END;
            RAISE;
    END;

END REGISTER_CUSTOMER;

/

  GRANT EXECUTE ON "APP"."REGISTER_CUSTOMER" TO "ROLE_ADMIN";
--------------------------------------------------------
--  DDL for Procedure REGISTER_EMPLOYEE
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."REGISTER_EMPLOYEE" (
    p_empid       IN NUMBER DEFAULT NULL,   
    p_full_name   IN VARCHAR2,
    p_username    IN VARCHAR2,
    p_password    IN VARCHAR2,
    p_email       IN VARCHAR2,
    p_phone       IN VARCHAR2,
    p_private_key OUT CLOB
)
AS
    v_hash      VARCHAR2(256);
    v_pub       CLOB;
    v_priv      CLOB;
    v_keys      CLOB;
    v_pwd VARCHAR2(20);
BEGIN
    -- 1. Hash mật khẩu
    v_hash := HASH_PASSWORD(p_password);

    -- 2. Sinh cặp RSA
    v_keys := CRYPTO.RSA_GENERATE_KEYS(KEY_SIZE => 1024);

    -- 3. Tách public key (loại bỏ ****)
    v_pub := TRIM(
                SUBSTR(
                    v_keys,
                    INSTR(v_keys, 'publicKey start*****') + LENGTH('publicKey start*****'),
                    INSTR(v_keys, '****publicKey end') - (INSTR(v_keys, 'publicKey start*****') + LENGTH('publicKey start*****'))
                )
             );

    -- 4. Tách private key (loại bỏ ****)
    v_priv := TRIM(
                 SUBSTR(
                     v_keys,
                     INSTR(v_keys, 'privateKey start****') + LENGTH('privateKey start****'),
                     INSTR(v_keys, '****privateKey end') - (INSTR(v_keys, 'privateKey start****') + LENGTH('privateKey start****'))
                 )
              );
    v_pwd := HASH_PASSWORD_20CHARS(p_password);
    -- 5. Tạo Oracle DB user
    BEGIN
        EXECUTE IMMEDIATE 'CREATE USER ' || p_username ||
                  ' IDENTIFIED BY "' || v_pwd || '" DEFAULT TABLESPACE USERS QUOTA UNLIMITED ON USERS';
        EXECUTE IMMEDIATE 'GRANT CONNECT, RESOURCE TO ' || p_username;
        EXECUTE IMMEDIATE 'GRANT EXECUTE ON LOGIN_EMPLOYEE TO ' || p_username;
        EXECUTE IMMEDIATE 'ALTER USER ' || p_username || ' GRANT CONNECT THROUGH APP';

    EXCEPTION
        WHEN OTHERS THEN
            RAISE_APPLICATION_ERROR(-20001, 'Không thể tạo DB User cho nhân viên: ' || SQLERRM);
    END;

    -- 6. Insert vào EMPLOYEE
    IF p_empid IS NULL THEN
        INSERT INTO EMPLOYEE(FULL_NAME, USERNAME, PASSWORD_HASH, PUBLIC_KEY, EMAIL, PHONE)
        VALUES (p_full_name, p_username, v_hash, v_pub, p_email, p_phone);
    ELSE
        INSERT INTO EMPLOYEE(EMP_ID, FULL_NAME, USERNAME, PASSWORD_HASH, PUBLIC_KEY, EMAIL, PHONE)
        VALUES (p_empid, p_full_name, p_username, v_hash, v_pub, p_email, p_phone);
    END IF;

    -- 7. Trả private key ra OUT param
    p_private_key := v_priv;

    COMMIT;

EXCEPTION
    WHEN OTHERS THEN
        BEGIN
            EXECUTE IMMEDIATE 'DROP USER ' || p_username || ' CASCADE';
        EXCEPTION
            WHEN OTHERS THEN NULL;
        END;
        RAISE;
END;

/

  GRANT EXECUTE ON "APP"."REGISTER_EMPLOYEE" TO "ROLE_ADMIN";
--------------------------------------------------------
--  DDL for Procedure RESET_PASSWORD_CUSTOMER
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."RESET_PASSWORD_CUSTOMER" (
    p_email IN VARCHAR2,
    p_otp IN VARCHAR2,
    p_new_password IN VARCHAR2,
    p_result OUT VARCHAR2
)
AS
    v_customer_exists NUMBER;
    p_phone VARCHAR(20);
    v_otp_valid NUMBER;
    v_otp_used CHAR(1);
    v_expired_at TIMESTAMP;
    v_new_hash VARCHAR2(256);
    v_pwd VARCHAR2(20);
BEGIN
    -- 1. Kiểm tra customer có tồn tại không
    SELECT COUNT(*) INTO v_customer_exists
    FROM CUSTOMER
    WHERE EMAIL = p_email;

    SELECT PHONE INTO p_phone
    FROM CUSTOMER
    WHERE EMAIL = p_email;
    
    
    IF v_customer_exists = 0 THEN
        p_result := 'Email này không tồn tại trong hệ thống.';
        RETURN;
    END IF;

    -- 2. Kiểm tra OTP có hợp lệ không (chưa dùng, chưa hết hạn, đúng mã)
    SELECT COUNT(*)
    INTO v_otp_valid
    FROM USER_OTP_LOG
    WHERE USERNAME = p_phone
      AND OTP = p_otp
      AND USED = 'N'
      AND EXPIRED_AT > SYSTIMESTAMP;
    
    IF v_otp_valid = 0 THEN
        p_result := 'OTP không hợp lệ, đã hết hạn hoặc đã được sử dụng.';
        RETURN;
    END IF;

    IF v_otp_valid = 0 THEN
        p_result := 'OTP không hợp lệ, đã hết hạn hoặc đã được sử dụng.';
        RETURN;
    END IF;

    -- 3. Hash mật khẩu mới (tương tự như CHANGE_CUSTOMER_PASSWORD)
    v_new_hash := HASH_PASSWORD(p_new_password);
    v_pwd := HASH_PASSWORD_20CHARS(p_new_password);

    -- 4. Cập nhật mật khẩu trong bảng CUSTOMER
    BEGIN
        UPDATE CUSTOMER
        SET PASSWORD_HASH = v_new_hash
        WHERE PHONE = p_phone;

        IF SQL%ROWCOUNT = 0 THEN
            p_result := 'Không thể cập nhật mật khẩu.';
            RETURN;
        END IF;
    EXCEPTION
        WHEN OTHERS THEN
            ROLLBACK;
            p_result := 'Lỗi khi cập nhật mật khẩu: ' || SQLERRM;
            RETURN;
    END;

    -- 5. Cập nhật Oracle DB user password
    BEGIN
        EXECUTE IMMEDIATE 'ALTER USER "' || p_phone || '" IDENTIFIED BY "' || v_pwd || '"';
    EXCEPTION
        WHEN OTHERS THEN
            -- Nếu không thể update DB user password, vẫn tiếp tục (có thể user không tồn tại)
            NULL;
    END;

    -- 6. Đánh dấu OTP đã sử dụng
    UPDATE USER_OTP_LOG
    SET USED = 'Y'
    WHERE USERNAME = p_phone
      AND OTP = p_otp
      AND USED = 'N';

    p_result := 'Đặt lại mật khẩu thành công.';

    COMMIT;

EXCEPTION
    WHEN OTHERS THEN
        ROLLBACK;
        p_result := 'Lỗi khi đặt lại mật khẩu: ' || SQLERRM;
        RAISE;
END RESET_PASSWORD_CUSTOMER;

/

  GRANT EXECUTE ON "APP"."RESET_PASSWORD_CUSTOMER" TO "ROLE_KHACHHANG";
--------------------------------------------------------
--  DDL for Procedure REVOKE_ROLE_PROC
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."REVOKE_ROLE_PROC" (
    p_username IN VARCHAR2,
    p_role_name IN VARCHAR2
)
AS
BEGIN
    EXECUTE IMMEDIATE 'REVOKE "' || p_role_name || '" FROM "' || p_username || '"';
END;

/

  GRANT EXECUTE ON "APP"."REVOKE_ROLE_PROC" TO "ROLE_ADMIN";
--------------------------------------------------------
--  DDL for Procedure SIGN_INVOICE
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."SIGN_INVOICE" (
    p_invoice_id   IN NUMBER,
    p_private_key   IN VARCHAR2,
    p_signature     OUT CLOB
) AS
    l_data_to_sign   CLOB := EMPTY_CLOB();
    l_header         CLOB;
BEGIN
    -- 1. Lấy header từ INVOICE
    SELECT TRIM(i.INVOICE_ID) || '|' ||
           TRIM(i.STOCKOUT_ID) || '|' ||
           TRIM(i.CUSTOMER_PHONE) || '|' ||
           TRIM(i.EMP_ID) || '|' ||
           TO_CHAR(i.INVOICE_DATE,'YYYYMMDD') || '|' ||
           TO_CHAR(i.TOTAL_AMOUNT,'FM9999990.00') || '|' ||
           TRIM(NVL(i.STATUS,''))
    INTO l_header
    FROM APP.INVOICE i
    WHERE i.INVOICE_ID = p_invoice_id;

    l_data_to_sign := l_header || '|';

    -- 2. Nối từng INVOICE_ITEM (Parts) vào CLOB
    FOR rec IN (
        SELECT ii.PART_ID, p.NAME, p.MANUFACTURER, p.SERIAL, ii.PRICE
        FROM APP.INVOICE_ITEM ii
        JOIN APP.PART p ON ii.PART_ID = p.PART_ID
        WHERE ii.INVOICE_ID = p_invoice_id
        ORDER BY ii.PART_ID
    ) LOOP
        l_data_to_sign := l_data_to_sign ||
                          TRIM(rec.PART_ID) || '|' ||
                          TRIM(rec.NAME) || '|' ||
                          TRIM(NVL(rec.MANUFACTURER,'')) || '|' ||
                          TRIM(rec.SERIAL) || '|' ||
                          TO_CHAR(rec.PRICE,'FM9999990.00') || ';';
    END LOOP;

    -- 3. Nối từng INVOICE_SERVICE vào CLOB
    FOR rec IN (
        SELECT isv.SERVICE_ID, s.NAME, isv.QUANTITY, isv.PRICE
        FROM APP.INVOICE_SERVICE isv
        JOIN APP.SERVICE s ON isv.SERVICE_ID = s.SERVICE_ID
        WHERE isv.INVOICE_ID = p_invoice_id
        ORDER BY isv.SERVICE_ID
    ) LOOP
        l_data_to_sign := l_data_to_sign ||
                          TRIM(rec.SERVICE_ID) || '|' ||
                          TRIM(rec.NAME) || '|' ||
                          TRIM(rec.QUANTITY) || '|' ||
                          TO_CHAR(rec.PRICE,'FM9999990.00') || ';';
    END LOOP;

    -- 4. Hash SHA-256
    DECLARE
        l_hash_raw  RAW(32);
        l_hash_hex  VARCHAR2(64);
    BEGIN
        l_hash_raw := DBMS_CRYPTO.HASH(UTL_RAW.CAST_TO_RAW(l_data_to_sign), DBMS_CRYPTO.HASH_SH256);
        l_hash_hex := RAWTOHEX(l_hash_raw);

        -- 5. Ký hash
        p_signature := CRYPTO.RSA_SIGN(l_hash_hex, p_private_key);
    END;

EXCEPTION
    WHEN NO_DATA_FOUND THEN
        RAISE_APPLICATION_ERROR(-20001, 'Không tìm thấy hóa đơn với ID: ' || p_invoice_id);
    WHEN OTHERS THEN
        RAISE;
END SIGN_INVOICE;


/

  GRANT EXECUTE ON "APP"."SIGN_INVOICE" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."SIGN_INVOICE" TO "ROLE_THUKHO";
  GRANT EXECUTE ON "APP"."SIGN_INVOICE" TO "ROLE_TIEPTAN";
--------------------------------------------------------
--  DDL for Procedure SIGN_PDF
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."SIGN_PDF" (
    p_block        IN  RAW,       -- ≤32KB
    p_private_key  IN  VARCHAR2,
    p_signature    OUT BLOB
) AS
    l_hash       RAW(32);
    l_hash_hex   VARCHAR2(64);
    l_signed_clob CLOB;
    l_signed_raw RAW(32767);
BEGIN
    -- 1. Hash block và chuyển sang hex
    l_hash := DBMS_CRYPTO.HASH(p_block, DBMS_CRYPTO.HASH_SH256);
    l_hash_hex := RAWTOHEX(l_hash);

    -- 2. Ký hash (hex string) → trả về CLOB
    l_signed_clob := CRYPTO.RSA_SIGN(l_hash_hex, p_private_key);

    -- 3. Chuyển CLOB ký sang RAW để ghi vào BLOB
    l_signed_raw := UTL_RAW.CAST_TO_RAW(l_signed_clob);

    -- 4. Tạo BLOB tạm và ghi
    DBMS_LOB.CREATETEMPORARY(p_signature, TRUE);
    DBMS_LOB.WRITE(p_signature, UTL_RAW.LENGTH(l_signed_raw), 1, l_signed_raw);

EXCEPTION
    WHEN OTHERS THEN
        RAISE_APPLICATION_ERROR(-20001, 'Lỗi ký PDF block: ' || SQLERRM);
END SIGN_PDF;

/

  GRANT EXECUTE ON "APP"."SIGN_PDF" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."SIGN_PDF" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Procedure SIGN_STOCKIN
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."SIGN_STOCKIN" (
    p_stockin_id   IN NUMBER,
    p_private_key  IN VARCHAR2,
    p_signature    OUT CLOB
) AS
    l_data_to_sign   CLOB := EMPTY_CLOB();
    l_header         CLOB;
BEGIN
    -- 1. Lấy header
    SELECT TRIM(s.STOCKIN_ID) || '|' ||
           TRIM(s.EMP_ID) || '|' ||
           TO_CHAR(s.IN_DATE,'YYYYMMDD') || '|' ||
           TRIM(NVL(s.NOTE,''))
    INTO l_header
    FROM APP.STOCK_IN s
    WHERE s.STOCKIN_ID = p_stockin_id;

    l_data_to_sign := l_header || '|';

    -- 2. Nối từng item vào CLOB, tránh LISTAGG
    FOR rec IN (
        SELECT STOCKIN_ITEM_ID, PART_NAME, MANUFACTURER, SERIAL, PRICE
        FROM APP.STOCK_IN_ITEM
        WHERE STOCKIN_ID = p_stockin_id
        ORDER BY STOCKIN_ITEM_ID
    ) LOOP
        l_data_to_sign := l_data_to_sign ||
                          TRIM(rec.STOCKIN_ITEM_ID) || '|' ||
                          TRIM(rec.PART_NAME) || '|' ||
                          TRIM(NVL(rec.MANUFACTURER,'')) || '|' ||
                          TRIM(rec.SERIAL) || '|' ||
                          TO_CHAR(rec.PRICE,'FM9999990.00') || ';';
    END LOOP;

    -- 3. Hash SHA-256
    DECLARE
        l_hash_raw  RAW(32);
        l_hash_hex  VARCHAR2(64);
    BEGIN
        l_hash_raw := DBMS_CRYPTO.HASH(UTL_RAW.CAST_TO_RAW(l_data_to_sign), DBMS_CRYPTO.HASH_SH256);
        l_hash_hex := RAWTOHEX(l_hash_raw);

        -- 4. Ký hash (giả sử CRYPTO.RSA_SIGN trả về CLOB)
        p_signature := CRYPTO.RSA_SIGN(l_hash_hex, p_private_key);
    END;

END SIGN_STOCKIN;

/

  GRANT EXECUTE ON "APP"."SIGN_STOCKIN" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."SIGN_STOCKIN" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Procedure SIGN_STOCKOUT
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."SIGN_STOCKOUT" (
    p_stockout_id   IN NUMBER,
    p_private_key   IN VARCHAR2,
    p_signature     OUT CLOB
) AS
    l_data_to_sign   CLOB := EMPTY_CLOB();
    l_header         CLOB;
BEGIN
    -- 1. Lấy header
    SELECT TRIM(s.STOCKOUT_ID) || '|' ||
           TRIM(s.ORDER_ID) || '|' ||
           TRIM(s.EMP_ID) || '|' ||
           TO_CHAR(s.OUT_DATE,'YYYYMMDD') || '|' ||
           TRIM(NVL(s.NOTE,''))
    INTO l_header
    FROM APP.STOCK_OUT s
    WHERE s.STOCKOUT_ID = p_stockout_id;

    l_data_to_sign := l_header || '|';

    -- 2. Nối từng part vào CLOB
    FOR rec IN (
        SELECT soi.PART_ID, p.NAME, p.MANUFACTURER, p.SERIAL, p.PRICE
        FROM APP.STOCK_OUT_ITEM soi
        JOIN APP.PART p ON soi.PART_ID = p.PART_ID
        WHERE soi.STOCKOUT_ID = p_stockout_id
        ORDER BY soi.PART_ID
    ) LOOP
        l_data_to_sign := l_data_to_sign ||
                          TRIM(rec.PART_ID) || '|' ||
                          TRIM(rec.NAME) || '|' ||
                          TRIM(NVL(rec.MANUFACTURER,'')) || '|' ||
                          TRIM(rec.SERIAL) || '|' ||
                          TO_CHAR(rec.PRICE,'FM9999990.00') || ';';
    END LOOP;

    -- 3. Hash SHA-256
    DECLARE
        l_hash_raw  RAW(32);
        l_hash_hex  VARCHAR2(64);
    BEGIN
        l_hash_raw := DBMS_CRYPTO.HASH(UTL_RAW.CAST_TO_RAW(l_data_to_sign), DBMS_CRYPTO.HASH_SH256);
        l_hash_hex := RAWTOHEX(l_hash_raw);

        -- 4. Ký hash
        p_signature := CRYPTO.RSA_SIGN(l_hash_hex, p_private_key);
    END;

EXCEPTION
    WHEN NO_DATA_FOUND THEN
        RAISE_APPLICATION_ERROR(-20001, 'Không tìm thấy phiếu xuất kho với ID: ' || p_stockout_id);
    WHEN OTHERS THEN
        RAISE;
END SIGN_STOCKOUT;

/

  GRANT EXECUTE ON "APP"."SIGN_STOCKOUT" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."SIGN_STOCKOUT" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Procedure TRIGGER_DISABLE_ALL
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."TRIGGER_DISABLE_ALL" AS
BEGIN
  -- Thêm trigger bạn muốn tắt
  EXECUTE IMMEDIATE 'ALTER TRIGGER trg_audit_customer_appointment DISABLE';
  EXECUTE IMMEDIATE 'ALTER TRIGGER trg_audit_customer DISABLE';
  EXECUTE IMMEDIATE 'ALTER TRIGGER trg_audit_employee DISABLE';
  EXECUTE IMMEDIATE 'ALTER TRIGGER trg_audit_invoice DISABLE';
  EXECUTE IMMEDIATE 'ALTER TRIGGER trg_audit_invoice_item DISABLE';
  EXECUTE IMMEDIATE 'ALTER TRIGGER trg_audit_orders DISABLE';
  EXECUTE IMMEDIATE 'ALTER TRIGGER trg_audit_part DISABLE';
  EXECUTE IMMEDIATE 'ALTER TRIGGER trg_audit_part_request DISABLE';
  EXECUTE IMMEDIATE 'ALTER TRIGGER trg_audit_stock_in DISABLE';
  EXECUTE IMMEDIATE 'ALTER TRIGGER trg_audit_stock_in_item DISABLE';
  EXECUTE IMMEDIATE 'ALTER TRIGGER trg_audit_stock_out DISABLE';
  EXECUTE IMMEDIATE 'ALTER TRIGGER trg_audit_stock_out_item DISABLE';
  -- ...
END;

/

  GRANT EXECUTE ON "APP"."TRIGGER_DISABLE_ALL" TO "ROLE_ADMIN";
--------------------------------------------------------
--  DDL for Procedure TRIGGER_ENABLE_ALL
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."TRIGGER_ENABLE_ALL" AS
BEGIN
  -- Thêm trigger bạn muốn bật
  EXECUTE IMMEDIATE 'ALTER TRIGGER trg_audit_customer_appointment ENABLE';
  EXECUTE IMMEDIATE 'ALTER TRIGGER trg_audit_customer ENABLE';
  EXECUTE IMMEDIATE 'ALTER TRIGGER trg_audit_employee ENABLE';
  EXECUTE IMMEDIATE 'ALTER TRIGGER trg_audit_invoice ENABLE';
  EXECUTE IMMEDIATE 'ALTER TRIGGER trg_audit_invoice_item ENABLE';
  EXECUTE IMMEDIATE 'ALTER TRIGGER trg_audit_orders ENABLE';
  EXECUTE IMMEDIATE 'ALTER TRIGGER trg_audit_part ENABLE';
  EXECUTE IMMEDIATE 'ALTER TRIGGER trg_audit_part_request ENABLE';
  EXECUTE IMMEDIATE 'ALTER TRIGGER trg_audit_part_request_item ENABLE';
  EXECUTE IMMEDIATE 'ALTER TRIGGER trg_audit_stock_in ENABLE';
  EXECUTE IMMEDIATE 'ALTER TRIGGER trg_audit_stock_in_item ENABLE';
  EXECUTE IMMEDIATE 'ALTER TRIGGER trg_audit_stock_out ENABLE';
  EXECUTE IMMEDIATE 'ALTER TRIGGER trg_audit_stock_out_item ENABLE';
  -- ...
END;

/

  GRANT EXECUTE ON "APP"."TRIGGER_ENABLE_ALL" TO "ROLE_ADMIN";
--------------------------------------------------------
--  DDL for Procedure UNLOCK_DB_USER
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."UNLOCK_DB_USER" (
    p_username IN VARCHAR2
)
AS
BEGIN
    BEGIN
        EXECUTE IMMEDIATE 'ALTER USER "' || UPPER(p_username) || '" ACCOUNT UNLOCK';

    EXCEPTION
        WHEN OTHERS THEN
            RAISE_APPLICATION_ERROR(-20001, 'Không thể unlock user ' || p_username || ': ' || SQLERRM);
    END;
END;

/

  GRANT EXECUTE ON "APP"."UNLOCK_DB_USER" TO "ROLE_ADMIN";
--------------------------------------------------------
--  DDL for Procedure UPDATE_INVOICE_PDF
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."UPDATE_INVOICE_PDF" (
    p_invoice_id IN NUMBER,
    p_signature  IN BLOB
) AS
BEGIN
    UPDATE APP.INVOICE
    SET PDF = p_signature
    WHERE INVOICE_ID = p_invoice_id;
END UPDATE_INVOICE_PDF;


/

  GRANT EXECUTE ON "APP"."UPDATE_INVOICE_PDF" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."UPDATE_INVOICE_PDF" TO "ROLE_THUKHO";
  GRANT EXECUTE ON "APP"."UPDATE_INVOICE_PDF" TO "ROLE_TIEPTAN";
--------------------------------------------------------
--  DDL for Procedure UPDATE_INVOICE_SIGNATURE
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."UPDATE_INVOICE_SIGNATURE" (
    p_invoice_id IN NUMBER,
    p_signature   IN VARCHAR2
) AS
BEGIN
    UPDATE APP.INVOICE
    SET SIGNATURE = p_signature
    WHERE INVOICE_ID = p_invoice_id;

    IF SQL%NOTFOUND THEN
        RAISE_APPLICATION_ERROR(-20002, 'Không tìm thấy hóa đơn để cập nhật chữ ký: ' || p_invoice_id);
    END IF;
END UPDATE_INVOICE_SIGNATURE;


/

  GRANT EXECUTE ON "APP"."UPDATE_INVOICE_SIGNATURE" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."UPDATE_INVOICE_SIGNATURE" TO "ROLE_THUKHO";
  GRANT EXECUTE ON "APP"."UPDATE_INVOICE_SIGNATURE" TO "ROLE_TIEPTAN";
--------------------------------------------------------
--  DDL for Procedure UPDATE_ORDER_STATUS_WAIT_PART
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."UPDATE_ORDER_STATUS_WAIT_PART" (
    p_order_id IN NUMBER
)
AS
BEGIN
    -- Cập nhật trạng thái trong bảng PART_REQUEST (hoặc bảng ORDER)
    UPDATE ORDERS
       SET STATUS = 'Đang chờ linh kiện'
     WHERE ORDER_ID = p_order_id;

    COMMIT;
EXCEPTION
    WHEN OTHERS THEN
        ROLLBACK;
        RAISE;
END UPDATE_ORDER_STATUS_WAIT_PART;

/

  GRANT EXECUTE ON "APP"."UPDATE_ORDER_STATUS_WAIT_PART" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."UPDATE_ORDER_STATUS_WAIT_PART" TO "ROLE_TIEPTAN";
  GRANT EXECUTE ON "APP"."UPDATE_ORDER_STATUS_WAIT_PART" TO "ROLE_KITHUATVIEN";
--------------------------------------------------------
--  DDL for Procedure UPDATE_PROFILE
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."UPDATE_PROFILE" (
    p_profile_name IN VARCHAR2,
    p_idle_time IN VARCHAR2 DEFAULT NULL,
    p_connect_time IN VARCHAR2 DEFAULT NULL,
    p_failed_login IN VARCHAR2 DEFAULT NULL,
    p_lock_time IN VARCHAR2 DEFAULT NULL,
    p_inactive_account_time IN VARCHAR2 DEFAULT NULL)
AS
    v_sql VARCHAR2(4000);
BEGIN
    v_sql := 'ALTER PROFILE ' || UPPER(p_profile_name) || ' LIMIT';
    IF p_idle_time IS NOT NULL THEN
        v_sql := v_sql || ' IDLE_TIME ' || p_idle_time;
    END IF;
    IF p_connect_time IS NOT NULL THEN
        v_sql := v_sql || ' CONNECT_TIME ' || p_connect_time;
    END IF;
    IF p_failed_login IS NOT NULL THEN
        v_sql := v_sql || ' FAILED_LOGIN_ATTEMPTS ' || p_failed_login;
    END IF;
    IF p_lock_time IS NOT NULL THEN
        v_sql := v_sql || ' PASSWORD_LOCK_TIME ' || p_lock_time;
    END IF;
    IF p_inactive_account_time IS NOT NULL THEN
        v_sql := v_sql || ' INACTIVE_ACCOUNT_TIME ' || p_inactive_account_time;
    END IF;
    EXECUTE IMMEDIATE v_sql;
END UPDATE_PROFILE;

/

  GRANT EXECUTE ON "APP"."UPDATE_PROFILE" TO "ROLE_ADMIN";
--------------------------------------------------------
--  DDL for Procedure UPDATE_STOCKIN_PDF
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."UPDATE_STOCKIN_PDF" (
    p_stockin_id IN NUMBER,
    p_signature  IN BLOB
) AS
BEGIN
    UPDATE APP.STOCK_IN
    SET PDF = p_signature
    WHERE STOCKIN_ID = p_stockin_id;
END UPDATE_STOCKIN_PDF;

/

  GRANT EXECUTE ON "APP"."UPDATE_STOCKIN_PDF" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."UPDATE_STOCKIN_PDF" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Procedure UPDATE_STOCKIN_SIGNATURE
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."UPDATE_STOCKIN_SIGNATURE" (
    p_stockin_id IN NUMBER,
    p_signature  IN VARCHAR2
) AS
BEGIN
    UPDATE APP.STOCK_IN
    SET SIGNATURE = p_signature
    WHERE STOCKIN_ID = p_stockin_id;
END UPDATE_STOCKIN_SIGNATURE;

/

  GRANT EXECUTE ON "APP"."UPDATE_STOCKIN_SIGNATURE" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."UPDATE_STOCKIN_SIGNATURE" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Procedure UPDATE_STOCKOUT_PDF
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."UPDATE_STOCKOUT_PDF" (
    p_stockout_id IN NUMBER,
    p_signature  IN BLOB
) AS
BEGIN
    UPDATE APP.STOCK_OUT
    SET PDF = p_signature
    WHERE STOCKOUT_ID = p_stockout_id;
END UPDATE_STOCKOUT_PDF;

/

  GRANT EXECUTE ON "APP"."UPDATE_STOCKOUT_PDF" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."UPDATE_STOCKOUT_PDF" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Procedure UPDATE_STOCKOUT_SIGNATURE
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."UPDATE_STOCKOUT_SIGNATURE" (
    p_stockout_id IN NUMBER,
    p_signature   IN VARCHAR2
) AS
BEGIN
    UPDATE APP.STOCK_OUT
    SET SIGNATURE = p_signature
    WHERE STOCKOUT_ID = p_stockout_id;

    IF SQL%NOTFOUND THEN
        RAISE_APPLICATION_ERROR(-20002, 'Không tìm thấy phiếu xuất kho để cập nhật chữ ký: ' || p_stockout_id);
    END IF;
END UPDATE_STOCKOUT_SIGNATURE;


/

  GRANT EXECUTE ON "APP"."UPDATE_STOCKOUT_SIGNATURE" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."UPDATE_STOCKOUT_SIGNATURE" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Procedure VERIFY_INVOICE_SIGNATURE
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."VERIFY_INVOICE_SIGNATURE" (
    p_invoice_id   IN NUMBER,              -- ID của hóa đơn
    p_public_key    IN VARCHAR2,            -- Public Key dùng để xác minh
    p_signature     IN CLOB,                -- Chữ ký cần xác minh
    p_is_valid      OUT NUMBER              -- Kết quả: 1 (Hợp lệ) hoặc 0 (Không hợp lệ)
) AS
    l_data_to_sign  CLOB := EMPTY_CLOB();
    l_header        CLOB;
    l_hash_raw      RAW(32);
    l_hash_hex      VARCHAR2(64);
    l_verified      BOOLEAN;
BEGIN
    -- 1. Lấy header từ INVOICE
    SELECT TRIM(i.INVOICE_ID) || '|' ||
           TRIM(i.STOCKOUT_ID) || '|' ||
           TRIM(i.CUSTOMER_PHONE) || '|' ||
           TRIM(i.EMP_ID) || '|' ||
           TO_CHAR(i.INVOICE_DATE,'YYYYMMDD') || '|' ||
           TO_CHAR(i.TOTAL_AMOUNT,'FM9999990.00') || '|' ||
           TRIM(NVL(i.STATUS,''))
    INTO l_header
    FROM APP.INVOICE i
    WHERE i.INVOICE_ID = p_invoice_id;

    l_data_to_sign := l_header || '|';

    -- 2. Nối từng INVOICE_ITEM (Parts) vào CLOB
    FOR rec IN (
        SELECT ii.PART_ID, p.NAME, p.MANUFACTURER, p.SERIAL, ii.PRICE
        FROM APP.INVOICE_ITEM ii
        JOIN APP.PART p ON ii.PART_ID = p.PART_ID
        WHERE ii.INVOICE_ID = p_invoice_id
        ORDER BY ii.PART_ID
    ) LOOP
        l_data_to_sign := l_data_to_sign ||
                          TRIM(rec.PART_ID) || '|' ||
                          TRIM(rec.NAME) || '|' ||
                          TRIM(NVL(rec.MANUFACTURER,'')) || '|' ||
                          TRIM(rec.SERIAL) || '|' ||
                          TO_CHAR(rec.PRICE,'FM9999990.00') || ';';
    END LOOP;

    -- 3. Nối từng INVOICE_SERVICE vào CLOB
    FOR rec IN (
        SELECT isv.SERVICE_ID, s.NAME, isv.QUANTITY, isv.PRICE
        FROM APP.INVOICE_SERVICE isv
        JOIN APP.SERVICE s ON isv.SERVICE_ID = s.SERVICE_ID
        WHERE isv.INVOICE_ID = p_invoice_id
        ORDER BY isv.SERVICE_ID
    ) LOOP
        l_data_to_sign := l_data_to_sign ||
                          TRIM(rec.SERVICE_ID) || '|' ||
                          TRIM(rec.NAME) || '|' ||
                          TRIM(rec.QUANTITY) || '|' ||
                          TO_CHAR(rec.PRICE,'FM9999990.00') || ';';
    END LOOP;

    -- 4. Hash SHA-256
    l_hash_raw := DBMS_CRYPTO.HASH(UTL_RAW.CAST_TO_RAW(l_data_to_sign), DBMS_CRYPTO.HASH_SH256);
    l_hash_hex := RAWTOHEX(l_hash_raw);

    -- 5. Verify
    l_verified := CRYPTO.RSA_VERIFY(l_hash_hex, p_signature, p_public_key);

    IF l_verified THEN
        p_is_valid := 1;
    ELSE
        p_is_valid := 0;
    END IF;

EXCEPTION
    WHEN NO_DATA_FOUND THEN
        -- Không tìm thấy INVOICE, coi là không hợp lệ
        p_is_valid := 0;
    WHEN OTHERS THEN
        -- Lỗi khác, coi là không hợp lệ
        p_is_valid := 0;
END VERIFY_INVOICE_SIGNATURE;


/

  GRANT EXECUTE ON "APP"."VERIFY_INVOICE_SIGNATURE" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."VERIFY_INVOICE_SIGNATURE" TO "ROLE_THUKHO";
  GRANT EXECUTE ON "APP"."VERIFY_INVOICE_SIGNATURE" TO "ROLE_TIEPTAN";
--------------------------------------------------------
--  DDL for Procedure VERIFY_STOCKIN_SIGNATURE
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."VERIFY_STOCKIN_SIGNATURE" (
    p_stockin_id   IN NUMBER,
    p_public_key   IN VARCHAR2,
    p_signature    IN CLOB,
    p_is_valid     OUT NUMBER
) AS
    l_data_to_sign  CLOB := EMPTY_CLOB();
    l_header        CLOB;
    l_hash_raw      RAW(32);
    l_hash_hex      VARCHAR2(64);
    l_verified      BOOLEAN;
BEGIN
    -- 1. Lấy header
    SELECT TRIM(s.STOCKIN_ID) || '|' ||
           TRIM(s.EMP_ID) || '|' ||
           TO_CHAR(s.IN_DATE,'YYYYMMDD') || '|' ||
           TRIM(NVL(s.NOTE,''))
    INTO l_header
    FROM APP.STOCK_IN s
    WHERE s.STOCKIN_ID = p_stockin_id;

    l_data_to_sign := l_header || '|';

    -- 2. Nối từng item vào CLOB
    FOR rec IN (
        SELECT STOCKIN_ITEM_ID, PART_NAME, MANUFACTURER, SERIAL, PRICE
        FROM APP.STOCK_IN_ITEM
        WHERE STOCKIN_ID = p_stockin_id
        ORDER BY STOCKIN_ITEM_ID
    ) LOOP
        l_data_to_sign := l_data_to_sign ||
                          TRIM(rec.STOCKIN_ITEM_ID) || '|' ||
                          TRIM(rec.PART_NAME) || '|' ||
                          TRIM(NVL(rec.MANUFACTURER,'')) || '|' ||
                          TRIM(rec.SERIAL) || '|' ||
                          TO_CHAR(rec.PRICE,'FM9999990.00') || ';';
    END LOOP;

    -- 3. Hash SHA-256
    l_hash_raw := DBMS_CRYPTO.HASH(UTL_RAW.CAST_TO_RAW(l_data_to_sign), DBMS_CRYPTO.HASH_SH256);
    l_hash_hex := RAWTOHEX(l_hash_raw);

    -- 4. Verify
    l_verified := CRYPTO.RSA_VERIFY(l_hash_hex, p_signature, p_public_key);

    IF l_verified THEN
        p_is_valid := 1;
    ELSE
        p_is_valid := 0;
    END IF;

EXCEPTION
    WHEN NO_DATA_FOUND THEN
        RAISE_APPLICATION_ERROR(-20001, 'Không tìm thấy phiếu nhập kho với ID: ' || p_stockin_id);
    WHEN OTHERS THEN
        RAISE;
END VERIFY_STOCKIN_SIGNATURE;

/

  GRANT EXECUTE ON "APP"."VERIFY_STOCKIN_SIGNATURE" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."VERIFY_STOCKIN_SIGNATURE" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Procedure VERIFY_STOCKOUT_SIGNATURE
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "APP"."VERIFY_STOCKOUT_SIGNATURE" (
    p_stockout_id   IN NUMBER,              -- ID của phiếu xuất kho
    p_public_key    IN VARCHAR2,            -- Public Key dùng để xác minh
    p_signature     IN CLOB,                -- Chữ ký cần xác minh
    p_is_valid      OUT NUMBER              -- Kết quả: 1 (Hợp lệ) hoặc 0 (Không hợp lệ)
) AS
    l_data_to_sign  CLOB := EMPTY_CLOB();
    l_header        CLOB;
    l_hash_raw      RAW(32);
    l_hash_hex      VARCHAR2(64);
    l_verified      BOOLEAN;
BEGIN
    -- 1. Lấy header
    SELECT TRIM(s.STOCKOUT_ID) || '|' ||
           TRIM(s.ORDER_ID) || '|' ||
           TRIM(s.EMP_ID) || '|' ||
           TO_CHAR(s.OUT_DATE,'YYYYMMDD') || '|' ||
           TRIM(NVL(s.NOTE,''))
    INTO l_header
    FROM APP.STOCK_OUT s
    WHERE s.STOCKOUT_ID = p_stockout_id;

    l_data_to_sign := l_header || '|';

    -- 2. Nối từng item từ PART vào CLOB
    FOR rec IN (
        SELECT p.PART_ID, p.NAME, p.MANUFACTURER, p.SERIAL, p.PRICE
        FROM APP.STOCK_OUT_ITEM soi
        JOIN APP.PART p ON soi.PART_ID = p.PART_ID
        WHERE soi.STOCKOUT_ID = p_stockout_id
        ORDER BY p.PART_ID
    ) LOOP
        l_data_to_sign := l_data_to_sign ||
                          TRIM(rec.PART_ID) || '|' ||
                          TRIM(rec.NAME) || '|' ||
                          TRIM(NVL(rec.MANUFACTURER,'')) || '|' ||
                          TRIM(rec.SERIAL) || '|' ||
                          TO_CHAR(rec.PRICE,'FM9999990.00') || ';';
    END LOOP;

    -- 3. Hash SHA-256
    l_hash_raw := DBMS_CRYPTO.HASH(UTL_RAW.CAST_TO_RAW(l_data_to_sign), DBMS_CRYPTO.HASH_SH256);
    l_hash_hex := RAWTOHEX(l_hash_raw);

    -- 4. Verify
    l_verified := CRYPTO.RSA_VERIFY(l_hash_hex, p_signature, p_public_key);

    IF l_verified THEN
        p_is_valid := 1;
    ELSE
        p_is_valid := 0;
    END IF;

EXCEPTION
    WHEN NO_DATA_FOUND THEN
        -- Không tìm thấy STOCK_OUT, coi là không hợp lệ
        p_is_valid := 0;
    WHEN OTHERS THEN
        -- Lỗi khác, coi là không hợp lệ
        p_is_valid := 0;
END VERIFY_STOCKOUT_SIGNATURE;

/

  GRANT EXECUTE ON "APP"."VERIFY_STOCKOUT_SIGNATURE" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."VERIFY_STOCKOUT_SIGNATURE" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Package APP_CTX_PKG
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE PACKAGE "APP"."APP_CTX_PKG" AS
  PROCEDURE set_role(p_role_name IN VARCHAR2);
  PROCEDURE set_emp(p_emp_id IN NUMBER);
  PROCEDURE set_customer(p_customer_phone IN VARCHAR2);
  PROCEDURE set_username(P_username IN VARCHAR2);
END APP_CTX_PKG;

/

  GRANT EXECUTE ON "APP"."APP_CTX_PKG" TO PUBLIC;
  GRANT EXECUTE ON "APP"."APP_CTX_PKG" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."APP_CTX_PKG" TO "ROLE_THUKHO";
  GRANT EXECUTE ON "APP"."APP_CTX_PKG" TO "ROLE_TIEPTAN";
  GRANT EXECUTE ON "APP"."APP_CTX_PKG" TO "ROLE_KITHUATVIEN";
  GRANT EXECUTE ON "APP"."APP_CTX_PKG" TO "ROLE_KHACHHANG";
--------------------------------------------------------
--  DDL for Package AUDIT_DML_PKG
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE PACKAGE "APP"."AUDIT_DML_PKG" AS
  -- Log INSERT operation
  PROCEDURE log_insert(
    p_table_name   IN VARCHAR2,
    p_new_values   IN CLOB);

  -- Log UPDATE operation  
  PROCEDURE log_update(
    p_table_name   IN VARCHAR2,
    p_old_values   IN CLOB,
    p_new_values   IN CLOB,
    p_changed_cols IN VARCHAR2);

  -- Log DELETE operation
  PROCEDURE log_delete(
    p_table_name   IN VARCHAR2,
    p_old_values   IN CLOB);

  -- Helper: Convert rowid to JSON-like format (simplified)
  FUNCTION row_to_json(
    p_table_name IN VARCHAR2,
    p_rowid      IN ROWID) RETURN CLOB;
END audit_dml_pkg;

/
--------------------------------------------------------
--  DDL for Package CRYPTO
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE PACKAGE "APP"."CRYPTO" AS 
FUNCTION RSA_ENCRYPT(PLAIN_TEXT VARCHAR2,PRIVATE_KEY VARCHAR2) RETURN VARCHAR2
AS
LANGUAGE JAVA NAME 'com/dishtavar/crypto4ora/RSAUtil.encrypt (java.lang.String,java.lang.String) return java.lang.String';


FUNCTION RSA_DECRYPT(ENCRYPTED_TEXT VARCHAR2,PUBLIC_KEY VARCHAR2) RETURN VARCHAR2
AS
LANGUAGE JAVA NAME 'com/dishtavar/crypto4ora/RSAUtil.decrypt (java.lang.String,java.lang.String) return java.lang.String';


FUNCTION RSA_SIGN(HASH_MESSAGE VARCHAR2,PUBLIC_KEY VARCHAR2) RETURN VARCHAR2
AS
LANGUAGE JAVA NAME 'com/dishtavar/crypto4ora/RSAUtil.sign (java.lang.String,java.lang.String) return java.lang.String';


FUNCTION RSA_VERIFY(PLAIN_HASH VARCHAR2,SIGNNED_HASH VARCHAR2,PRIVATE_KEY VARCHAR2) RETURN BOOLEAN
AS
LANGUAGE JAVA NAME 'com/dishtavar/crypto4ora/RSAUtil.verify (java.lang.String,java.lang.String,java.lang.String) return java.lang.Boolean';

FUNCTION RSA_GENERATE_KEYS(KEY_SIZE NUMBER) RETURN VARCHAR2
AS
LANGUAGE JAVA NAME 'com/dishtavar/crypto4ora/GenerateKey.generateRSAKeys (java.lang.Integer) return java.lang.String';

END CRYPTO;

/
--------------------------------------------------------
--  DDL for Package Body APP_CTX_PKG
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE PACKAGE BODY "APP"."APP_CTX_PKG" AS

  PROCEDURE set_role(p_role_name IN VARCHAR2) IS
  BEGIN
    DBMS_SESSION.SET_CONTEXT('APP_CTX','ROLE_NAME', UPPER(p_role_name));
  END set_role;

  PROCEDURE set_emp(p_emp_id IN NUMBER) IS
  BEGIN
    DBMS_SESSION.SET_CONTEXT('APP_CTX','EMP_ID', TO_CHAR(p_emp_id));
  END set_emp;

  PROCEDURE set_customer(p_customer_phone IN VARCHAR2) IS
  BEGIN
    DBMS_SESSION.SET_CONTEXT('APP_CTX','CUSTOMER_PHONE', p_customer_phone);
  END set_customer;

  PROCEDURE set_username(p_username IN VARCHAR2) IS
  BEGIN
    DBMS_SESSION.SET_CONTEXT('APP_CTX','USERNAME', p_username);
  END set_username;

END APP_CTX_PKG;

/

  GRANT EXECUTE ON "APP"."APP_CTX_PKG" TO PUBLIC;
  GRANT EXECUTE ON "APP"."APP_CTX_PKG" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."APP_CTX_PKG" TO "ROLE_THUKHO";
  GRANT EXECUTE ON "APP"."APP_CTX_PKG" TO "ROLE_TIEPTAN";
  GRANT EXECUTE ON "APP"."APP_CTX_PKG" TO "ROLE_KITHUATVIEN";
  GRANT EXECUTE ON "APP"."APP_CTX_PKG" TO "ROLE_KHACHHANG";
--------------------------------------------------------
--  DDL for Package Body AUDIT_DML_PKG
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE PACKAGE BODY "APP"."AUDIT_DML_PKG" AS
  
  FUNCTION row_to_json(
    p_table_name IN VARCHAR2,
    p_rowid      IN ROWID) RETURN CLOB IS
    v_result CLOB;
    v_sql    VARCHAR2(4000);
    v_cursor SYS_REFCURSOR;
    v_col_name VARCHAR2(128);
    v_col_value VARCHAR2(4000);
    v_first BOOLEAN := TRUE;
  BEGIN
    -- This is a simplified version
    -- For production, you might want to use DBMS_XMLGEN or dynamic SQL
    -- to get actual column values
    RETURN '{"rowid":"' || p_rowid || '"}';
  END row_to_json;

  PROCEDURE log_insert(
    p_table_name   IN VARCHAR2,
    p_new_values   IN CLOB) IS
    v_role VARCHAR2(100) := NVL(SYS_CONTEXT('APP_CTX','ROLE_NAME'),'ROLE_UNKNOWN');
  BEGIN
    INSERT INTO audit_alert_log(
      db_user,
      os_user,
      machine,
      module,
      app_role,
      emp_id,
      customer_phone,
      object_schema,
      object_name,
      policy_name,
      client_identifier,
      dml_type,
      old_values,
      new_values,
      note)
    VALUES(
      SYS_CONTEXT('USERENV','SESSION_USER'),
      SYS_CONTEXT('USERENV','OS_USER'),
      SYS_CONTEXT('USERENV','HOST'),
      SYS_CONTEXT('USERENV','MODULE'),
      v_role,
      SYS_CONTEXT('APP_CTX','EMP_ID'),
      SYS_CONTEXT('APP_CTX','CUSTOMER_PHONE'),
      USER,
      p_table_name,
      'AUD_' || p_table_name || '_INSERT',
      SYS_CONTEXT('USERENV','CLIENT_IDENTIFIER'),
      'INSERT',
      NULL,
      p_new_values,
      'INSERT operation on ' || p_table_name);
  EXCEPTION
    WHEN OTHERS THEN
      DBMS_OUTPUT.PUT_LINE('AUDIT_DML_PKG.LOG_INSERT failed: ' || SQLERRM);
  END log_insert;

  PROCEDURE log_update(
    p_table_name   IN VARCHAR2,
    p_old_values   IN CLOB,
    p_new_values   IN CLOB,
    p_changed_cols IN VARCHAR2) IS
    v_role VARCHAR2(100) := NVL(SYS_CONTEXT('APP_CTX','ROLE_NAME'),'ROLE_UNKNOWN');
  BEGIN
    INSERT INTO audit_alert_log(
      db_user,
      os_user,
      machine,
      module,
      app_role,
      emp_id,
      customer_phone,
      object_schema,
      object_name,
      policy_name,
      client_identifier,
      dml_type,
      old_values,
      new_values,
      changed_columns,
      note)
    VALUES(
      SYS_CONTEXT('USERENV','SESSION_USER'),
      SYS_CONTEXT('USERENV','OS_USER'),
      SYS_CONTEXT('USERENV','HOST'),
      SYS_CONTEXT('USERENV','MODULE'),
      v_role,
      SYS_CONTEXT('APP_CTX','EMP_ID'),
      SYS_CONTEXT('APP_CTX','CUSTOMER_PHONE'),
      USER,
      p_table_name,
      'AUD_' || p_table_name || '_UPDATE',
      SYS_CONTEXT('USERENV','CLIENT_IDENTIFIER'),
      'UPDATE',
      p_old_values,
      p_new_values,
      p_changed_cols,
      'UPDATE operation on ' || p_table_name || ' - Changed: ' || p_changed_cols);
  EXCEPTION
    WHEN OTHERS THEN
      DBMS_OUTPUT.PUT_LINE('AUDIT_DML_PKG.LOG_UPDATE failed: ' || SQLERRM);
  END log_update;

  PROCEDURE log_delete(
    p_table_name   IN VARCHAR2,
    p_old_values   IN CLOB) IS
    v_role VARCHAR2(100) := NVL(SYS_CONTEXT('APP_CTX','ROLE_NAME'),'ROLE_UNKNOWN');
  BEGIN
    INSERT INTO audit_alert_log(
      db_user,
      os_user,
      machine,
      module,
      app_role,
      emp_id,
      customer_phone,
      object_schema,
      object_name,
      policy_name,
      client_identifier,
      dml_type,
      old_values,
      new_values,
      note)
    VALUES(
      SYS_CONTEXT('USERENV','SESSION_USER'),
      SYS_CONTEXT('USERENV','OS_USER'),
      SYS_CONTEXT('USERENV','HOST'),
      SYS_CONTEXT('USERENV','MODULE'),
      v_role,
      SYS_CONTEXT('APP_CTX','EMP_ID'),
      SYS_CONTEXT('APP_CTX','CUSTOMER_PHONE'),
      USER,
      p_table_name,
      'AUD_' || p_table_name || '_DELETE',
      SYS_CONTEXT('USERENV','CLIENT_IDENTIFIER'),
      'DELETE',
      p_old_values,
      NULL,
      'DELETE operation on ' || p_table_name);
  EXCEPTION
    WHEN OTHERS THEN
      DBMS_OUTPUT.PUT_LINE('AUDIT_DML_PKG.LOG_DELETE failed: ' || SQLERRM);
  END log_delete;

END audit_dml_pkg;

/
--------------------------------------------------------
--  DDL for Function APPOINTMENT_VPD_PREDICATE
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE FUNCTION "APP"."APPOINTMENT_VPD_PREDICATE" (
  p_schema  IN VARCHAR2,
  p_object  IN VARCHAR2
) RETURN VARCHAR2
AS
  v_role VARCHAR2(100) := SYS_CONTEXT('APP_CTX','ROLE_NAME');
  v_cus  VARCHAR2(100) := SYS_CONTEXT('APP_CTX','CUSTOMER_PHONE');
BEGIN
  IF v_role IS NULL THEN
    RETURN '1=0';
  END IF;

  IF v_role IN ('ROLE_ADMIN','ROLE_TIEPTAN') THEN
    RETURN '1=1';
  END IF;

  IF v_role = 'ROLE_KHACHHANG' THEN
    IF v_cus IS NULL THEN
      RETURN '1=0';
    END IF;
    RETURN 'CUSTOMER_PHONE = ''' || REPLACE(v_cus,'''','''''') || '''';
  END IF;

  -- THUKHO, KITHUATVIEN and others: deny
  RETURN '1=0';
END;

/

  GRANT EXECUTE ON "APP"."APPOINTMENT_VPD_PREDICATE" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."APPOINTMENT_VPD_PREDICATE" TO "ROLE_TIEPTAN";
  GRANT EXECUTE ON "APP"."APPOINTMENT_VPD_PREDICATE" TO "ROLE_KHACHHANG";
--------------------------------------------------------
--  DDL for Function APPOINTMENT_VPD_PREDICATE_DEL
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE FUNCTION "APP"."APPOINTMENT_VPD_PREDICATE_DEL" (
  p_schema  IN VARCHAR2,
  p_object  IN VARCHAR2
) RETURN VARCHAR2
AS
BEGIN
  RETURN '1=0';
END;

/

  GRANT EXECUTE ON "APP"."APPOINTMENT_VPD_PREDICATE_DEL" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."APPOINTMENT_VPD_PREDICATE_DEL" TO "ROLE_TIEPTAN";
  GRANT EXECUTE ON "APP"."APPOINTMENT_VPD_PREDICATE_DEL" TO "ROLE_KHACHHANG";
--------------------------------------------------------
--  DDL for Function CUSTOMER_VPD_PREDICATE
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE FUNCTION "APP"."CUSTOMER_VPD_PREDICATE" (
  p_schema IN VARCHAR2,
  p_object IN VARCHAR2
) RETURN VARCHAR2
AS
  v_role  VARCHAR2(100) := SYS_CONTEXT('APP_CTX','ROLE_NAME');
  v_cus   VARCHAR2(100) := SYS_CONTEXT('APP_CTX','CUSTOMER_PHONE');
BEGIN
  -- ADMIN, TIEPTAN: xem full
  IF v_role IN ('ROLE_ADMIN', 'ROLE_TIEPTAN','ROLE_VERIFY') THEN
    RETURN '1=1';
  END IF;

  -- THUKHO, KITHUATVIEN: không được xem
  IF v_role IN ('ROLE_THUKHO', 'ROLE_KITHUATVIEN') THEN
    RETURN '1=0';
  END IF;

  -- KHACHHANG: chỉ xem của cá nhân theo số điện thoại trong context
  IF v_role = 'ROLE_KHACHHANG' THEN
    -- Cột trên bảng CUSTOMER giả định là PHONE
    RETURN 'PHONE = ''' || REPLACE(v_cus,'''','''''') || '''';
  END IF;

  -- Mặc định: chặn
  RETURN '1=0';
END CUSTOMER_VPD_PREDICATE;

/

  GRANT EXECUTE ON "APP"."CUSTOMER_VPD_PREDICATE" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."CUSTOMER_VPD_PREDICATE" TO "ROLE_TIEPTAN";
  GRANT EXECUTE ON "APP"."CUSTOMER_VPD_PREDICATE" TO "ROLE_KITHUATVIEN";
  GRANT EXECUTE ON "APP"."CUSTOMER_VPD_PREDICATE" TO "ROLE_KHACHHANG";
--------------------------------------------------------
--  DDL for Function EMPLOYEE_VPD_PREDICATE
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE FUNCTION "APP"."EMPLOYEE_VPD_PREDICATE" (
  p_schema IN VARCHAR2,
  p_object IN VARCHAR2
) RETURN VARCHAR2
AS
  v_role  VARCHAR2(100) := SYS_CONTEXT('APP_CTX','ROLE_NAME');
  v_emp   VARCHAR2(100) := SYS_CONTEXT('APP_CTX','EMP_ID');
BEGIN
  -- ADMIN, TIEPTAN: xem full
  IF v_role IN ('ROLE_ADMIN', 'ROLE_TIEPTAN') THEN
    RETURN '1=1';
  END IF;

  -- THUKHO, KITHUATVIEN: chỉ xem bản thân
  IF v_role IN ('ROLE_THUKHO', 'ROLE_KITHUATVIEN') THEN
    IF v_emp IS NULL THEN
      RETURN '1=1';
    END IF;
    RETURN '1=1';
  END IF;

  -- KHACHHANG hoặc role khác: không được xem
  -- Mặc định: chặn
  RETURN '1=0';
END EMPLOYEE_VPD_PREDICATE;

/

  GRANT EXECUTE ON "APP"."EMPLOYEE_VPD_PREDICATE" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."EMPLOYEE_VPD_PREDICATE" TO "ROLE_TIEPTAN";
  GRANT EXECUTE ON "APP"."EMPLOYEE_VPD_PREDICATE" TO "ROLE_KITHUATVIEN";
--------------------------------------------------------
--  DDL for Function GET_EMPLOYEE_ROLES_BY_USERNAME
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE FUNCTION "APP"."GET_EMPLOYEE_ROLES_BY_USERNAME" (
    p_username IN VARCHAR2
)
RETURN VARCHAR2
AS
    -- Biến để chứa chuỗi các role
    v_roles_list VARCHAR2(4000); 
BEGIN
    -- Sử dụng DBA_ROLE_PRIVS để lấy tất cả các role được cấp cho user
    -- LISTAGG dùng để gộp các dòng thành một chuỗi duy nhất, phân tách bằng ', '
    SELECT LISTAGG(GRANTED_ROLE, ', ') WITHIN GROUP (ORDER BY GRANTED_ROLE)
    INTO v_roles_list
    FROM DBA_ROLE_PRIVS
    -- Tên người dùng trong DBA_ROLE_PRIVS luôn là chữ hoa
    WHERE GRANTEE = UPPER(p_username); 

    RETURN v_roles_list;

EXCEPTION
    -- Xử lý trường hợp không tìm thấy role nào (ví dụ: user không tồn tại hoặc chưa được gán role)
    WHEN NO_DATA_FOUND THEN
        RETURN NULL;
    -- Xử lý các lỗi khác (ví dụ: không có quyền SELECT trên DBA_ROLE_PRIVS)
    WHEN OTHERS THEN
        -- Tùy chọn: Ghi log lỗi tại đây
        RETURN NULL;
END GET_EMPLOYEE_ROLES_BY_USERNAME; -- ✅ ĐÃ SỬA: BỎ TIỀN TỐ APP.

/

  GRANT EXECUTE ON "APP"."GET_EMPLOYEE_ROLES_BY_USERNAME" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."GET_EMPLOYEE_ROLES_BY_USERNAME" TO "ROLE_KITHUATVIEN";
  GRANT EXECUTE ON "APP"."GET_EMPLOYEE_ROLES_BY_USERNAME" TO "ROLE_TIEPTAN";
  GRANT EXECUTE ON "APP"."GET_EMPLOYEE_ROLES_BY_USERNAME" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Function HASH_PASSWORD
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE FUNCTION "APP"."HASH_PASSWORD" (p_password VARCHAR2) RETURN VARCHAR2 IS
    v_raw RAW(32);
BEGIN
    v_raw := DBMS_CRYPTO.HASH(
        UTL_I18N.STRING_TO_RAW(p_password, 'AL32UTF8'),
        DBMS_CRYPTO.HASH_SH256
    );
    RETURN RAWTOHEX(v_raw);
END;

/

  GRANT EXECUTE ON "APP"."HASH_PASSWORD" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."HASH_PASSWORD" TO "ROLE_KITHUATVIEN";
  GRANT EXECUTE ON "APP"."HASH_PASSWORD" TO "ROLE_TIEPTAN";
  GRANT EXECUTE ON "APP"."HASH_PASSWORD" TO "ROLE_THUKHO";
--------------------------------------------------------
--  DDL for Function HASH_PASSWORD_20CHARS
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE FUNCTION "APP"."HASH_PASSWORD_20CHARS" (p_password VARCHAR2) 
RETURN VARCHAR2
IS
    v_raw RAW(32);     -- SHA256 trả về 32 byte
    v_hex VARCHAR2(64); -- chuyển sang HEX, 64 ký tự
BEGIN
    -- 1. Tính SHA256
    v_raw := DBMS_CRYPTO.HASH(
                UTL_I18N.STRING_TO_RAW(p_password, 'AL32UTF8'),
                DBMS_CRYPTO.HASH_SH256
             );

    -- 2. RAW -> HEX
    v_hex := RAWTOHEX(v_raw); -- 64 ký tự HEX

    -- 3. Trả về 10 ký tự đầu + 10 ký tự cuối
    RETURN SUBSTR(v_hex, 1, 10) || SUBSTR(v_hex, -10);  
END HASH_PASSWORD_20CHARS;

/

  GRANT EXECUTE ON "APP"."HASH_PASSWORD_20CHARS" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."HASH_PASSWORD_20CHARS" TO "ROLE_THUKHO";
  GRANT EXECUTE ON "APP"."HASH_PASSWORD_20CHARS" TO "ROLE_TIEPTAN";
  GRANT EXECUTE ON "APP"."HASH_PASSWORD_20CHARS" TO "ROLE_KITHUATVIEN";
--------------------------------------------------------
--  DDL for Function INVOICE_VPD_PREDICATE
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE FUNCTION "APP"."INVOICE_VPD_PREDICATE" (
  p_schema IN VARCHAR2,
  p_object IN VARCHAR2
) RETURN VARCHAR2
AS
  v_role  VARCHAR2(100) := SYS_CONTEXT('APP_CTX','ROLE_NAME');
  v_cus   VARCHAR2(100) := SYS_CONTEXT('APP_CTX','CUSTOMER_PHONE');
BEGIN
  -- ADMIN, TIEPTAN, VERIFY: full
  IF v_role IN ('ROLE_ADMIN', 'ROLE_TIEPTAN', 'ROLE_VERIFY') THEN
    RETURN '1=1';
  END IF;

  -- Khách hàng: only own by phone
  IF v_role = 'ROLE_KHACHHANG' THEN
    RETURN 'CUSTOMER_PHONE = ''' || REPLACE(v_cus,'''','''''') || '''';
  END IF;

  -- THUKHO, KITHUATVIEN and others: deny
  RETURN '1=0';
END INVOICE_VPD_PREDICATE;

/

  GRANT EXECUTE ON "APP"."INVOICE_VPD_PREDICATE" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."INVOICE_VPD_PREDICATE" TO "ROLE_TIEPTAN";
  GRANT EXECUTE ON "APP"."INVOICE_VPD_PREDICATE" TO "ROLE_THUKHO";
  GRANT EXECUTE ON "APP"."INVOICE_VPD_PREDICATE" TO "ROLE_KHACHHANG";
--------------------------------------------------------
--  DDL for Function ORDERS_VPD_PREDICATE
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE FUNCTION "APP"."ORDERS_VPD_PREDICATE" (
  p_schema  IN VARCHAR2,
  p_object  IN VARCHAR2
) RETURN VARCHAR2
AS
  v_role VARCHAR2(100) := SYS_CONTEXT('APP_CTX','ROLE_NAME');
  v_emp  VARCHAR2(100) := SYS_CONTEXT('APP_CTX','EMP_ID');
  v_cus  VARCHAR2(100) := SYS_CONTEXT('APP_CTX','CUSTOMER_PHONE');
BEGIN
  IF v_role IS NULL THEN
    RETURN '1=0';
  END IF;

  IF v_role IN ('ROLE_ADMIN','ROLE_TIEPTAN') THEN
    RETURN '1=1';
  END IF;

  IF v_role = 'ROLE_KITHUATVIEN' THEN
    IF v_emp IS NULL THEN
      RETURN '1=0';
    END IF;
    RETURN 'HANDLER_EMP = ' || TO_NUMBER(v_emp);
  END IF;

  IF v_role = 'ROLE_KHACHHANG' THEN
    IF v_cus IS NULL THEN
      RETURN '1=0';
    END IF;
    RETURN 'CUSTOMER_PHONE = ''' || REPLACE(v_cus,'''','''''') || '''';
  END IF;

  IF v_role = 'ROLE_THUKHO' THEN
    RETURN '1=0';
  END IF;

  RETURN '1=0';
END;

/

  GRANT EXECUTE ON "APP"."ORDERS_VPD_PREDICATE" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."ORDERS_VPD_PREDICATE" TO "ROLE_TIEPTAN";
  GRANT EXECUTE ON "APP"."ORDERS_VPD_PREDICATE" TO "ROLE_KITHUATVIEN";
  GRANT EXECUTE ON "APP"."ORDERS_VPD_PREDICATE" TO "ROLE_KHACHHANG";
--------------------------------------------------------
--  DDL for Function ORDERS_VPD_PREDICATE_DEL
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE FUNCTION "APP"."ORDERS_VPD_PREDICATE_DEL" (
  p_schema  IN VARCHAR2,
  p_object  IN VARCHAR2
) RETURN VARCHAR2
AS
BEGIN
  RETURN '1=0';
END;

/

  GRANT EXECUTE ON "APP"."ORDERS_VPD_PREDICATE_DEL" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."ORDERS_VPD_PREDICATE_DEL" TO "ROLE_TIEPTAN";
  GRANT EXECUTE ON "APP"."ORDERS_VPD_PREDICATE_DEL" TO "ROLE_KITHUATVIEN";
  GRANT EXECUTE ON "APP"."ORDERS_VPD_PREDICATE_DEL" TO "ROLE_KHACHHANG";
--------------------------------------------------------
--  DDL for Function PARTREQUEST_VPD_PREDICATE
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE FUNCTION "APP"."PARTREQUEST_VPD_PREDICATE" (
  p_schema IN VARCHAR2,
  p_object IN VARCHAR2
) RETURN VARCHAR2
AS
  v_role   VARCHAR2(100) := SYS_CONTEXT('APP_CTX','ROLE_NAME');
  v_emp_id VARCHAR2(100) := SYS_CONTEXT('APP_CTX','EMP_ID');
BEGIN
  -- Admin, Thukho: full access
  IF v_role IN ('ROLE_ADMIN','ROLE_THUKHO') THEN
    RETURN '1=1';
  END IF;

  -- Kithuatvien: own rows only
  IF v_role = 'ROLE_KITHUATVIEN' THEN
    IF p_object = 'PART_REQUEST' THEN
      RETURN 'EMP_ID = TO_NUMBER(''' || REPLACE(v_emp_id,'''','') || ''')';
    ELSIF p_object = 'PART_REQUEST_ITEM' THEN
      -- Join với bảng cha để lọc
      RETURN 'REQUEST_ID IN (SELECT REQUEST_ID FROM PART_REQUEST WHERE EMP_ID = TO_NUMBER(''' 
             || REPLACE(v_emp_id,'''','') || '''))';
    END IF;
  END IF;

  -- Các role khác: deny access
  RETURN '1=0';
END PARTREQUEST_VPD_PREDICATE;

/

  GRANT EXECUTE ON "APP"."PARTREQUEST_VPD_PREDICATE" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."PARTREQUEST_VPD_PREDICATE" TO "ROLE_THUKHO";
  GRANT EXECUTE ON "APP"."PARTREQUEST_VPD_PREDICATE" TO "ROLE_KITHUATVIEN";
--------------------------------------------------------
--  DDL for Function PART_VPD_PREDICATE
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE FUNCTION "APP"."PART_VPD_PREDICATE" (
  p_schema IN VARCHAR2,
  p_object IN VARCHAR2
) RETURN VARCHAR2
AS
  v_role  VARCHAR2(100) := SYS_CONTEXT('APP_CTX','ROLE_NAME');
BEGIN
  -- Admin, Thukho, Kithuatvien: full
  IF v_role IN ('ROLE_ADMIN','ROLE_THUKHO','ROLE_KITHUATVIEN') THEN
    RETURN '1=1';
  END IF;

  -- Others (Tieptan, Khachhang, etc.): deny
  RETURN '1=0';
END PART_VPD_PREDICATE;

/

  GRANT EXECUTE ON "APP"."PART_VPD_PREDICATE" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."PART_VPD_PREDICATE" TO "ROLE_THUKHO";
  GRANT EXECUTE ON "APP"."PART_VPD_PREDICATE" TO "ROLE_KITHUATVIEN";
--------------------------------------------------------
--  DDL for Function STOCK_VPD_PREDICATE
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE FUNCTION "APP"."STOCK_VPD_PREDICATE" (
  p_schema IN VARCHAR2,
  p_object IN VARCHAR2
) RETURN VARCHAR2
AS
  v_role  VARCHAR2(100) := SYS_CONTEXT('APP_CTX','ROLE_NAME');
BEGIN
  -- ADMIN, THUKHO: xem full
  IF v_role IN ('ROLE_ADMIN', 'ROLE_THUKHO') THEN
    RETURN '1=1';
  END IF;

  -- TIEPTAN, KITHUATVIEN, KHACHHANG: không được xem
  RETURN '1=0';
END STOCK_VPD_PREDICATE;

/

  GRANT EXECUTE ON "APP"."STOCK_VPD_PREDICATE" TO "ROLE_ADMIN";
  GRANT EXECUTE ON "APP"."STOCK_VPD_PREDICATE" TO "ROLE_THUKHO";
--------------------------------------------------------
--  Constraints for Table INVOICE
--------------------------------------------------------

  ALTER TABLE "APP"."INVOICE" MODIFY ("STOCKOUT_ID" NOT NULL ENABLE);
  ALTER TABLE "APP"."INVOICE" MODIFY ("CUSTOMER_PHONE" NOT NULL ENABLE);
  ALTER TABLE "APP"."INVOICE" MODIFY ("EMP_ID" NOT NULL ENABLE);
  ALTER TABLE "APP"."INVOICE" ADD PRIMARY KEY ("INVOICE_ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Constraints for Table ORDER_SERVICE
--------------------------------------------------------

  ALTER TABLE "APP"."ORDER_SERVICE" MODIFY ("ORDER_ID" NOT NULL ENABLE);
  ALTER TABLE "APP"."ORDER_SERVICE" MODIFY ("SERVICE_ID" NOT NULL ENABLE);
  ALTER TABLE "APP"."ORDER_SERVICE" MODIFY ("PRICE" NOT NULL ENABLE);
  ALTER TABLE "APP"."ORDER_SERVICE" ADD CONSTRAINT "PK_ORDERSERVICE" PRIMARY KEY ("ORDER_ID", "SERVICE_ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Constraints for Table AUDIT_ALERT_LOG
--------------------------------------------------------

  ALTER TABLE "APP"."AUDIT_ALERT_LOG" MODIFY ("LOG_ID" NOT NULL ENABLE);
  ALTER TABLE "APP"."AUDIT_ALERT_LOG" MODIFY ("EVENT_TS" NOT NULL ENABLE);
--------------------------------------------------------
--  Constraints for Table EMPLOYEE_SHIFT
--------------------------------------------------------

  ALTER TABLE "APP"."EMPLOYEE_SHIFT" MODIFY ("EMP_ID" NOT NULL ENABLE);
  ALTER TABLE "APP"."EMPLOYEE_SHIFT" MODIFY ("SHIFT_DATE" NOT NULL ENABLE);
  ALTER TABLE "APP"."EMPLOYEE_SHIFT" MODIFY ("START_TIME" NOT NULL ENABLE);
  ALTER TABLE "APP"."EMPLOYEE_SHIFT" MODIFY ("END_TIME" NOT NULL ENABLE);
  ALTER TABLE "APP"."EMPLOYEE_SHIFT" ADD PRIMARY KEY ("SHIFT_ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Constraints for Table SERVICE
--------------------------------------------------------

  ALTER TABLE "APP"."SERVICE" MODIFY ("SERVICE_ID" NOT NULL ENABLE);
  ALTER TABLE "APP"."SERVICE" MODIFY ("NAME" NOT NULL ENABLE);
  ALTER TABLE "APP"."SERVICE" MODIFY ("PRICE" NOT NULL ENABLE);
  ALTER TABLE "APP"."SERVICE" ADD PRIMARY KEY ("SERVICE_ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Constraints for Table INVOICE_SERVICE
--------------------------------------------------------

  ALTER TABLE "APP"."INVOICE_SERVICE" MODIFY ("INVOICE_ID" NOT NULL ENABLE);
  ALTER TABLE "APP"."INVOICE_SERVICE" MODIFY ("SERVICE_ID" NOT NULL ENABLE);
  ALTER TABLE "APP"."INVOICE_SERVICE" MODIFY ("PRICE" NOT NULL ENABLE);
  ALTER TABLE "APP"."INVOICE_SERVICE" ADD CONSTRAINT "PK_INVOICESERVICE" PRIMARY KEY ("INVOICE_ID", "SERVICE_ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Constraints for Table STOCK_IN_ITEM
--------------------------------------------------------

  ALTER TABLE "APP"."STOCK_IN_ITEM" MODIFY ("STOCKIN_ID" NOT NULL ENABLE);
  ALTER TABLE "APP"."STOCK_IN_ITEM" MODIFY ("PART_NAME" NOT NULL ENABLE);
  ALTER TABLE "APP"."STOCK_IN_ITEM" MODIFY ("SERIAL" NOT NULL ENABLE);
  ALTER TABLE "APP"."STOCK_IN_ITEM" ADD PRIMARY KEY ("STOCKIN_ITEM_ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
  ALTER TABLE "APP"."STOCK_IN_ITEM" ADD UNIQUE ("SERIAL")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Constraints for Table USER_OTP_LOG
--------------------------------------------------------

  ALTER TABLE "APP"."USER_OTP_LOG" MODIFY ("ID" NOT NULL ENABLE);
  ALTER TABLE "APP"."USER_OTP_LOG" MODIFY ("USER_ID" NOT NULL ENABLE);
  ALTER TABLE "APP"."USER_OTP_LOG" MODIFY ("USERNAME" NOT NULL ENABLE);
  ALTER TABLE "APP"."USER_OTP_LOG" MODIFY ("OTP" NOT NULL ENABLE);
  ALTER TABLE "APP"."USER_OTP_LOG" ADD PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Constraints for Table PART
--------------------------------------------------------

  ALTER TABLE "APP"."PART" MODIFY ("NAME" NOT NULL ENABLE);
  ALTER TABLE "APP"."PART" MODIFY ("SERIAL" NOT NULL ENABLE);
  ALTER TABLE "APP"."PART" MODIFY ("STATUS" NOT NULL ENABLE);
  ALTER TABLE "APP"."PART" MODIFY ("STOCK_IN_ID" NOT NULL ENABLE);
  ALTER TABLE "APP"."PART" ADD PRIMARY KEY ("PART_ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
  ALTER TABLE "APP"."PART" ADD UNIQUE ("SERIAL")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Constraints for Table CUSTOMER
--------------------------------------------------------

  ALTER TABLE "APP"."CUSTOMER" MODIFY ("FULL_NAME" NOT NULL ENABLE);
  ALTER TABLE "APP"."CUSTOMER" ADD PRIMARY KEY ("PHONE")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Constraints for Table PART_REQUEST_ITEM
--------------------------------------------------------

  ALTER TABLE "APP"."PART_REQUEST_ITEM" MODIFY ("REQUEST_ID" NOT NULL ENABLE);
  ALTER TABLE "APP"."PART_REQUEST_ITEM" MODIFY ("PART_ID" NOT NULL ENABLE);
  ALTER TABLE "APP"."PART_REQUEST_ITEM" ADD CONSTRAINT "PK_PARTREQUESTITEM" PRIMARY KEY ("REQUEST_ID", "PART_ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Constraints for Table STOCK_IN
--------------------------------------------------------

  ALTER TABLE "APP"."STOCK_IN" MODIFY ("EMP_ID" NOT NULL ENABLE);
  ALTER TABLE "APP"."STOCK_IN" MODIFY ("IN_DATE" NOT NULL ENABLE);
  ALTER TABLE "APP"."STOCK_IN" ADD PRIMARY KEY ("STOCKIN_ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Constraints for Table INVOICE_ITEM
--------------------------------------------------------

  ALTER TABLE "APP"."INVOICE_ITEM" ADD CONSTRAINT "PK_INVOICEITEM" PRIMARY KEY ("INVOICE_ID", "STOCKOUT_ID", "PART_ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
  ALTER TABLE "APP"."INVOICE_ITEM" ADD CONSTRAINT "UK_INVOICEITEM_STOCKOUT_PART" UNIQUE ("STOCKOUT_ID", "PART_ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
  ALTER TABLE "APP"."INVOICE_ITEM" MODIFY ("INVOICE_ID" NOT NULL ENABLE);
  ALTER TABLE "APP"."INVOICE_ITEM" MODIFY ("STOCKOUT_ID" NOT NULL ENABLE);
  ALTER TABLE "APP"."INVOICE_ITEM" MODIFY ("PART_ID" NOT NULL ENABLE);
  ALTER TABLE "APP"."INVOICE_ITEM" MODIFY ("PRICE" NOT NULL ENABLE);
--------------------------------------------------------
--  Constraints for Table ORDERS
--------------------------------------------------------

  ALTER TABLE "APP"."ORDERS" MODIFY ("CUSTOMER_PHONE" NOT NULL ENABLE);
  ALTER TABLE "APP"."ORDERS" MODIFY ("RECEIVER_EMP" NOT NULL ENABLE);
  ALTER TABLE "APP"."ORDERS" MODIFY ("HANDLER_EMP" NOT NULL ENABLE);
  ALTER TABLE "APP"."ORDERS" MODIFY ("ORDER_TYPE" NOT NULL ENABLE);
  ALTER TABLE "APP"."ORDERS" MODIFY ("RECEIVED_DATE" NOT NULL ENABLE);
  ALTER TABLE "APP"."ORDERS" MODIFY ("STATUS" NOT NULL ENABLE);
  ALTER TABLE "APP"."ORDERS" ADD PRIMARY KEY ("ORDER_ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Constraints for Table A
--------------------------------------------------------

  ALTER TABLE "APP"."A" ADD PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Constraints for Table STOCK_OUT_ITEM
--------------------------------------------------------

  ALTER TABLE "APP"."STOCK_OUT_ITEM" MODIFY ("STOCKOUT_ID" NOT NULL ENABLE);
  ALTER TABLE "APP"."STOCK_OUT_ITEM" MODIFY ("PART_ID" NOT NULL ENABLE);
  ALTER TABLE "APP"."STOCK_OUT_ITEM" ADD CONSTRAINT "PK_STOCKOUTITEM" PRIMARY KEY ("STOCKOUT_ID", "PART_ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Constraints for Table CUSTOMER_APPOINTMENT
--------------------------------------------------------

  ALTER TABLE "APP"."CUSTOMER_APPOINTMENT" MODIFY ("CUSTOMER_PHONE" NOT NULL ENABLE);
  ALTER TABLE "APP"."CUSTOMER_APPOINTMENT" MODIFY ("APPOINTMENT_DATE" NOT NULL ENABLE);
  ALTER TABLE "APP"."CUSTOMER_APPOINTMENT" ADD PRIMARY KEY ("APPOINTMENT_ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Constraints for Table PART_REQUEST
--------------------------------------------------------

  ALTER TABLE "APP"."PART_REQUEST" MODIFY ("ORDER_ID" NOT NULL ENABLE);
  ALTER TABLE "APP"."PART_REQUEST" MODIFY ("EMP_ID" NOT NULL ENABLE);
  ALTER TABLE "APP"."PART_REQUEST" MODIFY ("REQUEST_DATE" NOT NULL ENABLE);
  ALTER TABLE "APP"."PART_REQUEST" MODIFY ("STATUS" NOT NULL ENABLE);
  ALTER TABLE "APP"."PART_REQUEST" ADD PRIMARY KEY ("REQUEST_ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Constraints for Table STOCK_OUT
--------------------------------------------------------

  ALTER TABLE "APP"."STOCK_OUT" MODIFY ("ORDER_ID" NOT NULL ENABLE);
  ALTER TABLE "APP"."STOCK_OUT" MODIFY ("EMP_ID" NOT NULL ENABLE);
  ALTER TABLE "APP"."STOCK_OUT" MODIFY ("OUT_DATE" NOT NULL ENABLE);
  ALTER TABLE "APP"."STOCK_OUT" ADD PRIMARY KEY ("STOCKOUT_ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Constraints for Table EMPLOYEE
--------------------------------------------------------

  ALTER TABLE "APP"."EMPLOYEE" MODIFY ("EMP_ID" NOT NULL ENABLE);
  ALTER TABLE "APP"."EMPLOYEE" MODIFY ("FULL_NAME" NOT NULL ENABLE);
  ALTER TABLE "APP"."EMPLOYEE" MODIFY ("USERNAME" NOT NULL ENABLE);
  ALTER TABLE "APP"."EMPLOYEE" MODIFY ("PASSWORD_HASH" NOT NULL ENABLE);
  ALTER TABLE "APP"."EMPLOYEE" MODIFY ("EMAIL" NOT NULL ENABLE);
  ALTER TABLE "APP"."EMPLOYEE" MODIFY ("PHONE" NOT NULL ENABLE);
  ALTER TABLE "APP"."EMPLOYEE" ADD PRIMARY KEY ("EMP_ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
  ALTER TABLE "APP"."EMPLOYEE" ADD UNIQUE ("USERNAME")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
  ALTER TABLE "APP"."EMPLOYEE" ADD UNIQUE ("EMAIL")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
  ALTER TABLE "APP"."EMPLOYEE" ADD UNIQUE ("PHONE")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Ref Constraints for Table CUSTOMER_APPOINTMENT
--------------------------------------------------------

  ALTER TABLE "APP"."CUSTOMER_APPOINTMENT" ADD CONSTRAINT "FK_APPOINTMENT_CUSTOMER" FOREIGN KEY ("CUSTOMER_PHONE")
	  REFERENCES "APP"."CUSTOMER" ("PHONE") ENABLE;
--------------------------------------------------------
--  Ref Constraints for Table EMPLOYEE_SHIFT
--------------------------------------------------------

  ALTER TABLE "APP"."EMPLOYEE_SHIFT" ADD CONSTRAINT "FK_SHIFT_EMPLOYEE" FOREIGN KEY ("EMP_ID")
	  REFERENCES "APP"."EMPLOYEE" ("EMP_ID") ENABLE;
--------------------------------------------------------
--  Ref Constraints for Table INVOICE
--------------------------------------------------------

  ALTER TABLE "APP"."INVOICE" ADD CONSTRAINT "FK_INVOICE_STOCKOUT" FOREIGN KEY ("STOCKOUT_ID")
	  REFERENCES "APP"."STOCK_OUT" ("STOCKOUT_ID") ENABLE;
  ALTER TABLE "APP"."INVOICE" ADD CONSTRAINT "FK_INVOICE_CUSTOMER" FOREIGN KEY ("CUSTOMER_PHONE")
	  REFERENCES "APP"."CUSTOMER" ("PHONE") ENABLE;
  ALTER TABLE "APP"."INVOICE" ADD CONSTRAINT "FK_INVOICE_EMPLOYEE" FOREIGN KEY ("EMP_ID")
	  REFERENCES "APP"."EMPLOYEE" ("EMP_ID") ENABLE;
--------------------------------------------------------
--  Ref Constraints for Table INVOICE_ITEM
--------------------------------------------------------

  ALTER TABLE "APP"."INVOICE_ITEM" ADD CONSTRAINT "FK_INVOICEITEM_INVOICE" FOREIGN KEY ("INVOICE_ID")
	  REFERENCES "APP"."INVOICE" ("INVOICE_ID") ENABLE;
  ALTER TABLE "APP"."INVOICE_ITEM" ADD CONSTRAINT "FK_INVOICEITEM_STOCKOUTITEM" FOREIGN KEY ("STOCKOUT_ID", "PART_ID")
	  REFERENCES "APP"."STOCK_OUT_ITEM" ("STOCKOUT_ID", "PART_ID") ENABLE;
--------------------------------------------------------
--  Ref Constraints for Table INVOICE_SERVICE
--------------------------------------------------------

  ALTER TABLE "APP"."INVOICE_SERVICE" ADD CONSTRAINT "FK_INVOICESERVICE_INVOICE" FOREIGN KEY ("INVOICE_ID")
	  REFERENCES "APP"."INVOICE" ("INVOICE_ID") ENABLE;
  ALTER TABLE "APP"."INVOICE_SERVICE" ADD CONSTRAINT "FK_INVOICESERVICE_SERVICE" FOREIGN KEY ("SERVICE_ID")
	  REFERENCES "APP"."SERVICE" ("SERVICE_ID") ENABLE;
--------------------------------------------------------
--  Ref Constraints for Table ORDERS
--------------------------------------------------------

  ALTER TABLE "APP"."ORDERS" ADD CONSTRAINT "FK_ORDER_CUSTOMER" FOREIGN KEY ("CUSTOMER_PHONE")
	  REFERENCES "APP"."CUSTOMER" ("PHONE") ENABLE;
  ALTER TABLE "APP"."ORDERS" ADD CONSTRAINT "FK_ORDER_EMPLOYEE" FOREIGN KEY ("RECEIVER_EMP")
	  REFERENCES "APP"."EMPLOYEE" ("EMP_ID") ENABLE;
  ALTER TABLE "APP"."ORDERS" ADD CONSTRAINT "FK_ORDER_HANDLEEMPLOYEE" FOREIGN KEY ("HANDLER_EMP")
	  REFERENCES "APP"."EMPLOYEE" ("EMP_ID") ENABLE;
--------------------------------------------------------
--  Ref Constraints for Table ORDER_SERVICE
--------------------------------------------------------

  ALTER TABLE "APP"."ORDER_SERVICE" ADD CONSTRAINT "FK_ORDERSERVICE_ORDER" FOREIGN KEY ("ORDER_ID")
	  REFERENCES "APP"."ORDERS" ("ORDER_ID") ENABLE;
  ALTER TABLE "APP"."ORDER_SERVICE" ADD CONSTRAINT "FK_ORDERSERVICE_SERVICE" FOREIGN KEY ("SERVICE_ID")
	  REFERENCES "APP"."SERVICE" ("SERVICE_ID") ENABLE;
--------------------------------------------------------
--  Ref Constraints for Table PART
--------------------------------------------------------

  ALTER TABLE "APP"."PART" ADD CONSTRAINT "FK_PART_STOCKINITEM" FOREIGN KEY ("STOCK_IN_ID")
	  REFERENCES "APP"."STOCK_IN" ("STOCKIN_ID") ENABLE;
  ALTER TABLE "APP"."PART" ADD CONSTRAINT "FK_PART_ORDER" FOREIGN KEY ("ORDER_ID")
	  REFERENCES "APP"."ORDERS" ("ORDER_ID") ENABLE;
--------------------------------------------------------
--  Ref Constraints for Table PART_REQUEST
--------------------------------------------------------

  ALTER TABLE "APP"."PART_REQUEST" ADD CONSTRAINT "FK_PARTREQUEST_ORDER" FOREIGN KEY ("ORDER_ID")
	  REFERENCES "APP"."ORDERS" ("ORDER_ID") ENABLE;
  ALTER TABLE "APP"."PART_REQUEST" ADD CONSTRAINT "FK_PARTREQUEST_EMPLOYEE" FOREIGN KEY ("EMP_ID")
	  REFERENCES "APP"."EMPLOYEE" ("EMP_ID") ENABLE;
--------------------------------------------------------
--  Ref Constraints for Table PART_REQUEST_ITEM
--------------------------------------------------------

  ALTER TABLE "APP"."PART_REQUEST_ITEM" ADD CONSTRAINT "FK_PARTREQUESTITEM_REQUEST" FOREIGN KEY ("REQUEST_ID")
	  REFERENCES "APP"."PART_REQUEST" ("REQUEST_ID") ENABLE;
  ALTER TABLE "APP"."PART_REQUEST_ITEM" ADD CONSTRAINT "FK_PARTREQUESTITEM_PART" FOREIGN KEY ("PART_ID")
	  REFERENCES "APP"."PART" ("PART_ID") ENABLE;
--------------------------------------------------------
--  Ref Constraints for Table STOCK_IN
--------------------------------------------------------

  ALTER TABLE "APP"."STOCK_IN" ADD CONSTRAINT "FK_STOCKIN_EMPLOYEE" FOREIGN KEY ("EMP_ID")
	  REFERENCES "APP"."EMPLOYEE" ("EMP_ID") ENABLE;
--------------------------------------------------------
--  Ref Constraints for Table STOCK_IN_ITEM
--------------------------------------------------------

  ALTER TABLE "APP"."STOCK_IN_ITEM" ADD CONSTRAINT "FK_STOCKINITEM_STOCKIN" FOREIGN KEY ("STOCKIN_ID")
	  REFERENCES "APP"."STOCK_IN" ("STOCKIN_ID") ENABLE;
--------------------------------------------------------
--  Ref Constraints for Table STOCK_OUT
--------------------------------------------------------

  ALTER TABLE "APP"."STOCK_OUT" ADD CONSTRAINT "FK_STOCKOUT_ORDER" FOREIGN KEY ("ORDER_ID")
	  REFERENCES "APP"."ORDERS" ("ORDER_ID") ENABLE;
  ALTER TABLE "APP"."STOCK_OUT" ADD CONSTRAINT "FK_STOCKOUT_EMPLOYEE" FOREIGN KEY ("EMP_ID")
	  REFERENCES "APP"."EMPLOYEE" ("EMP_ID") ENABLE;
--------------------------------------------------------
--  Ref Constraints for Table STOCK_OUT_ITEM
--------------------------------------------------------

  ALTER TABLE "APP"."STOCK_OUT_ITEM" ADD CONSTRAINT "FK_STOCKOUTITEM_STOCKOUT" FOREIGN KEY ("STOCKOUT_ID")
	  REFERENCES "APP"."STOCK_OUT" ("STOCKOUT_ID") ENABLE;
  ALTER TABLE "APP"."STOCK_OUT_ITEM" ADD CONSTRAINT "FK_STOCKOUTITEM_PART" FOREIGN KEY ("PART_ID")
	  REFERENCES "APP"."PART" ("PART_ID") ENABLE;
